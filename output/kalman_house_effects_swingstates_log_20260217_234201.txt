kalman filter with house effects analysis — swing states
started: 2026-02-17 23:42:01
log file: output/kalman_house_effects_swingstates_log_20260217_234201.txt
states: ['arizona', 'georgia', 'michigan', 'nevada', 'north carolina', 'pennsylvania', 'wisconsin']
time windows: [None, 200, 107]

======================================================================
======================================================================
ANALYZING: arizona (AZ) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (arizona | ALL DATA)
======================================================================
arizona polls loaded: 147 questions from 94 polls, 40 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.606 pp

sanity check — unique true_margin values: [5.52860324]

election result appended: margin = 5.529 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.455287

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.889293    0.455287      1.4460
    2        0.972987    0.302363      1.5642
    3        0.694998    0.285474      1.6241
    4        0.303778    0.269605      1.6497
    5        0.158277    0.262427      1.6619
    6        0.080409    0.258249      1.6684
    7        0.042383    0.255909      1.6720
    8        0.022740    0.254607      1.6740
    9        0.012342    0.253897      1.6750
   10        0.006721    0.253483      1.6756
   11        0.003735    0.253246      1.6759
   12        0.002093    0.253128      1.6761
   13        0.001138    0.253069      1.6762
   14        0.000608    0.253010      1.6763
   15        0.000393    0.253010      1.6763
   16        0.000159    0.252950      1.6763
   17        0.000211    0.252950      1.6763
   18        0.000082    0.252950      1.6763

em converged at iteration 18 (max change 8.23e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — arizona (trump margin, anchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.252950 per day
interpretation: true opinion can move ~0.503 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.606 pp
  mean total error:              -3.923 pp
  sd of total error:             2.819 pp

--- three-component decomposition ---
  mean |house effect|:           1.407 pp
  mean |sampling noise|:         1.203 pp
  mean residual systematic bias: -3.738 pp

--- variance decomposition ---
  var(total error):              7.9451
  var(house effects):            3.2720  (41.2%)
  var(sampling noise):           2.6297  (33.1%)
  var(residual systematic bias): 1.9275  (24.3%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.142        8
             Morning Consult        -2.009       19
                      YouGov        -1.498        5
                   Siena/NYT         1.107       18
                  AtlasIntel         0.881       12
                 Beacon/Shaw         0.610        6
Redfield & Wilton Strategies         0.157       12
             Trafalgar Group        -0.011        5

figure saved to: figures/kalman_he_AZ_anchored_all_data.png
poll results exported to: data/kalman_he_polls_AZ_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_AZ_anchored_all_data.csv

======================================================================
UNANCHORED MODE (arizona | ALL DATA)
======================================================================
arizona polls loaded: 147 questions from 94 polls, 40 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.606 pp

sanity check — unique true_margin values: [5.52860324]

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.113783

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.771924    0.113783      1.5089
    2        0.718104    0.048297      1.5607
    3        0.547450    0.045088      1.5712
    4        0.089298    0.037445      1.5708
    5        0.091520    0.036165      1.5693
    6        0.027875    0.034669      1.5686
    7        0.023701    0.034168      1.5681
    8        0.010517    0.033770      1.5677
    9        0.007206    0.033583      1.5675
   10        0.003781    0.033459      1.5674
   11        0.002364    0.033397      1.5673
   12        0.001270    0.033358      1.5673
   13        0.000761    0.033335      1.5672
   14        0.000454    0.033319      1.5672
   15        0.000290    0.033311      1.5672
   16        0.000157    0.033303      1.5672
   17        0.000131    0.033303      1.5672
   18        0.000025    0.033303      1.5672

em converged at iteration 18 (max change 2.50e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — arizona (trump margin, unanchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.033303 per day
interpretation: true opinion can move ~0.182 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.606 pp
  mean total error:              -3.923 pp
  sd of total error:             2.819 pp

--- three-component decomposition ---
  mean |house effect|:           1.420 pp
  mean |sampling noise|:         1.249 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.416        8
             Morning Consult        -2.173       19
                  AtlasIntel         1.656       12
                   Siena/NYT         1.091       18
                      YouGov        -0.836        5
Redfield & Wilton Strategies        -0.125       12
                 Beacon/Shaw         0.112        6
             Trafalgar Group         0.108        5

figure saved to: figures/kalman_he_AZ_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_AZ_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_AZ_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: arizona (AZ) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (arizona | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 147
  polls after filter:  144
  polls dropped:       3
arizona polls loaded: 144 questions from 92 polls, 40 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.519 pp

sanity check — unique true_margin values: [5.52860324]

election result appended: margin = 5.529 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.558672

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.857245    0.558672      1.4254
    2        0.965030    0.363906      1.5566
    3        0.699082    0.347416      1.6202
    4        0.304413    0.331215      1.6464
    5        0.155375    0.324257      1.6585
    6        0.077775    0.320158      1.6643
    7        0.040403    0.317847      1.6672
    8        0.021419    0.316570      1.6687
    9        0.011489    0.315842      1.6695
   10        0.006261    0.315477      1.6699
   11        0.003355    0.315186      1.6702
   12        0.001989    0.315113      1.6703
   13        0.000984    0.315040      1.6704
   14        0.000562    0.314968      1.6704
   15        0.000380    0.314968      1.6704
   16        0.000161    0.314895      1.6704
   17        0.000210    0.314895      1.6705
   18        0.000086    0.314895      1.6705

em converged at iteration 18 (max change 8.64e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — arizona (trump margin, anchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.314895 per day
interpretation: true opinion can move ~0.561 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.519 pp
  mean total error:              -4.010 pp
  sd of total error:             2.778 pp

--- three-component decomposition ---
  mean |house effect|:           1.420 pp
  mean |sampling noise|:         1.191 pp
  mean residual systematic bias: -3.845 pp

--- variance decomposition ---
  var(total error):              7.7163
  var(house effects):            3.2592  (42.2%)
  var(sampling noise):           2.5316  (32.8%)
  var(residual systematic bias): 1.8558  (24.1%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.098        7
             Morning Consult        -2.051       19
                      YouGov        -1.389        5
                   Siena/NYT         1.170       16
                  AtlasIntel         0.961       12
                 Beacon/Shaw         0.608        6
Redfield & Wilton Strategies         0.186       12
             Trafalgar Group         0.034        5

figure saved to: figures/kalman_he_AZ_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_AZ_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_AZ_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (arizona | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 147
  polls after filter:  144
  polls dropped:       3
arizona polls loaded: 144 questions from 92 polls, 40 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.519 pp

sanity check — unique true_margin values: [5.52860324]

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.191216

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.780386    0.191216      1.4908
    2        0.772410    0.090360      1.5570
    3        0.683384    0.089118      1.5781
    4        0.136592    0.070977      1.5815
    5        0.145270    0.068333      1.5820
    6        0.037640    0.063437      1.5815
    7        0.042261    0.062077      1.5808
    8        0.016622    0.060491      1.5802
    9        0.015360    0.059872      1.5798
   10        0.007384    0.059291      1.5795
   11        0.005979    0.059015      1.5793
   12        0.003234    0.058790      1.5791
   13        0.002393    0.058669      1.5790
   14        0.001398    0.058588      1.5790
   15        0.000908    0.058534      1.5789
   16        0.000601    0.058493      1.5789
   17        0.000435    0.058480      1.5789
   18        0.000185    0.058466      1.5789
   19        0.000146    0.058452      1.5789
   20        0.000136    0.058452      1.5789
   21        0.000022    0.058439      1.5789

em converged at iteration 21 (max change 2.24e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — arizona (trump margin, unanchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.058439 per day
interpretation: true opinion can move ~0.242 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.519 pp
  mean total error:              -4.010 pp
  sd of total error:             2.778 pp

--- three-component decomposition ---
  mean |house effect|:           1.415 pp
  mean |sampling noise|:         1.242 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.276        7
             Morning Consult        -2.133       19
                  AtlasIntel         1.617       12
                   Siena/NYT         1.144       16
                      YouGov        -0.892        5
                 Beacon/Shaw         0.213        6
             Trafalgar Group         0.149        5
Redfield & Wilton Strategies        -0.054       12

figure saved to: figures/kalman_he_AZ_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_AZ_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_AZ_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: arizona (AZ) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (arizona | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 147
  polls after filter:  141
  polls dropped:       6
arizona polls loaded: 141 questions from 89 polls, 39 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 7.8 pp
mean poll margin: 1.388 pp

sanity check — unique true_margin values: [5.52860324]

election result appended: margin = 5.529 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.501384

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.875819    0.501384      1.4367
    2        0.580222    0.307001      1.5448
    3        0.326683    0.296452      1.5980
    4        0.096982    0.282792      1.6166
    5        0.049050    0.277600      1.6252
    6        0.024750    0.274566      1.6291
    7        0.013063    0.272918      1.6311
    8        0.008080    0.272030      1.6321
    9        0.004790    0.271523      1.6326
   10        0.002791    0.271269      1.6329
   11        0.001570    0.271079      1.6330
   12        0.000933    0.271015      1.6331
   13        0.000499    0.270952      1.6332
   14        0.000298    0.270952      1.6332
   15        0.000136    0.270952      1.6332
   16        0.000061    0.270952      1.6332

em converged at iteration 16 (max change 6.07e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — arizona (trump margin, anchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.270952 per day
interpretation: true opinion can move ~0.521 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.388 pp
  mean total error:              -4.141 pp
  sd of total error:             2.650 pp

--- three-component decomposition ---
  mean |house effect|:           1.421 pp
  mean |sampling noise|:         1.204 pp
  mean residual systematic bias: -3.950 pp

--- variance decomposition ---
  var(total error):              7.0212
  var(house effects):            3.1549  (44.9%)
  var(sampling noise):           2.6007  (37.0%)
  var(residual systematic bias): 1.6847  (24.0%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.360        7
             Morning Consult        -2.149       18
                      YouGov        -1.389        5
                   Siena/NYT         1.236       16
                  AtlasIntel         0.969       12
                 Beacon/Shaw         0.672        6
Redfield & Wilton Strategies         0.301       12
             Trafalgar Group         0.102        5

figure saved to: figures/kalman_he_AZ_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_AZ_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_AZ_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (arizona | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 147
  polls after filter:  141
  polls dropped:       6
arizona polls loaded: 141 questions from 89 polls, 39 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 7.8 pp
mean poll margin: 1.388 pp

sanity check — unique true_margin values: [5.52860324]

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.021939

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.734288    0.021939      1.5006
    2        0.104423    0.014612      1.5040
    3        0.142412    0.013933      1.4977
    4        0.042412    0.012381      1.4960
    5        0.045920    0.011798      1.4947
    6        0.023658    0.011255      1.4938
    7        0.018829    0.010957      1.4933
    8        0.011593    0.010732      1.4929
    9        0.008351    0.010588      1.4926
   10        0.005563    0.010488      1.4924
   11        0.003848    0.010421      1.4923
   12        0.002593    0.010373      1.4922
   13        0.001832    0.010342      1.4921
   14        0.001221    0.010320      1.4921
   15        0.000838    0.010306      1.4921
   16        0.000563    0.010294      1.4921
   17        0.000443    0.010289      1.4920
   18        0.000220    0.010282      1.4920
   19        0.000243    0.010280      1.4920
   20        0.000113    0.010277      1.4920
   21        0.000090    0.010275      1.4920

em converged at iteration 21 (max change 8.96e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — arizona (trump margin, unanchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.010275 per day
interpretation: true opinion can move ~0.101 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.388 pp
  mean total error:              -4.141 pp
  sd of total error:             2.650 pp

--- three-component decomposition ---
  mean |house effect|:           1.425 pp
  mean |sampling noise|:         1.254 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
             Morning Consult        -2.499       18
                     Emerson         2.495        7
                  AtlasIntel         1.929       12
                   Siena/NYT         1.203       16
                      YouGov        -0.524        5
             Trafalgar Group         0.287        5
                 Beacon/Shaw         0.127        6
Redfield & Wilton Strategies         0.025       12

figure saved to: figures/kalman_he_AZ_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_AZ_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_AZ_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: georgia (GA) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (georgia | ALL DATA)
======================================================================
georgia polls loaded: 148 questions from 87 polls, 34 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.0 to 11.0 pp
mean poll margin: 1.436 pp

sanity check — unique true_margin values: [2.19200309]

election result appended: margin = 2.192 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.159603

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.012599    0.159603      1.3852
    2        0.741290    0.070220      1.5353
    3        0.548777    0.060788      1.5696
    4        0.223582    0.050790      1.5806
    5        0.132676    0.046976      1.5850
    6        0.069538    0.044572      1.5864
    7        0.040087    0.043325      1.5872
    8        0.022394    0.042611      1.5876
    9        0.012711    0.042210      1.5879
   10        0.007205    0.041985      1.5880
   11        0.004073    0.041858      1.5881
   12        0.002304    0.041789      1.5881
   13        0.001278    0.041740      1.5881
   14        0.000792    0.041721      1.5882
   15        0.000409    0.041706      1.5882
   16        0.000245    0.041697      1.5882
   17        0.000153    0.041697      1.5882
   18        0.000050    0.041697      1.5882

em converged at iteration 18 (max change 5.01e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — georgia (trump margin, anchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.041697 per day
interpretation: true opinion can move ~0.204 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.436 pp
  mean total error:              -0.756 pp
  sd of total error:             2.743 pp

--- three-component decomposition ---
  mean |house effect|:           1.418 pp
  mean |sampling noise|:         1.122 pp
  mean residual systematic bias: -0.588 pp

--- variance decomposition ---
  var(total error):              7.5243
  var(house effects):            3.9213  (52.1%)
  var(sampling noise):           2.2320  (29.7%)
  var(residual systematic bias): 0.4228  (5.6%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
                                     Quinnipiac         4.218        6
Florida Atlantic University/Mainstreet Research         3.719       10
                                    Beacon/Shaw        -3.287        6
                                           TIPP        -2.366        8
                                Morning Consult        -1.160       19
                                      Siena/NYT         0.897       14
                                         YouGov         0.357        5
                                        Emerson         0.273        7
                                     AtlasIntel         0.222       12
                   Redfield & Wilton Strategies         0.066       13

figure saved to: figures/kalman_he_GA_anchored_all_data.png
poll results exported to: data/kalman_he_polls_GA_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_GA_anchored_all_data.csv

======================================================================
UNANCHORED MODE (georgia | ALL DATA)
======================================================================
georgia polls loaded: 148 questions from 87 polls, 34 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.0 to 11.0 pp
mean poll margin: 1.436 pp

sanity check — unique true_margin values: [2.19200309]

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.132393

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.100426    0.132393      1.4162
    2        0.648136    0.048736      1.5569
    3        0.512479    0.040512      1.5964
    4        0.192357    0.032321      1.6076
    5        0.124492    0.029675      1.6127
    6        0.063236    0.027865      1.6142
    7        0.038671    0.026983      1.6151
    8        0.021735    0.026429      1.6155
    9        0.013048    0.026128      1.6157
   10        0.007523    0.025941      1.6159
   11        0.004507    0.025839      1.6159
   12        0.002594    0.025772      1.6160
   13        0.001580    0.025736      1.6160
   14        0.000913    0.025712      1.6160
   15        0.000565    0.025700      1.6160
   16        0.000316    0.025691      1.6160
   17        0.000203    0.025691      1.6160
   18        0.000064    0.025685      1.6160

em converged at iteration 18 (max change 6.40e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — georgia (trump margin, unanchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.025685 per day
interpretation: true opinion can move ~0.160 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.436 pp
  mean total error:              -0.756 pp
  sd of total error:             2.743 pp

--- three-component decomposition ---
  mean |house effect|:           1.476 pp
  mean |sampling noise|:         1.111 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
                                     Quinnipiac         4.013        6
                                    Beacon/Shaw        -3.573        6
Florida Atlantic University/Mainstreet Research         3.567       10
                                           TIPP        -2.489        8
                                Morning Consult        -1.281       19
                                      Siena/NYT         0.901       14
                                         YouGov         0.737        5
                                     AtlasIntel         0.617       12
                                        Emerson         0.271        7
                   Redfield & Wilton Strategies        -0.004       13

figure saved to: figures/kalman_he_GA_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_GA_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_GA_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: georgia (GA) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (georgia | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 148
  polls after filter:  145
  polls dropped:       3
georgia polls loaded: 145 questions from 85 polls, 34 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.0 to 11.0 pp
mean poll margin: 1.371 pp

sanity check — unique true_margin values: [2.19200309]

election result appended: margin = 2.192 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.170562

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.019361    0.170562      1.4027
    2        0.729191    0.066100      1.5485
    3        0.630643    0.056631      1.5945
    4        0.250832    0.046055      1.6026
    5        0.160544    0.041917      1.6050
    6        0.086813    0.039214      1.6052
    7        0.052762    0.037777      1.6052
    8        0.030500    0.036907      1.6052
    9        0.018188    0.036412      1.6051
   10        0.010634    0.036115      1.6051
   11        0.006328    0.035948      1.6051
   12        0.003657    0.035840      1.6051
   13        0.002245    0.035782      1.6051
   14        0.001290    0.035749      1.6051
   15        0.000740    0.035724      1.6051
   16        0.000488    0.035715      1.6051
   17        0.000234    0.035707      1.6051
   18        0.000159    0.035707      1.6051
   19        0.000047    0.035699      1.6051

em converged at iteration 19 (max change 4.73e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — georgia (trump margin, anchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.035699 per day
interpretation: true opinion can move ~0.189 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.371 pp
  mean total error:              -0.821 pp
  sd of total error:             2.678 pp

--- three-component decomposition ---
  mean |house effect|:           1.477 pp
  mean |sampling noise|:         1.069 pp
  mean residual systematic bias: -0.645 pp

--- variance decomposition ---
  var(total error):              7.1727
  var(house effects):            4.1335  (57.6%)
  var(sampling noise):           2.0777  (29.0%)
  var(residual systematic bias): 0.2361  (3.3%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
                                     Quinnipiac         4.197        6
Florida Atlantic University/Mainstreet Research         3.863       10
                                    Beacon/Shaw        -3.291        6
                                           TIPP        -2.376        8
                                      Siena/NYT         1.292       12
                                Morning Consult        -1.124       19
                                        Emerson        -0.489        6
                                         YouGov         0.346        5
                                     AtlasIntel         0.212       12
                   Redfield & Wilton Strategies         0.073       13

figure saved to: figures/kalman_he_GA_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_GA_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_GA_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (georgia | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 148
  polls after filter:  145
  polls dropped:       3
georgia polls loaded: 145 questions from 85 polls, 34 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.0 to 11.0 pp
mean poll margin: 1.371 pp

sanity check — unique true_margin values: [2.19200309]

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.139554

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.110115    0.139554      1.4372
    2        0.633979    0.042705      1.5730
    3        0.621018    0.034121      1.6267
    4        0.232635    0.024771      1.6356
    5        0.180934    0.021363      1.6389
    6        0.101916    0.018628      1.6388
    7        0.076377    0.017061      1.6387
    8        0.050610    0.015883      1.6383
    9        0.037614    0.015098      1.6380
   10        0.026624    0.014517      1.6378
   11        0.019773    0.014106      1.6377
   12        0.014378    0.013797      1.6378
   13        0.010805    0.013574      1.6379
   14        0.007961    0.013407      1.6379
   15        0.005979    0.013283      1.6379
   16        0.004449    0.013191      1.6380
   17        0.003340    0.013122      1.6380
   18        0.002489    0.013071      1.6380
   19        0.001863    0.013032      1.6380
   20        0.001417    0.013004      1.6380
   21        0.001012    0.012983      1.6380
   22        0.000767    0.012965      1.6380
   23        0.000633    0.012953      1.6380
   24        0.000450    0.012944      1.6380
   25        0.000333    0.012938      1.6380
   26        0.000230    0.012932      1.6380
   27        0.000206    0.012929      1.6380
   28        0.000124    0.012926      1.6380
   29        0.000105    0.012923      1.6380
   30        0.000100    0.012923      1.6380
   31        0.000024    0.012920      1.6380

em converged at iteration 31 (max change 2.35e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — georgia (trump margin, unanchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.012920 per day
interpretation: true opinion can move ~0.114 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.371 pp
  mean total error:              -0.821 pp
  sd of total error:             2.678 pp

--- three-component decomposition ---
  mean |house effect|:           1.547 pp
  mean |sampling noise|:         1.072 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
Florida Atlantic University/Mainstreet Research         3.953       10
                                     Quinnipiac         3.935        6
                                    Beacon/Shaw        -3.635        6
                                           TIPP        -2.539        8
                                      Siena/NYT         1.306       12
                                Morning Consult        -1.232       19
                                         YouGov         0.662        5
                                     AtlasIntel         0.545       12
                                        Emerson        -0.503        6
                   Redfield & Wilton Strategies         0.006       13

figure saved to: figures/kalman_he_GA_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_GA_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_GA_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: georgia (GA) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (georgia | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 148
  polls after filter:  135
  polls dropped:       13
georgia polls loaded: 135 questions from 81 polls, 34 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: 0.972 pp

sanity check — unique true_margin values: [2.19200309]

election result appended: margin = 2.192 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.042695

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.972586    0.042695      1.4879
    2        0.188956    0.029744      1.5328
    3        0.133197    0.030173      1.5314
    4        0.014073    0.029557      1.5312
    5        0.010506    0.029472      1.5309
    6        0.002944    0.029411      1.5308
    7        0.001333    0.029390      1.5308
    8        0.000503    0.029384      1.5308
    9        0.000180    0.029384      1.5308
   10        0.000034    0.029384      1.5308

em converged at iteration 10 (max change 3.45e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — georgia (trump margin, anchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.029384 per day
interpretation: true opinion can move ~0.171 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.972 pp
  mean total error:              -1.220 pp
  sd of total error:             2.246 pp

--- three-component decomposition ---
  mean |house effect|:           1.319 pp
  mean |sampling noise|:         0.993 pp
  mean residual systematic bias: -0.966 pp

--- variance decomposition ---
  var(total error):              5.0428
  var(house effects):            3.3296  (66.0%)
  var(sampling noise):           1.7098  (33.9%)
  var(residual systematic bias): 0.1231  (2.4%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  Quinnipiac         4.466        6
                 Beacon/Shaw        -2.963        6
                        TIPP        -2.103        8
                   Siena/NYT         1.636       12
             Morning Consult        -1.079       18
                      YouGov         0.511        5
Redfield & Wilton Strategies         0.447       13
                  AtlasIntel         0.380       12
                     Emerson         0.028        6

figure saved to: figures/kalman_he_GA_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_GA_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_GA_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (georgia | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 148
  polls after filter:  135
  polls dropped:       13
georgia polls loaded: 135 questions from 81 polls, 34 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: 0.972 pp

sanity check — unique true_margin values: [2.19200309]

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.971828    0.000100      1.5446
    2        0.002236    0.000100      1.5450
    3        0.000014    0.000100      1.5450

em converged at iteration 3 (max change 1.43e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — georgia (trump margin, unanchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.972 pp
  mean total error:              -1.220 pp
  sd of total error:             2.246 pp

--- three-component decomposition ---
  mean |house effect|:           1.388 pp
  mean |sampling noise|:         0.970 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  Quinnipiac         4.195        6
                 Beacon/Shaw        -3.305        6
                        TIPP        -2.271        8
                   Siena/NYT         1.695       12
             Morning Consult        -1.213       18
                      YouGov         0.830        5
                  AtlasIntel         0.722       12
Redfield & Wilton Strategies         0.412       13
                     Emerson         0.060        6

figure saved to: figures/kalman_he_GA_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_GA_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_GA_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: michigan (MI) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (michigan | ALL DATA)
======================================================================
michigan polls loaded: 176 questions from 112 polls, 48 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.221 pp

sanity check — unique true_margin values: [1.41420144]

election result appended: margin = 1.414 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.415822

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.527650    0.415822      1.7007
    2        0.772708    0.230165      1.7816
    3        0.627600    0.213663      1.8059
    4        0.249192    0.194064      1.8177
    5        0.119980    0.186127      1.8218
    6        0.054111    0.181128      1.8236
    7        0.026846    0.178491      1.8244
    8        0.013583    0.176997      1.8247
    9        0.007709    0.176138      1.8249
   10        0.004401    0.175647      1.8250
   11        0.002515    0.175402      1.8250
   12        0.001373    0.175238      1.8251
   13        0.000805    0.175156      1.8251
   14        0.000445    0.175074      1.8251
   15        0.000315    0.175074      1.8251
   16        0.000114    0.175033      1.8251
   17        0.000119    0.175033      1.8251
   18        0.000042    0.175033      1.8251

em converged at iteration 18 (max change 4.25e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — michigan (trump margin, anchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.175033 per day
interpretation: true opinion can move ~0.418 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.221 pp
  mean total error:              -2.636 pp
  sd of total error:             2.791 pp

--- three-component decomposition ---
  mean |house effect|:           1.663 pp
  mean |sampling noise|:         1.236 pp
  mean residual systematic bias: -2.419 pp

--- variance decomposition ---
  var(total error):              7.7872
  var(house effects):            4.3143  (55.4%)
  var(sampling noise):           2.8520  (36.6%)
  var(residual systematic bias): 0.3235  (4.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.647       12
             Morning Consult        -2.208       19
                   Siena/NYT         1.272       14
                      YouGov        -1.069        7
Redfield & Wilton Strategies         1.006       12
                    Mitchell         0.838        8
                     Emerson         0.734        7
                 Beacon/Shaw         0.379        6
                  Quinnipiac        -0.244        6

figure saved to: figures/kalman_he_MI_anchored_all_data.png
poll results exported to: data/kalman_he_polls_MI_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_MI_anchored_all_data.csv

======================================================================
UNANCHORED MODE (michigan | ALL DATA)
======================================================================
michigan polls loaded: 176 questions from 112 polls, 48 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.221 pp

sanity check — unique true_margin values: [1.41420144]

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.529533    0.000100      1.8000
    2        0.005656    0.000100      1.8005
    3        0.000028    0.000100      1.8005

em converged at iteration 3 (max change 2.80e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — michigan (trump margin, unanchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.221 pp
  mean total error:              -2.636 pp
  sd of total error:             2.791 pp

--- three-component decomposition ---
  mean |house effect|:           1.706 pp
  mean |sampling noise|:         1.210 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         3.155       12
             Morning Consult        -2.283       19
                   Siena/NYT         1.364       14
                      YouGov        -1.064        7
                    Mitchell         0.984        8
Redfield & Wilton Strategies         0.805       12
                     Emerson         0.707        7
                  Quinnipiac        -0.445        6
                 Beacon/Shaw         0.222        6

figure saved to: figures/kalman_he_MI_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_MI_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_MI_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: michigan (MI) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (michigan | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 176
  polls after filter:  174
  polls dropped:       2
michigan polls loaded: 174 questions from 111 polls, 48 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.236 pp

sanity check — unique true_margin values: [1.41420144]

election result appended: margin = 1.414 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.477340

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.542662    0.477340      1.6996
    2        0.790051    0.262911      1.7860
    3        0.630435    0.246120      1.8051
    4        0.258470    0.225865      1.8176
    5        0.123579    0.217744      1.8220
    6        0.055454    0.212728      1.8239
    7        0.026669    0.210071      1.8246
    8        0.013088    0.208597      1.8250
    9        0.006784    0.207732      1.8251
   10        0.003876    0.207299      1.8252
   11        0.002124    0.207011      1.8252
   12        0.001242    0.206867      1.8252
   13        0.000689    0.206770      1.8253
   14        0.000407    0.206722      1.8253
   15        0.000227    0.206722      1.8253
   16        0.000092    0.206722      1.8253

em converged at iteration 16 (max change 9.20e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — michigan (trump margin, anchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.206722 per day
interpretation: true opinion can move ~0.455 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.236 pp
  mean total error:              -2.650 pp
  sd of total error:             2.795 pp

--- three-component decomposition ---
  mean |house effect|:           1.678 pp
  mean |sampling noise|:         1.209 pp
  mean residual systematic bias: -2.449 pp

--- variance decomposition ---
  var(total error):              7.8135
  var(house effects):            4.3523  (55.7%)
  var(sampling noise):           2.7494  (35.2%)
  var(residual systematic bias): 0.3527  (4.5%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.691       12
             Morning Consult        -2.246       19
                   Siena/NYT         1.353       12
                      YouGov        -1.029        7
Redfield & Wilton Strategies         1.016       12
                    Mitchell         0.848        8
                     Emerson         0.733        7
                 Beacon/Shaw         0.424        6
                  Quinnipiac        -0.231        6

figure saved to: figures/kalman_he_MI_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_MI_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_MI_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (michigan | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 176
  polls after filter:  174
  polls dropped:       2
michigan polls loaded: 174 questions from 111 polls, 48 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.236 pp

sanity check — unique true_margin values: [1.41420144]

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.515522    0.000100      1.8041
    2        0.004679    0.000100      1.8045
    3        0.000022    0.000100      1.8045

em converged at iteration 3 (max change 2.16e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — michigan (trump margin, unanchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.236 pp
  mean total error:              -2.650 pp
  sd of total error:             2.795 pp

--- three-component decomposition ---
  mean |house effect|:           1.715 pp
  mean |sampling noise|:         1.201 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         3.169       12
             Morning Consult        -2.269       19
                   Siena/NYT         1.402       12
                      YouGov        -1.050        7
                    Mitchell         0.998        8
Redfield & Wilton Strategies         0.819       12
                     Emerson         0.721        7
                  Quinnipiac        -0.431        6
                 Beacon/Shaw         0.236        6

figure saved to: figures/kalman_he_MI_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_MI_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_MI_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: michigan (MI) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (michigan | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 176
  polls after filter:  170
  polls dropped:       6
michigan polls loaded: 170 questions from 107 polls, 46 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 4.0 pp
mean poll margin: -1.323 pp

sanity check — unique true_margin values: [1.41420144]

election result appended: margin = 1.414 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.509894

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.538227    0.509894      1.7195
    2        0.786696    0.263577      1.8125
    3        0.331208    0.249031      1.8206
    4        0.105247    0.229608      1.8213
    5        0.061698    0.222156      1.8198
    6        0.034216    0.217542      1.8188
    7        0.019734    0.215075      1.8183
    8        0.011066    0.213663      1.8180
    9        0.006262    0.212925      1.8178
   10        0.003454    0.212482      1.8177
   11        0.001963    0.212236      1.8177
   12        0.001109    0.212088      1.8177
   13        0.000637    0.211990      1.8177
   14        0.000386    0.211990      1.8177
   15        0.000169    0.211941      1.8176
   16        0.000131    0.211941      1.8176
   17        0.000055    0.211941      1.8176

em converged at iteration 17 (max change 5.48e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — michigan (trump margin, anchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.211941 per day
interpretation: true opinion can move ~0.460 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.323 pp
  mean total error:              -2.738 pp
  sd of total error:             2.754 pp

--- three-component decomposition ---
  mean |house effect|:           1.689 pp
  mean |sampling noise|:         1.215 pp
  mean residual systematic bias: -2.533 pp

--- variance decomposition ---
  var(total error):              7.5835
  var(house effects):            4.3070  (56.8%)
  var(sampling noise):           2.7232  (35.9%)
  var(residual systematic bias): 0.3114  (4.1%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.731       12
             Morning Consult        -2.375       18
                   Siena/NYT         1.415       12
Redfield & Wilton Strategies         1.092       12
                      YouGov        -0.982        7
                    Mitchell         0.881        8
                     Emerson         0.866        7
                 Beacon/Shaw         0.582        6
                  Quinnipiac        -0.195        6

figure saved to: figures/kalman_he_MI_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_MI_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_MI_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (michigan | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 176
  polls after filter:  170
  polls dropped:       6
michigan polls loaded: 170 questions from 107 polls, 46 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 4.0 pp
mean poll margin: -1.323 pp

sanity check — unique true_margin values: [1.41420144]

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.426781    0.000100      1.7802
    2        0.001198    0.000100      1.7803
    3        0.000003    0.000100      1.7803

em converged at iteration 3 (max change 2.82e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — michigan (trump margin, unanchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.323 pp
  mean total error:              -2.738 pp
  sd of total error:             2.754 pp

--- three-component decomposition ---
  mean |house effect|:           1.737 pp
  mean |sampling noise|:         1.187 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         3.256       12
             Morning Consult        -2.542       18
                   Siena/NYT         1.490       12
                    Mitchell         1.086        8
                      YouGov        -0.962        7
Redfield & Wilton Strategies         0.907       12
                     Emerson         0.809        7
                  Quinnipiac        -0.344        6
                 Beacon/Shaw         0.324        6

figure saved to: figures/kalman_he_MI_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_MI_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_MI_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: nevada (NV) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (nevada | ALL DATA)
======================================================================
nevada polls loaded: 106 questions from 66 polls, 28 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -9.0 to 8.7 pp
mean poll margin: -0.299 pp

sanity check — unique true_margin values: [3.14001699]

election result appended: margin = 3.140 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.367521

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.522630    0.367521      1.9347
    2        0.896630    0.284080      2.1409
    3        0.333490    0.278379      2.2102
    4        0.114846    0.274566      2.2386
    5        0.041998    0.273552      2.2493
    6        0.016236    0.273235      2.2535
    7        0.006523    0.273045      2.2553
    8        0.002707    0.272981      2.2559
    9        0.001170    0.272981      2.2562
   10        0.000526    0.272981      2.2564
   11        0.000232    0.272981      2.2564
   12        0.000101    0.272981      2.2564
   13        0.000044    0.272981      2.2565

em converged at iteration 13 (max change 4.40e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — nevada (trump margin, anchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.272981 per day
interpretation: true opinion can move ~0.522 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.299 pp
  mean total error:              -3.439 pp
  sd of total error:             2.967 pp

--- three-component decomposition ---
  mean |house effect|:           1.580 pp
  mean |sampling noise|:         1.154 pp
  mean residual systematic bias: -3.208 pp

--- variance decomposition ---
  var(total error):              8.8052
  var(house effects):            4.2986  (48.8%)
  var(sampling noise):           1.9156  (21.8%)
  var(residual systematic bias): 4.0867  (46.4%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         1.707       12
             Morning Consult        -1.442       18
                   Siena/NYT        -1.267       10
Redfield & Wilton Strategies         0.982       12
                     Emerson         0.482        6
   Noble Predictive Insights        -0.198        5

figure saved to: figures/kalman_he_NV_anchored_all_data.png
poll results exported to: data/kalman_he_polls_NV_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_NV_anchored_all_data.csv

======================================================================
UNANCHORED MODE (nevada | ALL DATA)
======================================================================
nevada polls loaded: 106 questions from 66 polls, 28 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -9.0 to 8.7 pp
mean poll margin: -0.299 pp

sanity check — unique true_margin values: [3.14001699]

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.086886

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.432391    0.086886      1.9960
    2        0.413779    0.075566      2.0855
    3        0.111486    0.077401      2.0970
    4        0.028621    0.076795      2.1005
    5        0.009232    0.076848      2.1011
    6        0.003145    0.076777      2.1013
    7        0.001291    0.076742      2.1013
    8        0.000561    0.076724      2.1013
    9        0.000288    0.076724      2.1013
   10        0.000106    0.076706      2.1013
   11        0.000136    0.076706      2.1012
   12        0.000041    0.076706      2.1012

em converged at iteration 12 (max change 4.06e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — nevada (trump margin, unanchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.076706 per day
interpretation: true opinion can move ~0.277 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.299 pp
  mean total error:              -3.439 pp
  sd of total error:             2.967 pp

--- three-component decomposition ---
  mean |house effect|:           1.579 pp
  mean |sampling noise|:         1.132 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.460       12
             Morning Consult        -2.010       18
Redfield & Wilton Strategies         0.780       12
                     Emerson         0.759        6
   Noble Predictive Insights        -0.647        5
                   Siena/NYT        -0.263       10

figure saved to: figures/kalman_he_NV_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_NV_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_NV_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: nevada (NV) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (nevada | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 106
  polls after filter:  103
  polls dropped:       3
nevada polls loaded: 103 questions from 64 polls, 28 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -9.0 to 6.0 pp
mean poll margin: -0.528 pp

sanity check — unique true_margin values: [3.14001699]

election result appended: margin = 3.140 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.414766

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.560558    0.414766      1.9168
    2        0.908506    0.312710      2.1334
    3        0.359458    0.304297      2.2076
    4        0.122900    0.298052      2.2370
    5        0.044190    0.296147      2.2475
    6        0.017910    0.295263      2.2514
    7        0.007700    0.294856      2.2529
    8        0.003323    0.294652      2.2534
    9        0.001448    0.294584      2.2536
   10        0.000612    0.294584      2.2537
   11        0.000238    0.294584      2.2537
   12        0.000093    0.294516      2.2537

em converged at iteration 12 (max change 9.34e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — nevada (trump margin, anchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.294516 per day
interpretation: true opinion can move ~0.543 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.528 pp
  mean total error:              -3.668 pp
  sd of total error:             2.675 pp

--- three-component decomposition ---
  mean |house effect|:           1.587 pp
  mean |sampling noise|:         1.162 pp
  mean residual systematic bias: -3.452 pp

--- variance decomposition ---
  var(total error):              7.1532
  var(house effects):            4.3980  (61.5%)
  var(sampling noise):           1.9364  (27.1%)
  var(residual systematic bias): 2.2232  (31.1%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         1.697       12
                   Siena/NYT        -1.436        8
             Morning Consult        -1.363       18
Redfield & Wilton Strategies         0.974       12
   Noble Predictive Insights        -0.237        5
                     Emerson         0.218        5

figure saved to: figures/kalman_he_NV_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NV_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NV_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (nevada | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 106
  polls after filter:  103
  polls dropped:       3
nevada polls loaded: 103 questions from 64 polls, 28 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -9.0 to 6.0 pp
mean poll margin: -0.528 pp

sanity check — unique true_margin values: [3.14001699]

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.027761

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.401601    0.027761      2.0017
    2        0.239683    0.023500      2.0314
    3        0.062440    0.025863      2.0298
    4        0.052457    0.024324      2.0313
    5        0.021885    0.025226      2.0303
    6        0.016093    0.024650      2.0309
    7        0.009341    0.024990      2.0305
    8        0.005732    0.024771      2.0307
    9        0.003661    0.024898      2.0305
   10        0.002100    0.024817      2.0306
   11        0.001356    0.024863      2.0306
   12        0.000759    0.024835      2.0306
   13        0.000484    0.024846      2.0306
   14        0.000174    0.024840      2.0306
   15        0.000094    0.024840      2.0306

em converged at iteration 15 (max change 9.45e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — nevada (trump margin, unanchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.024840 per day
interpretation: true opinion can move ~0.158 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.528 pp
  mean total error:              -3.668 pp
  sd of total error:             2.675 pp

--- three-component decomposition ---
  mean |house effect|:           1.568 pp
  mean |sampling noise|:         1.226 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.384       12
             Morning Consult        -1.855       18
Redfield & Wilton Strategies         0.921       12
   Noble Predictive Insights        -0.881        5
                     Emerson         0.271        5
                   Siena/NYT        -0.046        8

figure saved to: figures/kalman_he_NV_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NV_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NV_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: nevada (NV) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (nevada | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 106
  polls after filter:  102
  polls dropped:       4
nevada polls loaded: 102 questions from 63 polls, 28 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -9.0 to 6.0 pp
mean poll margin: -0.562 pp

sanity check — unique true_margin values: [3.14001699]

election result appended: margin = 3.140 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.452443

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.579567    0.452443      1.9136
    2        0.913346    0.331596      2.1303
    3        0.375947    0.321276      2.2101
    4        0.130936    0.313875      2.2429
    5        0.047717    0.311545      2.2552
    6        0.019428    0.310452      2.2600
    7        0.008420    0.310061      2.2618
    8        0.003589    0.309848      2.2625
    9        0.001558    0.309705      2.2628
   10        0.000707    0.309705      2.2629
   11        0.000274    0.309705      2.2630
   12        0.000107    0.309634      2.2630
   13        0.000164    0.309634      2.2630
   14        0.000037    0.309634      2.2630

em converged at iteration 14 (max change 3.66e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — nevada (trump margin, anchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.309634 per day
interpretation: true opinion can move ~0.556 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.562 pp
  mean total error:              -3.702 pp
  sd of total error:             2.664 pp

--- three-component decomposition ---
  mean |house effect|:           1.610 pp
  mean |sampling noise|:         1.151 pp
  mean residual systematic bias: -3.495 pp

--- variance decomposition ---
  var(total error):              7.0996
  var(house effects):            4.4757  (63.0%)
  var(sampling noise):           1.9116  (26.9%)
  var(residual systematic bias): 2.0931  (29.5%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         1.702       12
             Morning Consult        -1.461       17
                   Siena/NYT        -1.437        8
Redfield & Wilton Strategies         0.990       12
   Noble Predictive Insights        -0.254        5
                     Emerson         0.213        5

figure saved to: figures/kalman_he_NV_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NV_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NV_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (nevada | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 106
  polls after filter:  102
  polls dropped:       4
nevada polls loaded: 102 questions from 63 polls, 28 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -9.0 to 6.0 pp
mean poll margin: -0.562 pp

sanity check — unique true_margin values: [3.14001699]

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.022425

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.426794    0.022425      2.0195
    2        0.214082    0.003056      2.0407
    3        0.517300    0.008997      2.0339
    4        0.200132    0.000100      2.0359
    5        0.353970    0.000100      2.0319
    6        0.000465    0.000100      2.0319
    7        0.000001    0.000100      2.0319

em converged at iteration 7 (max change 1.00e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — nevada (trump margin, unanchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.562 pp
  mean total error:              -3.702 pp
  sd of total error:             2.664 pp

--- three-component decomposition ---
  mean |house effect|:           1.642 pp
  mean |sampling noise|:         1.297 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.280       12
             Morning Consult        -2.054       17
Redfield & Wilton Strategies         1.062       12
   Noble Predictive Insights        -1.037        5
                   Siena/NYT         0.311        8
                     Emerson         0.223        5

figure saved to: figures/kalman_he_NV_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NV_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NV_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: north carolina (NC) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (north carolina | ALL DATA)
======================================================================
north carolina polls loaded: 145 questions from 93 polls, 37 pollsters
date range: 2024-02-16 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.563 pp

sanity check — unique true_margin values: [3.21185245]

election result appended: margin = 3.212 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.250246

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.928385    0.250246      1.2494
    2        0.630855    0.167335      1.3857
    3        0.249376    0.157275      1.4291
    4        0.078810    0.151575      1.4412
    5        0.027816    0.149730      1.4451
    6        0.011719    0.149034      1.4464
    7        0.004889    0.148755      1.4468
    8        0.002045    0.148651      1.4469
    9        0.000835    0.148616      1.4470
   10        0.000326    0.148581      1.4470
   11        0.000175    0.148581      1.4470
   12        0.000051    0.148581      1.4470

em converged at iteration 12 (max change 5.11e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — north carolina (trump margin, anchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.148581 per day
interpretation: true opinion can move ~0.385 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.563 pp
  mean total error:              -2.649 pp
  sd of total error:             2.269 pp

--- three-component decomposition ---
  mean |house effect|:           1.086 pp
  mean |sampling noise|:         1.079 pp
  mean residual systematic bias: -2.524 pp

--- variance decomposition ---
  var(total error):              5.1500
  var(house effects):            2.1921  (42.6%)
  var(sampling noise):           2.0819  (40.4%)
  var(residual systematic bias): 1.2449  (24.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.266       12
                   SurveyUSA        -1.313        5
Redfield & Wilton Strategies         1.240       12
                  Quinnipiac        -1.162        6
                      YouGov        -0.737        6
                     Emerson         0.597        7
                  AtlasIntel        -0.389       12
                 Beacon/Shaw         0.036       10
             Morning Consult        -0.033       19

figure saved to: figures/kalman_he_NC_anchored_all_data.png
poll results exported to: data/kalman_he_polls_NC_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_NC_anchored_all_data.csv

======================================================================
UNANCHORED MODE (north carolina | ALL DATA)
======================================================================
north carolina polls loaded: 145 questions from 93 polls, 37 pollsters
date range: 2024-02-16 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.563 pp

sanity check — unique true_margin values: [3.21185245]

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.071626

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.782963    0.071626      1.2937
    2        0.338792    0.056281      1.3596
    3        0.101659    0.057568      1.3693
    4        0.023922    0.057093      1.3709
    5        0.007157    0.057251      1.3712
    6        0.002443    0.057251      1.3712
    7        0.000777    0.057278      1.3712
    8        0.000308    0.057278      1.3712
    9        0.000097    0.057278      1.3712

em converged at iteration 9 (max change 9.72e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — north carolina (trump margin, unanchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.057278 per day
interpretation: true opinion can move ~0.239 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.563 pp
  mean total error:              -2.649 pp
  sd of total error:             2.269 pp

--- three-component decomposition ---
  mean |house effect|:           1.040 pp
  mean |sampling noise|:         1.106 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.089       12
                   SurveyUSA        -1.515        5
                  Quinnipiac        -1.504        6
Redfield & Wilton Strategies         1.123       12
                     Emerson         0.789        7
                      YouGov        -0.348        6
                  AtlasIntel         0.181       12
             Morning Consult        -0.143       19
                 Beacon/Shaw        -0.076       10

figure saved to: figures/kalman_he_NC_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_NC_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_NC_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: north carolina (NC) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (north carolina | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 145
  polls after filter:  144
  polls dropped:       1
north carolina polls loaded: 144 questions from 92 polls, 37 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.503 pp

sanity check — unique true_margin values: [3.21185245]

election result appended: margin = 3.212 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.262003

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.918753    0.262003      1.2436
    2        0.637684    0.167023      1.3819
    3        0.263571    0.155708      1.4261
    4        0.089664    0.148755      1.4386
    5        0.044198    0.146485      1.4430
    6        0.019280    0.145499      1.4444
    7        0.008619    0.145125      1.4449
    8        0.003691    0.144972      1.4451
    9        0.001571    0.144906      1.4451
   10        0.000677    0.144906      1.4452
   11        0.000201    0.144872      1.4452
   12        0.000169    0.144872      1.4452
   13        0.000048    0.144872      1.4452

em converged at iteration 13 (max change 4.83e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — north carolina (trump margin, anchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.144872 per day
interpretation: true opinion can move ~0.381 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.503 pp
  mean total error:              -2.709 pp
  sd of total error:             2.159 pp

--- three-component decomposition ---
  mean |house effect|:           1.082 pp
  mean |sampling noise|:         1.091 pp
  mean residual systematic bias: -2.584 pp

--- variance decomposition ---
  var(total error):              4.6607
  var(house effects):            2.1997  (47.2%)
  var(sampling noise):           2.1395  (45.9%)
  var(residual systematic bias): 0.8505  (18.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.256       12
                   SurveyUSA        -1.305        5
Redfield & Wilton Strategies         1.260       12
                  Quinnipiac        -1.167        6
                      YouGov        -0.745        6
                     Emerson         0.405        6
                  AtlasIntel        -0.397       12
                 Beacon/Shaw         0.033       10
             Morning Consult         0.024       19

figure saved to: figures/kalman_he_NC_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NC_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NC_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (north carolina | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 145
  polls after filter:  144
  polls dropped:       1
north carolina polls loaded: 144 questions from 92 polls, 37 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.503 pp

sanity check — unique true_margin values: [3.21185245]

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.498662    0.000100      1.3302
    2        0.002073    0.000100      1.3304
    3        0.000008    0.000100      1.3304

em converged at iteration 3 (max change 8.20e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — north carolina (trump margin, unanchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.503 pp
  mean total error:              -2.709 pp
  sd of total error:             2.159 pp

--- three-component decomposition ---
  mean |house effect|:           1.012 pp
  mean |sampling noise|:         1.203 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.003       12
                  Quinnipiac        -1.835        6
                   SurveyUSA        -1.503        5
Redfield & Wilton Strategies         1.247       12
                  AtlasIntel         0.337       12
                     Emerson         0.264        6
                 Beacon/Shaw        -0.203       10
                      YouGov        -0.171        6
             Morning Consult         0.036       19

figure saved to: figures/kalman_he_NC_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NC_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NC_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: north carolina (NC) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (north carolina | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 145
  polls after filter:  142
  polls dropped:       3
north carolina polls loaded: 142 questions from 90 polls, 36 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 4.0 pp
mean poll margin: 0.411 pp

sanity check — unique true_margin values: [3.21185245]

election result appended: margin = 3.212 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.218398

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.950772    0.218398      1.2515
    2        0.605435    0.132734      1.3768
    3        0.251841    0.124581      1.4120
    4        0.072805    0.119350      1.4198
    5        0.024882    0.117735      1.4216
    6        0.011624    0.117060      1.4220
    7        0.005207    0.116817      1.4221
    8        0.002189    0.116709      1.4221
    9        0.000929    0.116655      1.4221
   10        0.000410    0.116655      1.4221
   11        0.000130    0.116655      1.4221
   12        0.000041    0.116655      1.4221

em converged at iteration 12 (max change 4.09e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — north carolina (trump margin, anchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.116655 per day
interpretation: true opinion can move ~0.342 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.411 pp
  mean total error:              -2.800 pp
  sd of total error:             1.998 pp

--- three-component decomposition ---
  mean |house effect|:           1.100 pp
  mean |sampling noise|:         1.096 pp
  mean residual systematic bias: -2.644 pp

--- variance decomposition ---
  var(total error):              3.9920
  var(house effects):            2.1885  (54.8%)
  var(sampling noise):           2.0578  (51.5%)
  var(residual systematic bias): 0.6979  (17.5%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.166       12
Redfield & Wilton Strategies         1.393       12
                   SurveyUSA        -1.253        5
                  Quinnipiac        -1.164        6
                      YouGov        -0.765        6
                  AtlasIntel        -0.421       12
                     Emerson         0.418        6
             Morning Consult        -0.151       18
                 Beacon/Shaw         0.028       10

figure saved to: figures/kalman_he_NC_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NC_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NC_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (north carolina | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 145
  polls after filter:  142
  polls dropped:       3
north carolina polls loaded: 142 questions from 90 polls, 36 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 4.0 pp
mean poll margin: 0.411 pp

sanity check — unique true_margin values: [3.21185245]

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.589762    0.000100      1.2945
    2        0.001203    0.000100      1.2947
    3        0.000003    0.000100      1.2947

em converged at iteration 3 (max change 3.08e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — north carolina (trump margin, unanchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.411 pp
  mean total error:              -2.800 pp
  sd of total error:             1.998 pp

--- three-component decomposition ---
  mean |house effect|:           1.051 pp
  mean |sampling noise|:         1.146 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -1.911       12
                  Quinnipiac        -1.744        6
                   SurveyUSA        -1.411        5
Redfield & Wilton Strategies         1.339       12
                  AtlasIntel         0.428       12
             Morning Consult        -0.398       18
                     Emerson         0.355        6
                 Beacon/Shaw        -0.111       10
                      YouGov        -0.080        6

figure saved to: figures/kalman_he_NC_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NC_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NC_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (pennsylvania | ALL DATA)
======================================================================
pennsylvania polls loaded: 212 questions from 132 polls, 59 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 9.7 pp
mean poll margin: -0.488 pp

sanity check — unique true_margin values: [1.70973099]

election result appended: margin = 1.710 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.157566

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.725011    0.157566      1.6404
    2        0.518914    0.120976      1.7168
    3        0.162388    0.118217      1.7386
    4        0.049348    0.115979      1.7451
    5        0.017455    0.115277      1.7474
    6        0.007647    0.114944      1.7483
    7        0.003802    0.114812      1.7486
    8        0.001745    0.114733      1.7488
    9        0.000869    0.114706      1.7488
   10        0.000378    0.114706      1.7489
   11        0.000123    0.114706      1.7489
   12        0.000041    0.114706      1.7489

em converged at iteration 12 (max change 4.14e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — pennsylvania (trump margin, anchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.114706 per day
interpretation: true opinion can move ~0.339 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.488 pp
  mean total error:              -2.198 pp
  sd of total error:             2.523 pp

--- three-component decomposition ---
  mean |house effect|:           1.488 pp
  mean |sampling noise|:         1.062 pp
  mean residual systematic bias: -2.046 pp

--- variance decomposition ---
  var(total error):              6.3665
  var(house effects):            3.0500  (47.9%)
  var(sampling noise):           1.8907  (29.7%)
  var(residual systematic bias): 1.4708  (23.1%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.790        5
                   AtlasIntel         2.025       12
Franklin and Marshall College        -1.790        5
                      Emerson         1.671       11
                    Siena/NYT        -1.389       22
                   Quinnipiac        -1.370        8
                       YouGov        -1.242       10
              Morning Consult        -1.213       19
 Redfield & Wilton Strategies         0.982       13
                  Beacon/Shaw        -0.368       10

figure saved to: figures/kalman_he_PA_anchored_all_data.png
poll results exported to: data/kalman_he_polls_PA_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_PA_anchored_all_data.csv

======================================================================
UNANCHORED MODE (pennsylvania | ALL DATA)
======================================================================
pennsylvania polls loaded: 212 questions from 132 polls, 59 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 9.7 pp
mean poll margin: -0.488 pp

sanity check — unique true_margin values: [1.70973099]

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.071942

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.835182    0.071942      1.6319
    2        0.307261    0.056113      1.6723
    3        0.070141    0.057655      1.6787
    4        0.009083    0.057172      1.6794
    5        0.003728    0.057238      1.6796
    6        0.000492    0.057212      1.6796
    7        0.000358    0.057212      1.6796
    8        0.000102    0.057212      1.6796
    9        0.000032    0.057212      1.6796

em converged at iteration 9 (max change 3.17e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — pennsylvania (trump margin, unanchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.057212 per day
interpretation: true opinion can move ~0.239 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.488 pp
  mean total error:              -2.198 pp
  sd of total error:             2.523 pp

--- three-component decomposition ---
  mean |house effect|:           1.489 pp
  mean |sampling noise|:         1.011 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.825        5
                   AtlasIntel         2.519       12
Franklin and Marshall College        -1.939        5
                      Emerson         1.632       11
                   Quinnipiac        -1.554        8
                    Siena/NYT        -1.339       22
              Morning Consult        -1.322       19
                       YouGov        -1.144       10
 Redfield & Wilton Strategies         0.851       13
                  Beacon/Shaw        -0.355       10

figure saved to: figures/kalman_he_PA_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_PA_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_PA_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (pennsylvania | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 212
  polls after filter:  209
  polls dropped:       3
pennsylvania polls loaded: 209 questions from 130 polls, 59 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: -0.575 pp

sanity check — unique true_margin values: [1.70973099]

election result appended: margin = 1.710 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.157421

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.719606    0.157421      1.6401
    2        0.516175    0.125333      1.7138
    3        0.158265    0.122673      1.7347
    4        0.047617    0.120262      1.7410
    5        0.016988    0.119460      1.7431
    6        0.008429    0.119073      1.7440
    7        0.004227    0.118908      1.7443
    8        0.001992    0.118825      1.7445
    9        0.000957    0.118797      1.7446
   10        0.000405    0.118769      1.7446
   11        0.000240    0.118769      1.7446
   12        0.000072    0.118769      1.7446

em converged at iteration 12 (max change 7.18e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — pennsylvania (trump margin, anchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.118769 per day
interpretation: true opinion can move ~0.345 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.575 pp
  mean total error:              -2.285 pp
  sd of total error:             2.408 pp

--- three-component decomposition ---
  mean |house effect|:           1.472 pp
  mean |sampling noise|:         1.064 pp
  mean residual systematic bias: -2.138 pp

--- variance decomposition ---
  var(total error):              5.7964
  var(house effects):            3.0134  (52.0%)
  var(sampling noise):           1.9155  (33.0%)
  var(residual systematic bias): 0.9108  (15.7%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.783        5
                   AtlasIntel         2.024       12
Franklin and Marshall College        -1.796        5
                      Emerson         1.471       10
                   Quinnipiac        -1.376        8
                    Siena/NYT        -1.337       20
                       YouGov        -1.245       10
              Morning Consult        -1.189       19
 Redfield & Wilton Strategies         0.975       13
                  Beacon/Shaw        -0.373       10

figure saved to: figures/kalman_he_PA_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_PA_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_PA_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (pennsylvania | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 212
  polls after filter:  209
  polls dropped:       3
pennsylvania polls loaded: 209 questions from 130 polls, 59 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: -0.575 pp

sanity check — unique true_margin values: [1.70973099]

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.052048

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.832097    0.052048      1.6441
    2        0.245022    0.041247      1.6750
    3        0.109795    0.042925      1.6802
    4        0.007081    0.041926      1.6804
    5        0.013028    0.042024      1.6806
    6        0.001008    0.041887      1.6806
    7        0.002155    0.041877      1.6807
    8        0.000521    0.041858      1.6807
    9        0.000377    0.041848      1.6807
   10        0.000205    0.041848      1.6807
   11        0.000038    0.041848      1.6807

em converged at iteration 11 (max change 3.75e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — pennsylvania (trump margin, unanchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.041848 per day
interpretation: true opinion can move ~0.205 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.575 pp
  mean total error:              -2.285 pp
  sd of total error:             2.408 pp

--- three-component decomposition ---
  mean |house effect|:           1.466 pp
  mean |sampling noise|:         1.024 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.795        5
                   AtlasIntel         2.512       12
Franklin and Marshall College        -1.954        5
                   Quinnipiac        -1.592        8
                      Emerson         1.360       10
              Morning Consult        -1.264       19
                    Siena/NYT        -1.252       20
                       YouGov        -1.164       10
 Redfield & Wilton Strategies         0.844       13
                  Beacon/Shaw        -0.323       10

figure saved to: figures/kalman_he_PA_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_PA_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_PA_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (pennsylvania | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 212
  polls after filter:  201
  polls dropped:       11
pennsylvania polls loaded: 201 questions from 125 polls, 57 pollsters
date range: 2024-07-21 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 6.0 pp
mean poll margin: -0.712 pp

sanity check — unique true_margin values: [1.70973099]

election result appended: margin = 1.710 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.146587

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.717154    0.146587      1.6702
    2        0.483085    0.099418      1.7483
    3        0.216436    0.094606      1.7719
    4        0.077357    0.090716      1.7794
    5        0.042786    0.089396      1.7821
    6        0.018586    0.088770      1.7832
    7        0.008455    0.088524      1.7837
    8        0.003601    0.088402      1.7839
    9        0.001642    0.088361      1.7840
   10        0.000657    0.088340      1.7840
   11        0.000289    0.088320      1.7840
   12        0.000192    0.088320      1.7841
   13        0.000048    0.088320      1.7841

em converged at iteration 13 (max change 4.81e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — pennsylvania (trump margin, anchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.088320 per day
interpretation: true opinion can move ~0.297 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.712 pp
  mean total error:              -2.422 pp
  sd of total error:             2.313 pp

--- three-component decomposition ---
  mean |house effect|:           1.522 pp
  mean |sampling noise|:         1.064 pp
  mean residual systematic bias: -2.245 pp

--- variance decomposition ---
  var(total error):              5.3489
  var(house effects):            3.1647  (59.2%)
  var(sampling noise):           1.9266  (36.0%)
  var(residual systematic bias): 0.5888  (11.0%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.804        5
                   AtlasIntel         1.981       12
Franklin and Marshall College        -1.791        5
                      Emerson         1.641       10
                    Siena/NYT        -1.611       16
                   Quinnipiac        -1.382        8
              Morning Consult        -1.357       18
                       YouGov        -1.285       10
 Redfield & Wilton Strategies         1.050       13
                  Beacon/Shaw        -0.217       10

figure saved to: figures/kalman_he_PA_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_PA_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_PA_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (pennsylvania | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 212
  polls after filter:  201
  polls dropped:       11
pennsylvania polls loaded: 201 questions from 125 polls, 57 pollsters
date range: 2024-07-21 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 6.0 pp
mean poll margin: -0.712 pp

sanity check — unique true_margin values: [1.70973099]

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.014209

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.916944    0.014209      1.6909
    2        0.139497    0.002797      1.7049
    3        0.219852    0.002783      1.7036
    4        0.016180    0.000567      1.7023
    5        0.090643    0.000374      1.6974
    6        0.012827    0.000100      1.6964
    7        0.015485    0.000100      1.6954
    8        0.000113    0.000100      1.6954
    9        0.000001    0.000100      1.6954

em converged at iteration 9 (max change 1.01e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — pennsylvania (trump margin, unanchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.712 pp
  mean total error:              -2.422 pp
  sd of total error:             2.313 pp

--- three-component decomposition ---
  mean |house effect|:           1.539 pp
  mean |sampling noise|:         1.000 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.813        5
                   AtlasIntel         2.700       12
Franklin and Marshall College        -1.888        5
                    Siena/NYT        -1.662       16
                   Quinnipiac        -1.662        8
              Morning Consult        -1.622       18
                      Emerson         1.543       10
                       YouGov        -1.040       10
 Redfield & Wilton Strategies         0.943       13
                  Beacon/Shaw        -0.088       10

figure saved to: figures/kalman_he_PA_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_PA_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_PA_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (wisconsin | ALL DATA)
======================================================================
wisconsin polls loaded: 173 questions from 102 polls, 46 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.678 pp

sanity check — unique true_margin values: [0.85882864]

election result appended: margin = 0.859 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.216938

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.250871    0.216938      1.6633
    2        0.522090    0.156364      1.7830
    3        0.370292    0.145703      1.8135
    4        0.182990    0.136594      1.8244
    5        0.102660    0.132579      1.8291
    6        0.054197    0.130343      1.8314
    7        0.029080    0.129191      1.8326
    8        0.015457    0.128584      1.8332
    9        0.008202    0.128259      1.8335
   10        0.004365    0.128111      1.8337
   11        0.002239    0.128022      1.8338
   12        0.001192    0.127962      1.8338
   13        0.000674    0.127933      1.8338
   14        0.000368    0.127933      1.8339
   15        0.000147    0.127933      1.8339
   16        0.000059    0.127933      1.8339

em converged at iteration 16 (max change 5.90e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — wisconsin (trump margin, anchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.127933 per day
interpretation: true opinion can move ~0.358 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.678 pp
  mean total error:              -2.537 pp
  sd of total error:             2.593 pp

--- three-component decomposition ---
  mean |house effect|:           1.451 pp
  mean |sampling noise|:         1.030 pp
  mean residual systematic bias: -2.322 pp

--- variance decomposition ---
  var(total error):              6.7252
  var(house effects):            3.0737  (45.7%)
  var(sampling noise):           1.9733  (29.3%)
  var(residual systematic bias): 1.2315  (18.3%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                      YouGov        -2.082        7
                  Quinnipiac         2.049        6
                     Emerson         1.980        8
                   Siena/NYT        -1.556       14
                  AtlasIntel         1.500       12
        Marquette Law School        -0.805       16
                        TIPP         0.783        8
             Morning Consult        -0.360       19
Redfield & Wilton Strategies         0.305       12

figure saved to: figures/kalman_he_WI_anchored_all_data.png
poll results exported to: data/kalman_he_polls_WI_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_WI_anchored_all_data.csv

======================================================================
UNANCHORED MODE (wisconsin | ALL DATA)
======================================================================
wisconsin polls loaded: 173 questions from 102 polls, 46 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.678 pp

sanity check — unique true_margin values: [0.85882864]

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.086025

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.264296    0.086025      1.7297
    2        0.366731    0.046527      1.8023
    3        0.360582    0.042347      1.8368
    4        0.106342    0.036813      1.8469
    5        0.075687    0.035291      1.8535
    6        0.028071    0.034160      1.8561
    7        0.017936    0.033731      1.8576
    8        0.007808    0.033467      1.8583
    9        0.004452    0.033358      1.8587
   10        0.002000    0.033288      1.8589
   11        0.001180    0.033265      1.8590
   12        0.000461    0.033249      1.8590
   13        0.000267    0.033241      1.8590
   14        0.000137    0.033234      1.8590
   15        0.000120    0.033234      1.8591
   16        0.000017    0.033234      1.8591

em converged at iteration 16 (max change 1.67e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — wisconsin (trump margin, unanchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.033234 per day
interpretation: true opinion can move ~0.182 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.678 pp
  mean total error:              -2.537 pp
  sd of total error:             2.593 pp

--- three-component decomposition ---
  mean |house effect|:           1.510 pp
  mean |sampling noise|:         1.013 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                      YouGov        -2.134        7
                  AtlasIntel         2.109       12
                     Emerson         2.064        8
                  Quinnipiac         1.995        6
                   Siena/NYT        -1.352       14
        Marquette Law School        -1.005       16
                        TIPP         0.632        8
             Morning Consult        -0.520       19
Redfield & Wilton Strategies         0.165       12

figure saved to: figures/kalman_he_WI_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_WI_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_WI_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (wisconsin | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 173
  polls after filter:  170
  polls dropped:       3
wisconsin polls loaded: 170 questions from 100 polls, 46 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.745 pp

sanity check — unique true_margin values: [0.85882864]

election result appended: margin = 0.859 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.265578

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.327360    0.265578      1.6488
    2        0.558770    0.197079      1.7754
    3        0.342079    0.185827      1.8069
    4        0.178744    0.175320      1.8183
    5        0.106024    0.170442      1.8234
    6        0.059238    0.167531      1.8261
    7        0.033736    0.165962      1.8276
    8        0.018964    0.165084      1.8284
    9        0.010653    0.164588      1.8288
   10        0.005992    0.164321      1.8291
   11        0.003336    0.164168      1.8292
   12        0.001869    0.164091      1.8293
   13        0.001020    0.164053      1.8293
   14        0.000547    0.164015      1.8294
   15        0.000345    0.164015      1.8294
   16        0.000147    0.164015      1.8294
   17        0.000063    0.163977      1.8294

em converged at iteration 17 (max change 6.33e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — wisconsin (trump margin, anchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.163977 per day
interpretation: true opinion can move ~0.405 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.745 pp
  mean total error:              -2.604 pp
  sd of total error:             2.562 pp

--- three-component decomposition ---
  mean |house effect|:           1.461 pp
  mean |sampling noise|:         1.011 pp
  mean residual systematic bias: -2.413 pp

--- variance decomposition ---
  var(total error):              6.5650
  var(house effects):            3.0950  (47.1%)
  var(sampling noise):           1.8789  (28.6%)
  var(residual systematic bias): 1.0173  (15.5%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.019        7
                  Quinnipiac         2.015        6
                      YouGov        -1.996        7
                   Siena/NYT        -1.645       12
                  AtlasIntel         1.531       12
                        TIPP         0.850        8
        Marquette Law School        -0.843       16
             Morning Consult        -0.411       19
Redfield & Wilton Strategies         0.293       12

figure saved to: figures/kalman_he_WI_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_WI_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_WI_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (wisconsin | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 173
  polls after filter:  170
  polls dropped:       3
wisconsin polls loaded: 170 questions from 100 polls, 46 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.745 pp

sanity check — unique true_margin values: [0.85882864]

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.116898

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.230027    0.116898      1.7114
    2        0.420360    0.061946      1.7872
    3        0.476579    0.053262      1.8272
    4        0.191357    0.038931      1.8434
    5        0.205427    0.033350      1.8604
    6        0.109454    0.027135      1.8698
    7        0.106891    0.023836      1.8794
    8        0.064479    0.020453      1.8855
    9        0.061682    0.018348      1.8916
   10        0.041116    0.016242      1.8958
   11        0.041904    0.014790      1.9001
   12        0.031657    0.013360      1.9032
   13        0.031770    0.012303      1.9068
   14        0.025281    0.011271      1.9098
   15        0.025148    0.010466      1.9128
   16        0.020829    0.009688      1.9152
   17        0.020497    0.009055      1.9175
   18        0.017545    0.008447      1.9195
   19        0.017150    0.007938      1.9215
   20        0.014992    0.007451      1.9232
   21        0.014611    0.007032      1.9248
   22        0.013019    0.006631      1.9262
   23        0.012659    0.006280      1.9276
   24        0.011453    0.005945      1.9289
   25        0.011121    0.005645      1.9301
   26        0.010206    0.005359      1.9312
   27        0.009895    0.005100      1.9322
   28        0.009175    0.004852      1.9332
   29        0.008920    0.004625      1.9342
   30        0.008360    0.004407      1.9350
   31        0.008124    0.004205      1.9359
   32        0.007673    0.004012      1.9367
   33        0.007461    0.003831      1.9375
   34        0.007106    0.003657      1.9382
   35        0.006944    0.003493      1.9389
   36        0.006642    0.003334      1.9396
   37        0.006520    0.003183      1.9403
   38        0.006262    0.003038      1.9409
   39        0.006143    0.002898      1.9415
   40        0.005975    0.002763      1.9421
   41        0.005858    0.002633      1.9427
   42        0.005715    0.002506      1.9433
   43        0.005644    0.002384      1.9438
   44        0.005506    0.002263      1.9444
   45        0.005472    0.002147      1.9449
   46        0.005362    0.002033      1.9454
   47        0.005350    0.001922      1.9459
   48        0.005260    0.001812      1.9465
   49        0.005270    0.001705      1.9470
   50        0.005208    0.001598      1.9475

em did not converge after 50 iterations (max change 5.21e-03)

======================================================================
polling opinion trajectory with house effects — wisconsin (trump margin, unanchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.001598 per day
interpretation: true opinion can move ~0.040 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.745 pp
  mean total error:              -2.604 pp
  sd of total error:             2.562 pp

--- three-component decomposition ---
  mean |house effect|:           1.569 pp
  mean |sampling noise|:         1.084 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.295       12
                      YouGov        -2.257        7
                     Emerson         2.081        7
                  Quinnipiac         2.065        6
                   Siena/NYT        -1.584       12
        Marquette Law School        -1.049       16
                        TIPP         0.540        8
             Morning Consult        -0.486       19
Redfield & Wilton Strategies         0.167       12

figure saved to: figures/kalman_he_WI_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_WI_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_WI_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (wisconsin | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 173
  polls after filter:  166
  polls dropped:       7
wisconsin polls loaded: 166 questions from 96 polls, 43 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 2.0 pp
mean poll margin: -1.848 pp

sanity check — unique true_margin values: [0.85882864]

election result appended: margin = 0.859 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.230597

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.286674    0.230597      1.7586
    2        0.544042    0.152762      1.8617
    3        0.290259    0.142346      1.8708
    4        0.118426    0.131828      1.8709
    5        0.064969    0.127755      1.8703
    6        0.032318    0.125420      1.8709
    7        0.016912    0.124320      1.8713
    8        0.008551    0.123742      1.8714
    9        0.004383    0.123452      1.8715
   10        0.002229    0.123323      1.8715
   11        0.001084    0.123238      1.8715
   12        0.000593    0.123210      1.8716
   13        0.000270    0.123182      1.8716
   14        0.000175    0.123182      1.8716
   15        0.000055    0.123182      1.8716

em converged at iteration 15 (max change 5.46e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — wisconsin (trump margin, anchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.123182 per day
interpretation: true opinion can move ~0.351 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.848 pp
  mean total error:              -2.706 pp
  sd of total error:             2.455 pp

--- three-component decomposition ---
  mean |house effect|:           1.498 pp
  mean |sampling noise|:         1.043 pp
  mean residual systematic bias: -2.477 pp

--- variance decomposition ---
  var(total error):              6.0282
  var(house effects):            3.2038  (53.1%)
  var(sampling noise):           1.8418  (30.6%)
  var(residual systematic bias): 0.9159  (15.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.233        7
                  Quinnipiac         2.075        6
                      YouGov        -2.062        7
                   Siena/NYT        -1.587       12
                  AtlasIntel         1.513       12
                        TIPP         0.842        8
        Marquette Law School        -0.715       16
             Morning Consult        -0.647       18
Redfield & Wilton Strategies         0.396       12

figure saved to: figures/kalman_he_WI_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_WI_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_WI_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (wisconsin | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 173
  polls after filter:  166
  polls dropped:       7
wisconsin polls loaded: 166 questions from 96 polls, 43 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 2.0 pp
mean poll margin: -1.848 pp

sanity check — unique true_margin values: [0.85882864]

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.038694

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.345067    0.038694      1.8402
    2        0.243197    0.008163      1.8734
    3        0.478742    0.007350      1.9055
    4        0.061105    0.004577      1.9093
    5        0.095636    0.003993      1.9171
    6        0.031088    0.003154      1.9196
    7        0.036895    0.002841      1.9229
    8        0.016635    0.002496      1.9248
    9        0.016921    0.002331      1.9268
   10        0.008947    0.002169      1.9278
   11        0.008339    0.002081      1.9288
   12        0.004844    0.002001      1.9294
   13        0.004295    0.001953      1.9299
   14        0.002634    0.001912      1.9302
   15        0.002237    0.001886      1.9304
   16        0.001436    0.001864      1.9306
   17        0.001183    0.001850      1.9307
   18        0.000785    0.001839      1.9308
   19        0.000628    0.001831      1.9309
   20        0.000426    0.001825      1.9310
   21        0.000349    0.001821      1.9310
   22        0.000215    0.001817      1.9310
   23        0.000186    0.001815      1.9310
   24        0.000119    0.001813      1.9311
   25        0.000115    0.001812      1.9311
   26        0.000050    0.001811      1.9311

em converged at iteration 26 (max change 5.04e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — wisconsin (trump margin, unanchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.001811 per day
interpretation: true opinion can move ~0.043 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.848 pp
  mean total error:              -2.706 pp
  sd of total error:             2.455 pp

--- three-component decomposition ---
  mean |house effect|:           1.611 pp
  mean |sampling noise|:         1.052 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         2.380       12
                     Emerson         2.194        7
                      YouGov        -2.158        7
                  Quinnipiac         2.157        6
                   Siena/NYT        -1.478       12
             Morning Consult        -0.947       18
        Marquette Law School        -0.940       16
                        TIPP         0.648        8
Redfield & Wilton Strategies         0.274       12

figure saved to: figures/kalman_he_WI_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_WI_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_WI_unanchored_last_107_days.csv

======================================================================
analysis completed: 2026-02-17 23:45:23
log saved to: output/kalman_house_effects_swingstates_log_20260217_234201.txt
