kalman filtering & smoothing analysis — swing states (within-day aggregated version)
started: 2026-02-23 16:44:50
log file: output/kalman/kalman_daily_aggregated_swingstates_log_20260223_164450.txt
states: ['arizona', 'georgia', 'michigan', 'nevada', 'north carolina', 'pennsylvania', 'wisconsin']
time windows: [None, 200, 107]

======================================================================
======================================================================
ANALYZING: arizona (AZ) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (arizona | ALL DATA)
======================================================================
arizona polls loaded: 163 questions from 103 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.453 pp

sanity check — unique true_margin values: [5.52860324]

within-day aggregation complete:
  observations before: 163 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.6
  mean combined n:     2177
  mean combined var:   7.4046 pp^2
  mean individual var (pre-agg): 12.5285 pp^2
  variance reduction factor: 1.7x

election result appended: margin = 5.529 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.468393 per day
  interpretation: true opinion can move ~0.684 pp/day (1 sd)

============================================================
polling bias decomposition — arizona (trump margin, anchored)
============================================================

true margin (certified result): 5.529 pp

--- overall poll error ---
  mean poll margin:          1.939 pp
  mean total error:          -3.590 pp
  sd of total error:         2.717 pp

--- decomposition (means) ---
  mean systematic bias:      -3.765 pp
  mean |sampling noise|:     1.469 pp

--- variance decomposition ---
  var(total error):          7.3819
  var(systematic bias):      2.9275  (39.7%)
  var(sampling noise):       3.3117  (44.9%)

figure saved to: figures/kalman_agg_AZ_bias_anchored_all_data.png
results exported to: data/kalman_agg_AZ_results_anchored_all_data.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (arizona | ALL DATA)
======================================================================
arizona polls loaded: 163 questions from 103 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.453 pp

within-day aggregation complete:
  observations before: 163 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.6
  mean combined n:     2177
  mean combined var:   7.4046 pp^2
  mean individual var (pre-agg): 12.5285 pp^2
  variance reduction factor: 1.7x

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.122135 per day
  interpretation: true opinion can move ~0.349 pp/day (1 sd)

============================================================
polling opinion trajectory — arizona (trump margin, unanchored)
============================================================

true margin (certified result): 5.529 pp

--- overall poll error ---
  mean poll margin:          1.939 pp
  mean total error:          -3.590 pp
  sd of total error:         2.717 pp

--- decomposition (means) ---
  final forecast error:      -3.033 pp
  mean smoothed-poll gap:    1.723 pp
  mean |sampling noise|:     1.723 pp

figure saved to: figures/kalman_agg_AZ_trajectory_unanchored_all_data.png
results exported to: data/kalman_agg_AZ_results_unanchored_all_data.csv

======================================================================
COMPARISON: anchored vs unanchored (arizona | ALL DATA)
======================================================================
sigma2_u (anchored):   0.468393
sigma2_u (unanchored): 0.122135
ratio (anchored/unanchored): 3.835

final smoothed estimate (anchored):   4.752 pp
final smoothed estimate (unanchored): 2.495 pp
true margin:                          5.529 pp
unanchored forecast error:            -3.033 pp
anchored terminal adjustment:         0.777 pp

======================================================================
======================================================================
ANALYZING: arizona (AZ) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (arizona | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 164
  polls after filter:  161
  polls dropped:       3
arizona polls loaded: 160 questions from 101 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.372 pp

sanity check — unique true_margin values: [5.52860324]

within-day aggregation complete:
  observations before: 160 (individual poll questions)
  observations after:  61 (one per unique end_date)
  unique days:         61 -> 61
  mean polls per day:  2.6
  mean combined n:     2212
  mean combined var:   7.3808 pp^2
  mean individual var (pre-agg): 12.5207 pp^2
  variance reduction factor: 1.7x

election result appended: margin = 5.529 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.580711 per day
  interpretation: true opinion can move ~0.762 pp/day (1 sd)

============================================================
polling bias decomposition — arizona (trump margin, anchored)
============================================================

true margin (certified result): 5.529 pp

--- overall poll error ---
  mean poll margin:          1.801 pp
  mean total error:          -3.728 pp
  sd of total error:         2.641 pp

--- decomposition (means) ---
  mean systematic bias:      -3.908 pp
  mean |sampling noise|:     1.461 pp

--- variance decomposition ---
  var(total error):          6.9734
  var(systematic bias):      2.5109  (36.0%)
  var(sampling noise):       3.2261  (46.3%)

figure saved to: figures/kalman_agg_AZ_bias_anchored_last_200_days.png
results exported to: data/kalman_agg_AZ_results_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (arizona | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 164
  polls after filter:  161
  polls dropped:       3
arizona polls loaded: 160 questions from 101 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.372 pp

within-day aggregation complete:
  observations before: 160 (individual poll questions)
  observations after:  61 (one per unique end_date)
  unique days:         61 -> 61
  mean polls per day:  2.6
  mean combined n:     2212
  mean combined var:   7.3808 pp^2
  mean individual var (pre-agg): 12.5207 pp^2
  variance reduction factor: 1.7x

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.199145 per day
  interpretation: true opinion can move ~0.446 pp/day (1 sd)

============================================================
polling opinion trajectory — arizona (trump margin, unanchored)
============================================================

true margin (certified result): 5.529 pp

--- overall poll error ---
  mean poll margin:          1.801 pp
  mean total error:          -3.728 pp
  sd of total error:         2.641 pp

--- decomposition (means) ---
  final forecast error:      -2.867 pp
  mean smoothed-poll gap:    1.681 pp
  mean |sampling noise|:     1.681 pp

figure saved to: figures/kalman_agg_AZ_trajectory_unanchored_last_200_days.png
results exported to: data/kalman_agg_AZ_results_unanchored_last_200_days.csv

======================================================================
COMPARISON: anchored vs unanchored (arizona | LAST 200 DAYS)
======================================================================
sigma2_u (anchored):   0.580711
sigma2_u (unanchored): 0.199145
ratio (anchored/unanchored): 2.916

final smoothed estimate (anchored):   4.730 pp
final smoothed estimate (unanchored): 2.662 pp
true margin:                          5.529 pp
unanchored forecast error:            -2.867 pp
anchored terminal adjustment:         0.799 pp

======================================================================
======================================================================
ANALYZING: arizona (AZ) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (arizona | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 164
  polls after filter:  157
  polls dropped:       7
arizona polls loaded: 156 questions from 97 polls
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 7.8 pp
mean poll margin: 1.221 pp

sanity check — unique true_margin values: [5.52860324]

within-day aggregation complete:
  observations before: 156 (individual poll questions)
  observations after:  57 (one per unique end_date)
  unique days:         57 -> 57
  mean polls per day:  2.7
  mean combined n:     2316
  mean combined var:   7.0139 pp^2
  mean individual var (pre-agg): 12.5184 pp^2
  variance reduction factor: 1.8x

election result appended: margin = 5.529 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.536079 per day
  interpretation: true opinion can move ~0.732 pp/day (1 sd)

============================================================
polling bias decomposition — arizona (trump margin, anchored)
============================================================

true margin (certified result): 5.529 pp

--- overall poll error ---
  mean poll margin:          1.418 pp
  mean total error:          -4.110 pp
  sd of total error:         2.254 pp

--- decomposition (means) ---
  mean systematic bias:      -4.278 pp
  mean |sampling noise|:     1.509 pp

--- variance decomposition ---
  var(total error):          5.0811
  var(systematic bias):      1.0484  (20.6%)
  var(sampling noise):       3.4895  (68.7%)

figure saved to: figures/kalman_agg_AZ_bias_anchored_last_107_days.png
results exported to: data/kalman_agg_AZ_results_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (arizona | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 164
  polls after filter:  157
  polls dropped:       7
arizona polls loaded: 156 questions from 97 polls
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 7.8 pp
mean poll margin: 1.221 pp

within-day aggregation complete:
  observations before: 156 (individual poll questions)
  observations after:  57 (one per unique end_date)
  unique days:         57 -> 57
  mean polls per day:  2.7
  mean combined n:     2316
  mean combined var:   7.0139 pp^2
  mean individual var (pre-agg): 12.5184 pp^2
  variance reduction factor: 1.8x

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.024054 per day
  interpretation: true opinion can move ~0.155 pp/day (1 sd)

============================================================
polling opinion trajectory — arizona (trump margin, unanchored)
============================================================

true margin (certified result): 5.529 pp

--- overall poll error ---
  mean poll margin:          1.418 pp
  mean total error:          -4.110 pp
  sd of total error:         2.254 pp

--- decomposition (means) ---
  final forecast error:      -3.481 pp
  mean smoothed-poll gap:    1.757 pp
  mean |sampling noise|:     1.757 pp

figure saved to: figures/kalman_agg_AZ_trajectory_unanchored_last_107_days.png
results exported to: data/kalman_agg_AZ_results_unanchored_last_107_days.csv

======================================================================
COMPARISON: anchored vs unanchored (arizona | LAST 107 DAYS)
======================================================================
sigma2_u (anchored):   0.536079
sigma2_u (unanchored): 0.024054
ratio (anchored/unanchored): 22.286

final smoothed estimate (anchored):   4.738 pp
final smoothed estimate (unanchored): 2.048 pp
true margin:                          5.529 pp
unanchored forecast error:            -3.481 pp
anchored terminal adjustment:         0.791 pp

======================================================================
======================================================================
ANALYZING: georgia (GA) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (georgia | ALL DATA)
======================================================================
georgia polls loaded: 164 questions from 95 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.317 pp

sanity check — unique true_margin values: [2.19200309]

within-day aggregation complete:
  observations before: 164 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.6
  mean combined n:     2379
  mean combined var:   7.5543 pp^2
  mean individual var (pre-agg): 12.1781 pp^2
  variance reduction factor: 1.6x

election result appended: margin = 2.192 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.216988 per day
  interpretation: true opinion can move ~0.466 pp/day (1 sd)

============================================================
polling bias decomposition — georgia (trump margin, anchored)
============================================================

true margin (certified result): 2.192 pp

--- overall poll error ---
  mean poll margin:          1.745 pp
  mean total error:          -0.447 pp
  sd of total error:         2.690 pp

--- decomposition (means) ---
  mean systematic bias:      -0.488 pp
  mean |sampling noise|:     1.378 pp

--- variance decomposition ---
  var(total error):          7.2380
  var(systematic bias):      2.9636  (40.9%)
  var(sampling noise):       3.0460  (42.1%)

figure saved to: figures/kalman_agg_GA_bias_anchored_all_data.png
results exported to: data/kalman_agg_GA_results_anchored_all_data.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (georgia | ALL DATA)
======================================================================
georgia polls loaded: 164 questions from 95 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.317 pp

within-day aggregation complete:
  observations before: 164 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.6
  mean combined n:     2379
  mean combined var:   7.5543 pp^2
  mean individual var (pre-agg): 12.1781 pp^2
  variance reduction factor: 1.6x

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.191328 per day
  interpretation: true opinion can move ~0.437 pp/day (1 sd)

============================================================
polling opinion trajectory — georgia (trump margin, unanchored)
============================================================

true margin (certified result): 2.192 pp

--- overall poll error ---
  mean poll margin:          1.745 pp
  mean total error:          -0.447 pp
  sd of total error:         2.690 pp

--- decomposition (means) ---
  final forecast error:      -1.366 pp
  mean smoothed-poll gap:    1.401 pp
  mean |sampling noise|:     1.401 pp

figure saved to: figures/kalman_agg_GA_trajectory_unanchored_all_data.png
results exported to: data/kalman_agg_GA_results_unanchored_all_data.csv

======================================================================
COMPARISON: anchored vs unanchored (georgia | ALL DATA)
======================================================================
sigma2_u (anchored):   0.216988
sigma2_u (unanchored): 0.191328
ratio (anchored/unanchored): 1.134

final smoothed estimate (anchored):   1.877 pp
final smoothed estimate (unanchored): 0.826 pp
true margin:                          2.192 pp
unanchored forecast error:            -1.366 pp
anchored terminal adjustment:         0.315 pp

======================================================================
======================================================================
ANALYZING: georgia (GA) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (georgia | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 166
  polls after filter:  163
  polls dropped:       3
georgia polls loaded: 161 questions from 93 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.255 pp

sanity check — unique true_margin values: [2.19200309]

within-day aggregation complete:
  observations before: 161 (individual poll questions)
  observations after:  61 (one per unique end_date)
  unique days:         61 -> 61
  mean polls per day:  2.6
  mean combined n:     2420
  mean combined var:   7.5352 pp^2
  mean individual var (pre-agg): 12.1707 pp^2
  variance reduction factor: 1.6x

election result appended: margin = 2.192 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.240396 per day
  interpretation: true opinion can move ~0.490 pp/day (1 sd)

============================================================
polling bias decomposition — georgia (trump margin, anchored)
============================================================

true margin (certified result): 2.192 pp

--- overall poll error ---
  mean poll margin:          1.609 pp
  mean total error:          -0.583 pp
  sd of total error:         2.525 pp

--- decomposition (means) ---
  mean systematic bias:      -0.621 pp
  mean |sampling noise|:     1.355 pp

--- variance decomposition ---
  var(total error):          6.3780
  var(systematic bias):      2.4017  (37.7%)
  var(sampling noise):       2.9836  (46.8%)

figure saved to: figures/kalman_agg_GA_bias_anchored_last_200_days.png
results exported to: data/kalman_agg_GA_results_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (georgia | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 166
  polls after filter:  163
  polls dropped:       3
georgia polls loaded: 161 questions from 93 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.255 pp

within-day aggregation complete:
  observations before: 161 (individual poll questions)
  observations after:  61 (one per unique end_date)
  unique days:         61 -> 61
  mean polls per day:  2.6
  mean combined n:     2420
  mean combined var:   7.5352 pp^2
  mean individual var (pre-agg): 12.1707 pp^2
  variance reduction factor: 1.6x

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.211154 per day
  interpretation: true opinion can move ~0.460 pp/day (1 sd)

============================================================
polling opinion trajectory — georgia (trump margin, unanchored)
============================================================

true margin (certified result): 2.192 pp

--- overall poll error ---
  mean poll margin:          1.609 pp
  mean total error:          -0.583 pp
  sd of total error:         2.525 pp

--- decomposition (means) ---
  final forecast error:      -1.373 pp
  mean smoothed-poll gap:    1.376 pp
  mean |sampling noise|:     1.376 pp

figure saved to: figures/kalman_agg_GA_trajectory_unanchored_last_200_days.png
results exported to: data/kalman_agg_GA_results_unanchored_last_200_days.csv

======================================================================
COMPARISON: anchored vs unanchored (georgia | LAST 200 DAYS)
======================================================================
sigma2_u (anchored):   0.240396
sigma2_u (unanchored): 0.211154
ratio (anchored/unanchored): 1.138

final smoothed estimate (anchored):   1.864 pp
final smoothed estimate (unanchored): 0.819 pp
true margin:                          2.192 pp
unanchored forecast error:            -1.373 pp
anchored terminal adjustment:         0.328 pp

======================================================================
======================================================================
ANALYZING: georgia (GA) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (georgia | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 166
  polls after filter:  152
  polls dropped:       14
georgia polls loaded: 150 questions from 88 polls
date range: 2024-07-22 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 7.0 pp
mean poll margin: 0.828 pp

sanity check — unique true_margin values: [2.19200309]

within-day aggregation complete:
  observations before: 150 (individual poll questions)
  observations after:  56 (one per unique end_date)
  unique days:         56 -> 56
  mean polls per day:  2.7
  mean combined n:     2524
  mean combined var:   7.4682 pp^2
  mean individual var (pre-agg): 11.7555 pp^2
  variance reduction factor: 1.6x

election result appended: margin = 2.192 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.062540 per day
  interpretation: true opinion can move ~0.250 pp/day (1 sd)

============================================================
polling bias decomposition — georgia (trump margin, anchored)
============================================================

true margin (certified result): 2.192 pp

--- overall poll error ---
  mean poll margin:          1.095 pp
  mean total error:          -1.097 pp
  sd of total error:         1.831 pp

--- decomposition (means) ---
  mean systematic bias:      -1.144 pp
  mean |sampling noise|:     1.359 pp

--- variance decomposition ---
  var(total error):          3.3514
  var(systematic bias):      0.2707  (8.1%)
  var(sampling noise):       2.9824  (89.0%)

figure saved to: figures/kalman_agg_GA_bias_anchored_last_107_days.png
results exported to: data/kalman_agg_GA_results_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (georgia | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 166
  polls after filter:  152
  polls dropped:       14
georgia polls loaded: 150 questions from 88 polls
date range: 2024-07-22 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 7.0 pp
mean poll margin: 0.828 pp

within-day aggregation complete:
  observations before: 150 (individual poll questions)
  observations after:  56 (one per unique end_date)
  unique days:         56 -> 56
  mean polls per day:  2.7
  mean combined n:     2524
  mean combined var:   7.4682 pp^2
  mean individual var (pre-agg): 11.7555 pp^2
  variance reduction factor: 1.6x

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.000100 per day
  interpretation: true opinion can move ~0.010 pp/day (1 sd)

============================================================
polling opinion trajectory — georgia (trump margin, unanchored)
============================================================

true margin (certified result): 2.192 pp

--- overall poll error ---
  mean poll margin:          1.095 pp
  mean total error:          -1.097 pp
  sd of total error:         1.831 pp

--- decomposition (means) ---
  final forecast error:      -1.357 pp
  mean smoothed-poll gap:    1.453 pp
  mean |sampling noise|:     1.453 pp

figure saved to: figures/kalman_agg_GA_trajectory_unanchored_last_107_days.png
results exported to: data/kalman_agg_GA_results_unanchored_last_107_days.csv

======================================================================
COMPARISON: anchored vs unanchored (georgia | LAST 107 DAYS)
======================================================================
sigma2_u (anchored):   0.062540
sigma2_u (unanchored): 0.000100
ratio (anchored/unanchored): 625.403

final smoothed estimate (anchored):   2.014 pp
final smoothed estimate (unanchored): 0.835 pp
true margin:                          2.192 pp
unanchored forecast error:            -1.357 pp
anchored terminal adjustment:         0.178 pp

======================================================================
======================================================================
ANALYZING: michigan (MI) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (michigan | ALL DATA)
======================================================================
michigan polls loaded: 190 questions from 119 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.311 pp

sanity check — unique true_margin values: [1.41420144]

within-day aggregation complete:
  observations before: 190 (individual poll questions)
  observations after:  69 (one per unique end_date)
  unique days:         69 -> 69
  mean polls per day:  2.8
  mean combined n:     2265
  mean combined var:   7.9767 pp^2
  mean individual var (pre-agg): 13.0405 pp^2
  variance reduction factor: 1.6x

election result appended: margin = 1.414 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.414189 per day
  interpretation: true opinion can move ~0.644 pp/day (1 sd)

============================================================
polling bias decomposition — michigan (trump margin, anchored)
============================================================

true margin (certified result): 1.414 pp

--- overall poll error ---
  mean poll margin:          -1.155 pp
  mean total error:          -2.570 pp
  sd of total error:         2.639 pp

--- decomposition (means) ---
  mean systematic bias:      -2.640 pp
  mean |sampling noise|:     1.591 pp

--- variance decomposition ---
  var(total error):          6.9636
  var(systematic bias):      1.0717  (15.4%)
  var(sampling noise):       5.0323  (72.3%)

figure saved to: figures/kalman_agg_MI_bias_anchored_all_data.png
results exported to: data/kalman_agg_MI_results_anchored_all_data.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (michigan | ALL DATA)
======================================================================
michigan polls loaded: 190 questions from 119 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.311 pp

within-day aggregation complete:
  observations before: 190 (individual poll questions)
  observations after:  69 (one per unique end_date)
  unique days:         69 -> 69
  mean polls per day:  2.8
  mean combined n:     2265
  mean combined var:   7.9767 pp^2
  mean individual var (pre-agg): 13.0405 pp^2
  variance reduction factor: 1.6x

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.000100 per day
  interpretation: true opinion can move ~0.010 pp/day (1 sd)

============================================================
polling opinion trajectory — michigan (trump margin, unanchored)
============================================================

true margin (certified result): 1.414 pp

--- overall poll error ---
  mean poll margin:          -1.155 pp
  mean total error:          -2.570 pp
  sd of total error:         2.639 pp

--- decomposition (means) ---
  final forecast error:      -2.845 pp
  mean smoothed-poll gap:    1.989 pp
  mean |sampling noise|:     1.989 pp

figure saved to: figures/kalman_agg_MI_trajectory_unanchored_all_data.png
results exported to: data/kalman_agg_MI_results_unanchored_all_data.csv

======================================================================
COMPARISON: anchored vs unanchored (michigan | ALL DATA)
======================================================================
sigma2_u (anchored):   0.414189
sigma2_u (unanchored): 0.000100
ratio (anchored/unanchored): 4141.894

final smoothed estimate (anchored):   0.793 pp
final smoothed estimate (unanchored): -1.431 pp
true margin:                          1.414 pp
unanchored forecast error:            -2.845 pp
anchored terminal adjustment:         0.622 pp

======================================================================
======================================================================
ANALYZING: michigan (MI) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (michigan | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 194
  polls after filter:  192
  polls dropped:       2
michigan polls loaded: 188 questions from 118 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.325 pp

sanity check — unique true_margin values: [1.41420144]

within-day aggregation complete:
  observations before: 188 (individual poll questions)
  observations after:  68 (one per unique end_date)
  unique days:         68 -> 68
  mean polls per day:  2.8
  mean combined n:     2280
  mean combined var:   7.9831 pp^2
  mean individual var (pre-agg): 13.0187 pp^2
  variance reduction factor: 1.6x

election result appended: margin = 1.414 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.473147 per day
  interpretation: true opinion can move ~0.688 pp/day (1 sd)

============================================================
polling bias decomposition — michigan (trump margin, anchored)
============================================================

true margin (certified result): 1.414 pp

--- overall poll error ---
  mean poll margin:          -1.173 pp
  mean total error:          -2.587 pp
  sd of total error:         2.655 pp

--- decomposition (means) ---
  mean systematic bias:      -2.660 pp
  mean |sampling noise|:     1.594 pp

--- variance decomposition ---
  var(total error):          7.0466
  var(systematic bias):      1.1588  (16.4%)
  var(sampling noise):       5.0128  (71.1%)

figure saved to: figures/kalman_agg_MI_bias_anchored_last_200_days.png
results exported to: data/kalman_agg_MI_results_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (michigan | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 194
  polls after filter:  192
  polls dropped:       2
michigan polls loaded: 188 questions from 118 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.325 pp

within-day aggregation complete:
  observations before: 188 (individual poll questions)
  observations after:  68 (one per unique end_date)
  unique days:         68 -> 68
  mean polls per day:  2.8
  mean combined n:     2280
  mean combined var:   7.9831 pp^2
  mean individual var (pre-agg): 13.0187 pp^2
  variance reduction factor: 1.6x

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.000100 per day
  interpretation: true opinion can move ~0.010 pp/day (1 sd)

============================================================
polling opinion trajectory — michigan (trump margin, unanchored)
============================================================

true margin (certified result): 1.414 pp

--- overall poll error ---
  mean poll margin:          -1.173 pp
  mean total error:          -2.587 pp
  sd of total error:         2.655 pp

--- decomposition (means) ---
  final forecast error:      -2.856 pp
  mean smoothed-poll gap:    2.000 pp
  mean |sampling noise|:     2.000 pp

figure saved to: figures/kalman_agg_MI_trajectory_unanchored_last_200_days.png
results exported to: data/kalman_agg_MI_results_unanchored_last_200_days.csv

======================================================================
COMPARISON: anchored vs unanchored (michigan | LAST 200 DAYS)
======================================================================
sigma2_u (anchored):   0.473147
sigma2_u (unanchored): 0.000100
ratio (anchored/unanchored): 4731.474

final smoothed estimate (anchored):   0.791 pp
final smoothed estimate (unanchored): -1.442 pp
true margin:                          1.414 pp
unanchored forecast error:            -2.856 pp
anchored terminal adjustment:         0.623 pp

======================================================================
======================================================================
ANALYZING: michigan (MI) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (michigan | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 194
  polls after filter:  188
  polls dropped:       6
michigan polls loaded: 184 questions from 114 polls
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 4.0 pp
mean poll margin: -1.408 pp

sanity check — unique true_margin values: [1.41420144]

within-day aggregation complete:
  observations before: 184 (individual poll questions)
  observations after:  64 (one per unique end_date)
  unique days:         64 -> 64
  mean polls per day:  2.9
  mean combined n:     2384
  mean combined var:   7.5430 pp^2
  mean individual var (pre-agg): 12.9751 pp^2
  variance reduction factor: 1.7x

election result appended: margin = 1.414 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.497340 per day
  interpretation: true opinion can move ~0.705 pp/day (1 sd)

============================================================
polling bias decomposition — michigan (trump margin, anchored)
============================================================

true margin (certified result): 1.414 pp

--- overall poll error ---
  mean poll margin:          -1.402 pp
  mean total error:          -2.816 pp
  sd of total error:         2.525 pp

--- decomposition (means) ---
  mean systematic bias:      -2.857 pp
  mean |sampling noise|:     1.608 pp

--- variance decomposition ---
  var(total error):          6.3777
  var(systematic bias):      0.7596  (11.9%)
  var(sampling noise):       5.0474  (79.1%)

figure saved to: figures/kalman_agg_MI_bias_anchored_last_107_days.png
results exported to: data/kalman_agg_MI_results_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (michigan | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 194
  polls after filter:  188
  polls dropped:       6
michigan polls loaded: 184 questions from 114 polls
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 4.0 pp
mean poll margin: -1.408 pp

within-day aggregation complete:
  observations before: 184 (individual poll questions)
  observations after:  64 (one per unique end_date)
  unique days:         64 -> 64
  mean polls per day:  2.9
  mean combined n:     2384
  mean combined var:   7.5430 pp^2
  mean individual var (pre-agg): 12.9751 pp^2
  variance reduction factor: 1.7x

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.000100 per day
  interpretation: true opinion can move ~0.010 pp/day (1 sd)

============================================================
polling opinion trajectory — michigan (trump margin, unanchored)
============================================================

true margin (certified result): 1.414 pp

--- overall poll error ---
  mean poll margin:          -1.402 pp
  mean total error:          -2.816 pp
  sd of total error:         2.525 pp

--- decomposition (means) ---
  final forecast error:      -2.923 pp
  mean smoothed-poll gap:    1.891 pp
  mean |sampling noise|:     1.891 pp

figure saved to: figures/kalman_agg_MI_trajectory_unanchored_last_107_days.png
results exported to: data/kalman_agg_MI_results_unanchored_last_107_days.csv

======================================================================
COMPARISON: anchored vs unanchored (michigan | LAST 107 DAYS)
======================================================================
sigma2_u (anchored):   0.497340
sigma2_u (unanchored): 0.000100
ratio (anchored/unanchored): 4973.403

final smoothed estimate (anchored):   0.791 pp
final smoothed estimate (unanchored): -1.509 pp
true margin:                          1.414 pp
unanchored forecast error:            -2.923 pp
anchored terminal adjustment:         0.623 pp

======================================================================
======================================================================
ANALYZING: nevada (NV) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (nevada | ALL DATA)
======================================================================
nevada polls loaded: 120 questions from 73 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.378 pp

sanity check — unique true_margin values: [3.14001699]

within-day aggregation complete:
  observations before: 120 (individual poll questions)
  observations after:  50 (one per unique end_date)
  unique days:         50 -> 50
  mean polls per day:  2.4
  mean combined n:     1744
  mean combined var:   9.8387 pp^2
  mean individual var (pre-agg): 14.3608 pp^2
  variance reduction factor: 1.5x

election result appended: margin = 3.140 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.522279 per day
  interpretation: true opinion can move ~0.723 pp/day (1 sd)

============================================================
polling bias decomposition — nevada (trump margin, anchored)
============================================================

true margin (certified result): 3.140 pp

--- overall poll error ---
  mean poll margin:          0.365 pp
  mean total error:          -2.775 pp
  sd of total error:         3.149 pp

--- decomposition (means) ---
  mean systematic bias:      -2.902 pp
  mean |sampling noise|:     1.539 pp

--- variance decomposition ---
  var(total error):          9.9141
  var(systematic bias):      4.5270  (45.7%)
  var(sampling noise):       4.4858  (45.2%)

figure saved to: figures/kalman_agg_NV_bias_anchored_all_data.png
results exported to: data/kalman_agg_NV_results_anchored_all_data.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (nevada | ALL DATA)
======================================================================
nevada polls loaded: 120 questions from 73 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.378 pp

within-day aggregation complete:
  observations before: 120 (individual poll questions)
  observations after:  50 (one per unique end_date)
  unique days:         50 -> 50
  mean polls per day:  2.4
  mean combined n:     1744
  mean combined var:   9.8387 pp^2
  mean individual var (pre-agg): 14.3608 pp^2
  variance reduction factor: 1.5x

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.154685 per day
  interpretation: true opinion can move ~0.393 pp/day (1 sd)

============================================================
polling opinion trajectory — nevada (trump margin, unanchored)
============================================================

true margin (certified result): 3.140 pp

--- overall poll error ---
  mean poll margin:          0.365 pp
  mean total error:          -2.775 pp
  sd of total error:         3.149 pp

--- decomposition (means) ---
  final forecast error:      -3.318 pp
  mean smoothed-poll gap:    1.696 pp
  mean |sampling noise|:     1.696 pp

figure saved to: figures/kalman_agg_NV_trajectory_unanchored_all_data.png
results exported to: data/kalman_agg_NV_results_unanchored_all_data.csv

======================================================================
COMPARISON: anchored vs unanchored (nevada | ALL DATA)
======================================================================
sigma2_u (anchored):   0.522279
sigma2_u (unanchored): 0.154685
ratio (anchored/unanchored): 3.376

final smoothed estimate (anchored):   2.297 pp
final smoothed estimate (unanchored): -0.178 pp
true margin:                          3.140 pp
unanchored forecast error:            -3.318 pp
anchored terminal adjustment:         0.843 pp

======================================================================
======================================================================
ANALYZING: nevada (NV) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (nevada | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 121
  polls after filter:  118
  polls dropped:       3
nevada polls loaded: 117 questions from 71 polls
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.582 pp

sanity check — unique true_margin values: [3.14001699]

within-day aggregation complete:
  observations before: 117 (individual poll questions)
  observations after:  48 (one per unique end_date)
  unique days:         48 -> 48
  mean polls per day:  2.4
  mean combined n:     1770
  mean combined var:   9.9157 pp^2
  mean individual var (pre-agg): 14.4026 pp^2
  variance reduction factor: 1.5x

election result appended: margin = 3.140 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.638046 per day
  interpretation: true opinion can move ~0.799 pp/day (1 sd)

============================================================
polling bias decomposition — nevada (trump margin, anchored)
============================================================

true margin (certified result): 3.140 pp

--- overall poll error ---
  mean poll margin:          0.053 pp
  mean total error:          -3.087 pp
  sd of total error:         2.797 pp

--- decomposition (means) ---
  mean systematic bias:      -3.222 pp
  mean |sampling noise|:     1.528 pp

--- variance decomposition ---
  var(total error):          7.8244
  var(systematic bias):      2.2799  (29.1%)
  var(sampling noise):       4.3931  (56.1%)

figure saved to: figures/kalman_agg_NV_bias_anchored_last_200_days.png
results exported to: data/kalman_agg_NV_results_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (nevada | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 121
  polls after filter:  118
  polls dropped:       3
nevada polls loaded: 117 questions from 71 polls
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.582 pp

within-day aggregation complete:
  observations before: 117 (individual poll questions)
  observations after:  48 (one per unique end_date)
  unique days:         48 -> 48
  mean polls per day:  2.4
  mean combined n:     1770
  mean combined var:   9.9157 pp^2
  mean individual var (pre-agg): 14.4026 pp^2
  variance reduction factor: 1.5x

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.156400 per day
  interpretation: true opinion can move ~0.395 pp/day (1 sd)

============================================================
polling opinion trajectory — nevada (trump margin, unanchored)
============================================================

true margin (certified result): 3.140 pp

--- overall poll error ---
  mean poll margin:          0.053 pp
  mean total error:          -3.087 pp
  sd of total error:         2.797 pp

--- decomposition (means) ---
  final forecast error:      -3.316 pp
  mean smoothed-poll gap:    1.714 pp
  mean |sampling noise|:     1.714 pp

figure saved to: figures/kalman_agg_NV_trajectory_unanchored_last_200_days.png
results exported to: data/kalman_agg_NV_results_unanchored_last_200_days.csv

======================================================================
COMPARISON: anchored vs unanchored (nevada | LAST 200 DAYS)
======================================================================
sigma2_u (anchored):   0.638046
sigma2_u (unanchored): 0.156400
ratio (anchored/unanchored): 4.080

final smoothed estimate (anchored):   2.266 pp
final smoothed estimate (unanchored): -0.176 pp
true margin:                          3.140 pp
unanchored forecast error:            -3.316 pp
anchored terminal adjustment:         0.874 pp

======================================================================
======================================================================
ANALYZING: nevada (NV) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (nevada | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 121
  polls after filter:  116
  polls dropped:       5
nevada polls loaded: 115 questions from 69 polls
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 6.0 pp
mean poll margin: -0.705 pp

sanity check — unique true_margin values: [3.14001699]

within-day aggregation complete:
  observations before: 115 (individual poll questions)
  observations after:  46 (one per unique end_date)
  unique days:         46 -> 46
  mean polls per day:  2.5
  mean combined n:     1820
  mean combined var:   9.6744 pp^2
  mean individual var (pre-agg): 14.3841 pp^2
  variance reduction factor: 1.5x

election result appended: margin = 3.140 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.573702 per day
  interpretation: true opinion can move ~0.757 pp/day (1 sd)

============================================================
polling bias decomposition — nevada (trump margin, anchored)
============================================================

true margin (certified result): 3.140 pp

--- overall poll error ---
  mean poll margin:          -0.227 pp
  mean total error:          -3.367 pp
  sd of total error:         2.387 pp

--- decomposition (means) ---
  mean systematic bias:      -3.543 pp
  mean |sampling noise|:     1.465 pp

--- variance decomposition ---
  var(total error):          5.7000
  var(systematic bias):      1.0047  (17.6%)
  var(sampling noise):       4.0364  (70.8%)

figure saved to: figures/kalman_agg_NV_bias_anchored_last_107_days.png
results exported to: data/kalman_agg_NV_results_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (nevada | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 121
  polls after filter:  116
  polls dropped:       5
nevada polls loaded: 115 questions from 69 polls
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 6.0 pp
mean poll margin: -0.705 pp

within-day aggregation complete:
  observations before: 115 (individual poll questions)
  observations after:  46 (one per unique end_date)
  unique days:         46 -> 46
  mean polls per day:  2.5
  mean combined n:     1820
  mean combined var:   9.6744 pp^2
  mean individual var (pre-agg): 14.3841 pp^2
  variance reduction factor: 1.5x

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.016451 per day
  interpretation: true opinion can move ~0.128 pp/day (1 sd)

============================================================
polling opinion trajectory — nevada (trump margin, unanchored)
============================================================

true margin (certified result): 3.140 pp

--- overall poll error ---
  mean poll margin:          -0.227 pp
  mean total error:          -3.367 pp
  sd of total error:         2.387 pp

--- decomposition (means) ---
  final forecast error:      -3.648 pp
  mean smoothed-poll gap:    1.808 pp
  mean |sampling noise|:     1.808 pp

figure saved to: figures/kalman_agg_NV_trajectory_unanchored_last_107_days.png
results exported to: data/kalman_agg_NV_results_unanchored_last_107_days.csv

======================================================================
COMPARISON: anchored vs unanchored (nevada | LAST 107 DAYS)
======================================================================
sigma2_u (anchored):   0.573702
sigma2_u (unanchored): 0.016451
ratio (anchored/unanchored): 34.873

final smoothed estimate (anchored):   2.282 pp
final smoothed estimate (unanchored): -0.508 pp
true margin:                          3.140 pp
unanchored forecast error:            -3.648 pp
anchored terminal adjustment:         0.858 pp

======================================================================
======================================================================
ANALYZING: north carolina (NC) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (north carolina | ALL DATA)
======================================================================
north carolina polls loaded: 160 questions from 100 polls
date range: 2024-02-16 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.630 pp

sanity check — unique true_margin values: [3.21185245]

within-day aggregation complete:
  observations before: 160 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.5
  mean combined n:     2301
  mean combined var:   8.1228 pp^2
  mean individual var (pre-agg): 11.8436 pp^2
  variance reduction factor: 1.5x

election result appended: margin = 3.212 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.277016 per day
  interpretation: true opinion can move ~0.526 pp/day (1 sd)

============================================================
polling bias decomposition — north carolina (trump margin, anchored)
============================================================

true margin (certified result): 3.212 pp

--- overall poll error ---
  mean poll margin:          1.156 pp
  mean total error:          -2.055 pp
  sd of total error:         2.283 pp

--- decomposition (means) ---
  mean systematic bias:      -2.289 pp
  mean |sampling noise|:     1.238 pp

--- variance decomposition ---
  var(total error):          5.2101
  var(systematic bias):      2.0930  (40.2%)
  var(sampling noise):       2.3381  (44.9%)

figure saved to: figures/kalman_agg_NC_bias_anchored_all_data.png
results exported to: data/kalman_agg_NC_results_anchored_all_data.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (north carolina | ALL DATA)
======================================================================
north carolina polls loaded: 160 questions from 100 polls
date range: 2024-02-16 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.630 pp

within-day aggregation complete:
  observations before: 160 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.5
  mean combined n:     2301
  mean combined var:   8.1228 pp^2
  mean individual var (pre-agg): 11.8436 pp^2
  variance reduction factor: 1.5x

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.081355 per day
  interpretation: true opinion can move ~0.285 pp/day (1 sd)

============================================================
polling opinion trajectory — north carolina (trump margin, unanchored)
============================================================

true margin (certified result): 3.212 pp

--- overall poll error ---
  mean poll margin:          1.156 pp
  mean total error:          -2.055 pp
  sd of total error:         2.283 pp

--- decomposition (means) ---
  final forecast error:      -2.734 pp
  mean smoothed-poll gap:    1.404 pp
  mean |sampling noise|:     1.404 pp

figure saved to: figures/kalman_agg_NC_trajectory_unanchored_all_data.png
results exported to: data/kalman_agg_NC_results_unanchored_all_data.csv

======================================================================
COMPARISON: anchored vs unanchored (north carolina | ALL DATA)
======================================================================
sigma2_u (anchored):   0.277016
sigma2_u (unanchored): 0.081355
ratio (anchored/unanchored): 3.405

final smoothed estimate (anchored):   2.510 pp
final smoothed estimate (unanchored): 0.478 pp
true margin:                          3.212 pp
unanchored forecast error:            -2.734 pp
anchored terminal adjustment:         0.702 pp

======================================================================
======================================================================
ANALYZING: north carolina (NC) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (north carolina | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 161
  polls after filter:  160
  polls dropped:       1
north carolina polls loaded: 159 questions from 99 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.576 pp

sanity check — unique true_margin values: [3.21185245]

within-day aggregation complete:
  observations before: 159 (individual poll questions)
  observations after:  62 (one per unique end_date)
  unique days:         62 -> 62
  mean polls per day:  2.6
  mean combined n:     2322
  mean combined var:   8.1090 pp^2
  mean individual var (pre-agg): 11.8616 pp^2
  variance reduction factor: 1.5x

election result appended: margin = 3.212 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.293293 per day
  interpretation: true opinion can move ~0.542 pp/day (1 sd)

============================================================
polling bias decomposition — north carolina (trump margin, anchored)
============================================================

true margin (certified result): 3.212 pp

--- overall poll error ---
  mean poll margin:          1.027 pp
  mean total error:          -2.185 pp
  sd of total error:         2.054 pp

--- decomposition (means) ---
  mean systematic bias:      -2.427 pp
  mean |sampling noise|:     1.250 pp

--- variance decomposition ---
  var(total error):          4.2178
  var(systematic bias):      1.0419  (24.7%)
  var(sampling noise):       2.3881  (56.6%)

figure saved to: figures/kalman_agg_NC_bias_anchored_last_200_days.png
results exported to: data/kalman_agg_NC_results_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (north carolina | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 161
  polls after filter:  160
  polls dropped:       1
north carolina polls loaded: 159 questions from 99 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.576 pp

within-day aggregation complete:
  observations before: 159 (individual poll questions)
  observations after:  62 (one per unique end_date)
  unique days:         62 -> 62
  mean polls per day:  2.6
  mean combined n:     2322
  mean combined var:   8.1090 pp^2
  mean individual var (pre-agg): 11.8616 pp^2
  variance reduction factor: 1.5x

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.000100 per day
  interpretation: true opinion can move ~0.010 pp/day (1 sd)

============================================================
polling opinion trajectory — north carolina (trump margin, unanchored)
============================================================

true margin (certified result): 3.212 pp

--- overall poll error ---
  mean poll margin:          1.027 pp
  mean total error:          -2.185 pp
  sd of total error:         2.054 pp

--- decomposition (means) ---
  final forecast error:      -2.691 pp
  mean smoothed-poll gap:    1.581 pp
  mean |sampling noise|:     1.581 pp

figure saved to: figures/kalman_agg_NC_trajectory_unanchored_last_200_days.png
results exported to: data/kalman_agg_NC_results_unanchored_last_200_days.csv

======================================================================
COMPARISON: anchored vs unanchored (north carolina | LAST 200 DAYS)
======================================================================
sigma2_u (anchored):   0.293293
sigma2_u (unanchored): 0.000100
ratio (anchored/unanchored): 2932.926

final smoothed estimate (anchored):   2.498 pp
final smoothed estimate (unanchored): 0.521 pp
true margin:                          3.212 pp
unanchored forecast error:            -2.691 pp
anchored terminal adjustment:         0.714 pp

======================================================================
======================================================================
ANALYZING: north carolina (NC) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (north carolina | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 161
  polls after filter:  158
  polls dropped:       3
north carolina polls loaded: 157 questions from 97 polls
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 5.8 pp
mean poll margin: 0.495 pp

sanity check — unique true_margin values: [3.21185245]

within-day aggregation complete:
  observations before: 157 (individual poll questions)
  observations after:  60 (one per unique end_date)
  unique days:         60 -> 60
  mean polls per day:  2.6
  mean combined n:     2378
  mean combined var:   7.9015 pp^2
  mean individual var (pre-agg): 11.8301 pp^2
  variance reduction factor: 1.5x

election result appended: margin = 3.212 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.250014 per day
  interpretation: true opinion can move ~0.500 pp/day (1 sd)

============================================================
polling bias decomposition — north carolina (trump margin, anchored)
============================================================

true margin (certified result): 3.212 pp

--- overall poll error ---
  mean poll margin:          0.828 pp
  mean total error:          -2.384 pp
  sd of total error:         1.675 pp

--- decomposition (means) ---
  mean systematic bias:      -2.605 pp
  mean |sampling noise|:     1.257 pp

--- variance decomposition ---
  var(total error):          2.8059
  var(systematic bias):      0.2567  (9.2%)
  var(sampling noise):       2.4020  (85.6%)

figure saved to: figures/kalman_agg_NC_bias_anchored_last_107_days.png
results exported to: data/kalman_agg_NC_results_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (north carolina | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 161
  polls after filter:  158
  polls dropped:       3
north carolina polls loaded: 157 questions from 97 polls
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 5.8 pp
mean poll margin: 0.495 pp

within-day aggregation complete:
  observations before: 157 (individual poll questions)
  observations after:  60 (one per unique end_date)
  unique days:         60 -> 60
  mean polls per day:  2.6
  mean combined n:     2378
  mean combined var:   7.9015 pp^2
  mean individual var (pre-agg): 11.8301 pp^2
  variance reduction factor: 1.5x

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.000100 per day
  interpretation: true opinion can move ~0.010 pp/day (1 sd)

============================================================
polling opinion trajectory — north carolina (trump margin, unanchored)
============================================================

true margin (certified result): 3.212 pp

--- overall poll error ---
  mean poll margin:          0.828 pp
  mean total error:          -2.384 pp
  sd of total error:         1.675 pp

--- decomposition (means) ---
  final forecast error:      -2.754 pp
  mean smoothed-poll gap:    1.432 pp
  mean |sampling noise|:     1.432 pp

figure saved to: figures/kalman_agg_NC_trajectory_unanchored_last_107_days.png
results exported to: data/kalman_agg_NC_results_unanchored_last_107_days.csv

======================================================================
COMPARISON: anchored vs unanchored (north carolina | LAST 107 DAYS)
======================================================================
sigma2_u (anchored):   0.250014
sigma2_u (unanchored): 0.000100
ratio (anchored/unanchored): 2500.144

final smoothed estimate (anchored):   2.532 pp
final smoothed estimate (unanchored): 0.458 pp
true margin:                          3.212 pp
unanchored forecast error:            -2.754 pp
anchored terminal adjustment:         0.680 pp

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (pennsylvania | ALL DATA)
======================================================================
pennsylvania polls loaded: 238 questions from 148 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 9.7 pp
mean poll margin: -0.501 pp

sanity check — unique true_margin values: [1.70973099]

within-day aggregation complete:
  observations before: 238 (individual poll questions)
  observations after:  74 (one per unique end_date)
  unique days:         74 -> 74
  mean polls per day:  3.2
  mean combined n:     3206
  mean combined var:   6.1855 pp^2
  mean individual var (pre-agg): 11.5873 pp^2
  variance reduction factor: 1.9x

election result appended: margin = 1.710 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.155006 per day
  interpretation: true opinion can move ~0.394 pp/day (1 sd)

============================================================
polling bias decomposition — pennsylvania (trump margin, anchored)
============================================================

true margin (certified result): 1.710 pp

--- overall poll error ---
  mean poll margin:          0.093 pp
  mean total error:          -1.617 pp
  sd of total error:         2.350 pp

--- decomposition (means) ---
  mean systematic bias:      -1.896 pp
  mean |sampling noise|:     1.229 pp

--- variance decomposition ---
  var(total error):          5.5205
  var(systematic bias):      2.3473  (42.5%)
  var(sampling noise):       2.3423  (42.4%)

figure saved to: figures/kalman_agg_PA_bias_anchored_all_data.png
results exported to: data/kalman_agg_PA_results_anchored_all_data.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (pennsylvania | ALL DATA)
======================================================================
pennsylvania polls loaded: 238 questions from 148 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 9.7 pp
mean poll margin: -0.501 pp

within-day aggregation complete:
  observations before: 238 (individual poll questions)
  observations after:  74 (one per unique end_date)
  unique days:         74 -> 74
  mean polls per day:  3.2
  mean combined n:     3206
  mean combined var:   6.1855 pp^2
  mean individual var (pre-agg): 11.5873 pp^2
  variance reduction factor: 1.9x

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.073672 per day
  interpretation: true opinion can move ~0.271 pp/day (1 sd)

============================================================
polling opinion trajectory — pennsylvania (trump margin, unanchored)
============================================================

true margin (certified result): 1.710 pp

--- overall poll error ---
  mean poll margin:          0.093 pp
  mean total error:          -1.617 pp
  sd of total error:         2.350 pp

--- decomposition (means) ---
  final forecast error:      -1.886 pp
  mean smoothed-poll gap:    1.301 pp
  mean |sampling noise|:     1.301 pp

figure saved to: figures/kalman_agg_PA_trajectory_unanchored_all_data.png
results exported to: data/kalman_agg_PA_results_unanchored_all_data.csv

======================================================================
COMPARISON: anchored vs unanchored (pennsylvania | ALL DATA)
======================================================================
sigma2_u (anchored):   0.155006
sigma2_u (unanchored): 0.073672
ratio (anchored/unanchored): 2.104

final smoothed estimate (anchored):   1.243 pp
final smoothed estimate (unanchored): -0.177 pp
true margin:                          1.710 pp
unanchored forecast error:            -1.886 pp
anchored terminal adjustment:         0.467 pp

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (pennsylvania | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 241
  polls after filter:  238
  polls dropped:       3
pennsylvania polls loaded: 235 questions from 146 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: -0.578 pp

sanity check — unique true_margin values: [1.70973099]

within-day aggregation complete:
  observations before: 235 (individual poll questions)
  observations after:  72 (one per unique end_date)
  unique days:         72 -> 72
  mean polls per day:  3.3
  mean combined n:     3264
  mean combined var:   6.1297 pp^2
  mean individual var (pre-agg): 11.5682 pp^2
  variance reduction factor: 1.9x

election result appended: margin = 1.710 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.155362 per day
  interpretation: true opinion can move ~0.394 pp/day (1 sd)

============================================================
polling bias decomposition — pennsylvania (trump margin, anchored)
============================================================

true margin (certified result): 1.710 pp

--- overall poll error ---
  mean poll margin:          -0.088 pp
  mean total error:          -1.797 pp
  sd of total error:         2.044 pp

--- decomposition (means) ---
  mean systematic bias:      -2.081 pp
  mean |sampling noise|:     1.224 pp

--- variance decomposition ---
  var(total error):          4.1797
  var(systematic bias):      1.1714  (28.0%)
  var(sampling noise):       2.3587  (56.4%)

figure saved to: figures/kalman_agg_PA_bias_anchored_last_200_days.png
results exported to: data/kalman_agg_PA_results_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (pennsylvania | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 241
  polls after filter:  238
  polls dropped:       3
pennsylvania polls loaded: 235 questions from 146 polls
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: -0.578 pp

within-day aggregation complete:
  observations before: 235 (individual poll questions)
  observations after:  72 (one per unique end_date)
  unique days:         72 -> 72
  mean polls per day:  3.3
  mean combined n:     3264
  mean combined var:   6.1297 pp^2
  mean individual var (pre-agg): 11.5682 pp^2
  variance reduction factor: 1.9x

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.057608 per day
  interpretation: true opinion can move ~0.240 pp/day (1 sd)

============================================================
polling opinion trajectory — pennsylvania (trump margin, unanchored)
============================================================

true margin (certified result): 1.710 pp

--- overall poll error ---
  mean poll margin:          -0.088 pp
  mean total error:          -1.797 pp
  sd of total error:         2.044 pp

--- decomposition (means) ---
  final forecast error:      -1.913 pp
  mean smoothed-poll gap:    1.299 pp
  mean |sampling noise|:     1.299 pp

figure saved to: figures/kalman_agg_PA_trajectory_unanchored_last_200_days.png
results exported to: data/kalman_agg_PA_results_unanchored_last_200_days.csv

======================================================================
COMPARISON: anchored vs unanchored (pennsylvania | LAST 200 DAYS)
======================================================================
sigma2_u (anchored):   0.155362
sigma2_u (unanchored): 0.057608
ratio (anchored/unanchored): 2.697

final smoothed estimate (anchored):   1.243 pp
final smoothed estimate (unanchored): -0.203 pp
true margin:                          1.710 pp
unanchored forecast error:            -1.913 pp
anchored terminal adjustment:         0.467 pp

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (pennsylvania | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 241
  polls after filter:  229
  polls dropped:       12
pennsylvania polls loaded: 226 questions from 140 polls
date range: 2024-07-21 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 6.0 pp
mean poll margin: -0.734 pp

sanity check — unique true_margin values: [1.70973099]

within-day aggregation complete:
  observations before: 226 (individual poll questions)
  observations after:  67 (one per unique end_date)
  unique days:         67 -> 67
  mean polls per day:  3.4
  mean combined n:     3406
  mean combined var:   5.8048 pp^2
  mean individual var (pre-agg): 11.5346 pp^2
  variance reduction factor: 2.0x

election result appended: margin = 1.710 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.132672 per day
  interpretation: true opinion can move ~0.364 pp/day (1 sd)

============================================================
polling bias decomposition — pennsylvania (trump margin, anchored)
============================================================

true margin (certified result): 1.710 pp

--- overall poll error ---
  mean poll margin:          -0.416 pp
  mean total error:          -2.126 pp
  sd of total error:         1.600 pp

--- decomposition (means) ---
  mean systematic bias:      -2.349 pp
  mean |sampling noise|:     1.175 pp

--- variance decomposition ---
  var(total error):          2.5613
  var(systematic bias):      0.4392  (17.1%)
  var(sampling noise):       2.1597  (84.3%)

figure saved to: figures/kalman_agg_PA_bias_anchored_last_107_days.png
results exported to: data/kalman_agg_PA_results_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (pennsylvania | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 241
  polls after filter:  229
  polls dropped:       12
pennsylvania polls loaded: 226 questions from 140 polls
date range: 2024-07-21 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 6.0 pp
mean poll margin: -0.734 pp

within-day aggregation complete:
  observations before: 226 (individual poll questions)
  observations after:  67 (one per unique end_date)
  unique days:         67 -> 67
  mean polls per day:  3.4
  mean combined n:     3406
  mean combined var:   5.8048 pp^2
  mean individual var (pre-agg): 11.5346 pp^2
  variance reduction factor: 2.0x

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.015757 per day
  interpretation: true opinion can move ~0.126 pp/day (1 sd)

============================================================
polling opinion trajectory — pennsylvania (trump margin, unanchored)
============================================================

true margin (certified result): 1.710 pp

--- overall poll error ---
  mean poll margin:          -0.416 pp
  mean total error:          -2.126 pp
  sd of total error:         1.600 pp

--- decomposition (means) ---
  final forecast error:      -2.059 pp
  mean smoothed-poll gap:    1.248 pp
  mean |sampling noise|:     1.248 pp

figure saved to: figures/kalman_agg_PA_trajectory_unanchored_last_107_days.png
results exported to: data/kalman_agg_PA_results_unanchored_last_107_days.csv

======================================================================
COMPARISON: anchored vs unanchored (pennsylvania | LAST 107 DAYS)
======================================================================
sigma2_u (anchored):   0.132672
sigma2_u (unanchored): 0.015757
ratio (anchored/unanchored): 8.420

final smoothed estimate (anchored):   1.264 pp
final smoothed estimate (unanchored): -0.349 pp
true margin:                          1.710 pp
unanchored forecast error:            -2.059 pp
anchored terminal adjustment:         0.446 pp

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (wisconsin | ALL DATA)
======================================================================
wisconsin polls loaded: 188 questions from 110 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.816 pp

sanity check — unique true_margin values: [0.85882864]

within-day aggregation complete:
  observations before: 188 (individual poll questions)
  observations after:  69 (one per unique end_date)
  unique days:         69 -> 69
  mean polls per day:  2.7
  mean combined n:     2167
  mean combined var:   7.6672 pp^2
  mean individual var (pre-agg): 13.2235 pp^2
  variance reduction factor: 1.7x

election result appended: margin = 0.859 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.221332 per day
  interpretation: true opinion can move ~0.470 pp/day (1 sd)

============================================================
polling bias decomposition — wisconsin (trump margin, anchored)
============================================================

true margin (certified result): 0.859 pp

--- overall poll error ---
  mean poll margin:          -1.400 pp
  mean total error:          -2.259 pp
  sd of total error:         2.557 pp

--- decomposition (means) ---
  mean systematic bias:      -2.402 pp
  mean |sampling noise|:     1.389 pp

--- variance decomposition ---
  var(total error):          6.5375
  var(systematic bias):      2.3420  (35.8%)
  var(sampling noise):       3.2536  (49.8%)

figure saved to: figures/kalman_agg_WI_bias_anchored_all_data.png
results exported to: data/kalman_agg_WI_results_anchored_all_data.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (wisconsin | ALL DATA)
======================================================================
wisconsin polls loaded: 188 questions from 110 polls
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.816 pp

within-day aggregation complete:
  observations before: 188 (individual poll questions)
  observations after:  69 (one per unique end_date)
  unique days:         69 -> 69
  mean polls per day:  2.7
  mean combined n:     2167
  mean combined var:   7.6672 pp^2
  mean individual var (pre-agg): 13.2235 pp^2
  variance reduction factor: 1.7x

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.103969 per day
  interpretation: true opinion can move ~0.322 pp/day (1 sd)

============================================================
polling opinion trajectory — wisconsin (trump margin, unanchored)
============================================================

true margin (certified result): 0.859 pp

--- overall poll error ---
  mean poll margin:          -1.400 pp
  mean total error:          -2.259 pp
  sd of total error:         2.557 pp

--- decomposition (means) ---
  final forecast error:      -2.233 pp
  mean smoothed-poll gap:    1.494 pp
  mean |sampling noise|:     1.494 pp

figure saved to: figures/kalman_agg_WI_trajectory_unanchored_all_data.png
results exported to: data/kalman_agg_WI_results_unanchored_all_data.csv

======================================================================
COMPARISON: anchored vs unanchored (wisconsin | ALL DATA)
======================================================================
sigma2_u (anchored):   0.221332
sigma2_u (unanchored): 0.103969
ratio (anchored/unanchored): 2.129

final smoothed estimate (anchored):   0.330 pp
final smoothed estimate (unanchored): -1.374 pp
true margin:                          0.859 pp
unanchored forecast error:            -2.233 pp
anchored terminal adjustment:         0.529 pp

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (wisconsin | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 191
  polls after filter:  188
  polls dropped:       3
wisconsin polls loaded: 185 questions from 108 polls
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.880 pp

sanity check — unique true_margin values: [0.85882864]

within-day aggregation complete:
  observations before: 185 (individual poll questions)
  observations after:  67 (one per unique end_date)
  unique days:         67 -> 67
  mean polls per day:  2.8
  mean combined n:     2199
  mean combined var:   7.6454 pp^2
  mean individual var (pre-agg): 13.2214 pp^2
  variance reduction factor: 1.7x

election result appended: margin = 0.859 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.266011 per day
  interpretation: true opinion can move ~0.516 pp/day (1 sd)

============================================================
polling bias decomposition — wisconsin (trump margin, anchored)
============================================================

true margin (certified result): 0.859 pp

--- overall poll error ---
  mean poll margin:          -1.515 pp
  mean total error:          -2.374 pp
  sd of total error:         2.499 pp

--- decomposition (means) ---
  mean systematic bias:      -2.517 pp
  mean |sampling noise|:     1.391 pp

--- variance decomposition ---
  var(total error):          6.2459
  var(systematic bias):      2.0503  (32.8%)
  var(sampling noise):       3.2083  (51.4%)

figure saved to: figures/kalman_agg_WI_bias_anchored_last_200_days.png
results exported to: data/kalman_agg_WI_results_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (wisconsin | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 191
  polls after filter:  188
  polls dropped:       3
wisconsin polls loaded: 185 questions from 108 polls
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.880 pp

within-day aggregation complete:
  observations before: 185 (individual poll questions)
  observations after:  67 (one per unique end_date)
  unique days:         67 -> 67
  mean polls per day:  2.8
  mean combined n:     2199
  mean combined var:   7.6454 pp^2
  mean individual var (pre-agg): 13.2214 pp^2
  variance reduction factor: 1.7x

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.135122 per day
  interpretation: true opinion can move ~0.368 pp/day (1 sd)

============================================================
polling opinion trajectory — wisconsin (trump margin, unanchored)
============================================================

true margin (certified result): 0.859 pp

--- overall poll error ---
  mean poll margin:          -1.515 pp
  mean total error:          -2.374 pp
  sd of total error:         2.499 pp

--- decomposition (means) ---
  final forecast error:      -2.214 pp
  mean smoothed-poll gap:    1.484 pp
  mean |sampling noise|:     1.484 pp

figure saved to: figures/kalman_agg_WI_trajectory_unanchored_last_200_days.png
results exported to: data/kalman_agg_WI_results_unanchored_last_200_days.csv

======================================================================
COMPARISON: anchored vs unanchored (wisconsin | LAST 200 DAYS)
======================================================================
sigma2_u (anchored):   0.266011
sigma2_u (unanchored): 0.135122
ratio (anchored/unanchored): 1.969

final smoothed estimate (anchored):   0.305 pp
final smoothed estimate (unanchored): -1.356 pp
true margin:                          0.859 pp
unanchored forecast error:            -2.214 pp
anchored terminal adjustment:         0.554 pp

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE: bias decomposition conditional on known outcome (wisconsin | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 191
  polls after filter:  184
  polls dropped:       7
wisconsin polls loaded: 181 questions from 104 polls
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 2.0 pp
mean poll margin: -1.977 pp

sanity check — unique true_margin values: [0.85882864]

within-day aggregation complete:
  observations before: 181 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.9
  mean combined n:     2301
  mean combined var:   7.0974 pp^2
  mean individual var (pre-agg): 13.1539 pp^2
  variance reduction factor: 1.9x

election result appended: margin = 0.859 pp on 2024-11-05

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.233457 per day
  interpretation: true opinion can move ~0.483 pp/day (1 sd)

============================================================
polling bias decomposition — wisconsin (trump margin, anchored)
============================================================

true margin (certified result): 0.859 pp

--- overall poll error ---
  mean poll margin:          -1.770 pp
  mean total error:          -2.629 pp
  sd of total error:         2.209 pp

--- decomposition (means) ---
  mean systematic bias:      -2.740 pp
  mean |sampling noise|:     1.426 pp

--- variance decomposition ---
  var(total error):          4.8816
  var(systematic bias):      1.2257  (25.1%)
  var(sampling noise):       3.2916  (67.4%)

figure saved to: figures/kalman_agg_WI_bias_anchored_last_107_days.png
results exported to: data/kalman_agg_WI_results_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE: real-time opinion trajectory from polls alone (wisconsin | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 191
  polls after filter:  184
  polls dropped:       7
wisconsin polls loaded: 181 questions from 104 polls
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 2.0 pp
mean poll margin: -1.977 pp

within-day aggregation complete:
  observations before: 181 (individual poll questions)
  observations after:  63 (one per unique end_date)
  unique days:         63 -> 63
  mean polls per day:  2.9
  mean combined n:     2301
  mean combined var:   7.0974 pp^2
  mean individual var (pre-agg): 13.1539 pp^2
  variance reduction factor: 1.9x

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

estimating sigma2_u via grid search mle...
  sigma2_u estimated (two-stage grid mle): 0.070977 per day
  interpretation: true opinion can move ~0.266 pp/day (1 sd)

============================================================
polling opinion trajectory — wisconsin (trump margin, unanchored)
============================================================

true margin (certified result): 0.859 pp

--- overall poll error ---
  mean poll margin:          -1.770 pp
  mean total error:          -2.629 pp
  sd of total error:         2.209 pp

--- decomposition (means) ---
  final forecast error:      -2.248 pp
  mean smoothed-poll gap:    1.546 pp
  mean |sampling noise|:     1.546 pp

figure saved to: figures/kalman_agg_WI_trajectory_unanchored_last_107_days.png
results exported to: data/kalman_agg_WI_results_unanchored_last_107_days.csv

======================================================================
COMPARISON: anchored vs unanchored (wisconsin | LAST 107 DAYS)
======================================================================
sigma2_u (anchored):   0.233457
sigma2_u (unanchored): 0.070977
ratio (anchored/unanchored): 3.289

final smoothed estimate (anchored):   0.322 pp
final smoothed estimate (unanchored): -1.389 pp
true margin:                          0.859 pp
unanchored forecast error:            -2.248 pp
anchored terminal adjustment:         0.536 pp

======================================================================
analysis completed: 2026-02-23 16:45:29
log saved to: output/kalman/kalman_daily_aggregated_swingstates_log_20260223_164450.txt
