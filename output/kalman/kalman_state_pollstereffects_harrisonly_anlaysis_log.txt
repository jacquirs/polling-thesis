kalman filter with house effects analysis — swing states
started: 2026-02-25 13:36:47
log file: output/kalman/kalman_state_pollstereffects_harrisonly_anlaysis_log.txt
states: ['arizona', 'georgia', 'michigan', 'nevada', 'north carolina', 'pennsylvania', 'wisconsin']
time windows: [None, 200, 107]

======================================================================
======================================================================
ANALYZING: arizona (AZ) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (arizona | ALL DATA)
======================================================================
arizona polls loaded: 163 questions from 103 polls, 44 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.453 pp

sanity check — unique true_margin values: [5.52860324]

election result appended: margin = 5.529 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.467531

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.104151    0.467531      1.4215
    2        0.529289    0.330528      1.4978
    3        0.331426    0.320754      1.5268
    4        0.119571    0.309065      1.5341
    5        0.060752    0.304866      1.5390
    6        0.028727    0.302433      1.5415
    7        0.014650    0.301181      1.5429
    8        0.007532    0.300555      1.5436
    9        0.003862    0.300208      1.5439
   10        0.002030    0.299999      1.5441
   11        0.001108    0.299929      1.5443
   12        0.000531    0.299860      1.5443
   13        0.000317    0.299790      1.5443
   14        0.000230    0.299790      1.5444
   15        0.000083    0.299790      1.5444

em converged at iteration 15 (max change 8.27e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — arizona (trump margin, anchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.299790 per day
interpretation: true opinion can move ~0.548 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.453 pp
  mean total error:              -4.076 pp
  sd of total error:             2.854 pp

--- three-component decomposition ---
  mean |house effect|:           1.348 pp
  mean |sampling noise|:         1.239 pp
  mean residual systematic bias: -3.948 pp

--- variance decomposition ---
  var(total error):              8.1461
  var(house effects):            2.7365  (33.6%)
  var(sampling noise):           3.0126  (37.0%)
  var(residual systematic bias): 1.5099  (18.5%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.075        8
             Morning Consult        -1.967       19
                   Focaldata        -1.625       10
                  AtlasIntel         1.175       12
                   Siena/NYT         1.075       18
                      YouGov        -1.058        5
                 Beacon/Shaw         0.663        6
            InsiderAdvantage         0.647        5
Redfield & Wilton Strategies         0.189       12
             Trafalgar Group         0.131        5

figure saved to: figures/kalman_he_AZ_anchored_all_data.png
poll results exported to: data/kalman_he_polls_AZ_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_AZ_anchored_all_data.csv

======================================================================
UNANCHORED MODE (arizona | ALL DATA)
======================================================================
arizona polls loaded: 163 questions from 103 polls, 44 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.453 pp

sanity check — unique true_margin values: [5.52860324]

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.121994

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.134354    0.121994      1.4914
    2        0.399530    0.041467      1.5181
    3        0.493880    0.034629      1.5389
    4        0.100779    0.027387      1.5440
    5        0.069410    0.025685      1.5475
    6        0.023589    0.024381      1.5483
    7        0.015466    0.023929      1.5489
    8        0.006461    0.023632      1.5491
    9        0.003829    0.023511      1.5492
   10        0.001734    0.023440      1.5493
   11        0.000959    0.023410      1.5493
   12        0.000435    0.023389      1.5493
   13        0.000275    0.023383      1.5493
   14        0.000094    0.023378      1.5493

em converged at iteration 14 (max change 9.38e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — arizona (trump margin, unanchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.023378 per day
interpretation: true opinion can move ~0.153 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.453 pp
  mean total error:              -4.076 pp
  sd of total error:             2.854 pp

--- three-component decomposition ---
  mean |house effect|:           1.468 pp
  mean |sampling noise|:         1.343 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.492        8
             Morning Consult        -2.077       19
                   Focaldata        -2.013       10
                  AtlasIntel         1.943       12
                   Siena/NYT         1.210       18
            InsiderAdvantage         1.072        5
                      YouGov        -0.533        5
             Trafalgar Group         0.248        5
                 Beacon/Shaw         0.211        6
Redfield & Wilton Strategies        -0.053       12

figure saved to: figures/kalman_he_AZ_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_AZ_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_AZ_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: arizona (AZ) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (arizona | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 164
  polls after filter:  161
  polls dropped:       3
arizona polls loaded: 160 questions from 101 polls, 44 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.372 pp

sanity check — unique true_margin values: [5.52860324]

election result appended: margin = 5.529 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.580711

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.040715    0.580711      1.4035
    2        0.533422    0.396520      1.4865
    3        0.319262    0.387925      1.5197
    4        0.109037    0.375223      1.5267
    5        0.053686    0.371201      1.5304
    6        0.024683    0.368890      1.5320
    7        0.012291    0.367692      1.5329
    8        0.006243    0.367093      1.5333
    9        0.003179    0.366751      1.5335
   10        0.001671    0.366579      1.5336
   11        0.000867    0.366494      1.5337
   12        0.000447    0.366408      1.5337
   13        0.000280    0.366408      1.5337
   14        0.000108    0.366408      1.5338
   15        0.000046    0.366408      1.5338

em converged at iteration 15 (max change 4.55e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — arizona (trump margin, anchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.366408 per day
interpretation: true opinion can move ~0.605 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.372 pp
  mean total error:              -4.157 pp
  sd of total error:             2.814 pp

--- three-component decomposition ---
  mean |house effect|:           1.351 pp
  mean |sampling noise|:         1.225 pp
  mean residual systematic bias: -4.048 pp

--- variance decomposition ---
  var(total error):              7.9199
  var(house effects):            2.7361  (34.5%)
  var(sampling noise):           2.9314  (37.0%)
  var(residual systematic bias): 1.4228  (18.0%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.074        7
             Morning Consult        -2.006       19
                   Focaldata        -1.527       10
                  AtlasIntel         1.252       12
                   Siena/NYT         1.124       16
                      YouGov        -0.944        5
                 Beacon/Shaw         0.649        6
            InsiderAdvantage         0.605        5
Redfield & Wilton Strategies         0.219       12
             Trafalgar Group         0.183        5

figure saved to: figures/kalman_he_AZ_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_AZ_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_AZ_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (arizona | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 164
  polls after filter:  161
  polls dropped:       3
arizona polls loaded: 160 questions from 101 polls, 44 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 9.0 pp
mean poll margin: 1.372 pp

sanity check — unique true_margin values: [5.52860324]

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.199145

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.112108    0.199145      1.4759
    2        0.406486    0.071077      1.5119
    3        0.560014    0.061397      1.5298
    4        0.134958    0.043566      1.5354
    5        0.161386    0.039323      1.5417
    6        0.056203    0.034550      1.5439
    7        0.053997    0.032787      1.5459
    8        0.023278    0.031091      1.5467
    9        0.020464    0.030297      1.5474
   10        0.010329    0.029606      1.5478
   11        0.008531    0.029228      1.5480
   12        0.004860    0.028930      1.5482
   13        0.003723    0.028753      1.5483
   14        0.002270    0.028614      1.5484
   15        0.001742    0.028535      1.5485
   16        0.001021    0.028469      1.5485
   17        0.000827    0.028429      1.5485
   18        0.000509    0.028403      1.5485
   19        0.000336    0.028383      1.5485
   20        0.000250    0.028370      1.5486
   21        0.000168    0.028357      1.5486
   22        0.000165    0.028350      1.5486
   23        0.000087    0.028350      1.5486

em converged at iteration 23 (max change 8.69e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — arizona (trump margin, unanchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.028350 per day
interpretation: true opinion can move ~0.168 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.372 pp
  mean total error:              -4.157 pp
  sd of total error:             2.814 pp

--- three-component decomposition ---
  mean |house effect|:           1.452 pp
  mean |sampling noise|:         1.355 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.355        7
             Morning Consult        -2.025       19
                   Focaldata        -1.956       10
                  AtlasIntel         1.950       12
                   Siena/NYT         1.228       16
            InsiderAdvantage         1.103        5
                      YouGov        -0.533        5
             Trafalgar Group         0.283        5
                 Beacon/Shaw         0.272        6
Redfield & Wilton Strategies        -0.007       12

figure saved to: figures/kalman_he_AZ_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_AZ_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_AZ_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: arizona (AZ) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (arizona | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 164
  polls after filter:  157
  polls dropped:       7
arizona polls loaded: 156 questions from 97 polls, 44 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 7.8 pp
mean poll margin: 1.221 pp

sanity check — unique true_margin values: [5.52860324]

election result appended: margin = 5.529 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.527603

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.069749    0.527603      1.4232
    2        0.304667    0.332588      1.4892
    3        0.237068    0.327478      1.5198
    4        0.067229    0.315332      1.5243
    5        0.031751    0.312055      1.5277
    6        0.013664    0.310061      1.5291
    7        0.007051    0.309065      1.5299
    8        0.003652    0.308567      1.5302
    9        0.001884    0.308353      1.5304
   10        0.000927    0.308211      1.5305
   11        0.000501    0.308140      1.5306
   12        0.000264    0.308140      1.5306
   13        0.000109    0.308069      1.5306
   14        0.000117    0.308069      1.5306
   15        0.000042    0.308069      1.5306

em converged at iteration 15 (max change 4.25e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — arizona (trump margin, anchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.308069 per day
interpretation: true opinion can move ~0.555 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.221 pp
  mean total error:              -4.307 pp
  sd of total error:             2.677 pp

--- three-component decomposition ---
  mean |house effect|:           1.358 pp
  mean |sampling noise|:         1.235 pp
  mean residual systematic bias: -4.178 pp

--- variance decomposition ---
  var(total error):              7.1662
  var(house effects):            2.7802  (38.8%)
  var(sampling noise):           3.0289  (42.3%)
  var(residual systematic bias): 1.1019  (15.4%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.441        7
             Morning Consult        -2.072       18
                   Focaldata        -1.534       10
                  AtlasIntel         1.223       12
                   Siena/NYT         1.181       16
                      YouGov        -0.995        5
                 Beacon/Shaw         0.701        6
Redfield & Wilton Strategies         0.341       12
             Trafalgar Group         0.222        5

figure saved to: figures/kalman_he_AZ_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_AZ_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_AZ_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (arizona | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 164
  polls after filter:  157
  polls dropped:       7
arizona polls loaded: 156 questions from 97 polls, 44 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 5.529 pp
poll margin range: -5.0 to 7.8 pp
mean poll margin: 1.221 pp

sanity check — unique true_margin values: [5.52860324]

skipping election result anchor (unanchored mode)
true margin: 5.529 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.023676

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.035766    0.023676      1.5165
    2        0.189849    0.008955      1.5125
    3        0.220720    0.007242      1.5123
    4        0.076492    0.005090      1.5114
    5        0.071152    0.004274      1.5108
    6        0.036818    0.003545      1.5103
    7        0.030796    0.003170      1.5099
    8        0.018168    0.002859      1.5097
    9        0.014618    0.002676      1.5095
   10        0.009222    0.002530      1.5094
   11        0.007217    0.002438      1.5093
   12        0.004760    0.002366      1.5092
   13        0.003657    0.002319      1.5092
   14        0.002455    0.002283      1.5092
   15        0.001870    0.002258      1.5091
   16        0.001279    0.002239      1.5091
   17        0.000974    0.002227      1.5091
   18        0.000673    0.002217      1.5091
   19        0.000505    0.002210      1.5091
   20        0.000350    0.002205      1.5091
   21        0.000266    0.002202      1.5091
   22        0.000165    0.002199      1.5091
   23        0.000155    0.002198      1.5091
   24        0.000084    0.002196      1.5091

em converged at iteration 24 (max change 8.44e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — arizona (trump margin, unanchored)
======================================================================

true margin (certified result): 5.529 pp
estimated sigma2_u:             0.002196 per day
interpretation: true opinion can move ~0.047 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.221 pp
  mean total error:              -4.307 pp
  sd of total error:             2.677 pp

--- three-component decomposition ---
  mean |house effect|:           1.490 pp
  mean |sampling noise|:         1.328 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                     Emerson         2.557        7
             Morning Consult        -2.407       18
                  AtlasIntel         2.283       12
                   Focaldata        -1.935       10
                   Siena/NYT         1.341       16
             Trafalgar Group         0.463        5
                 Beacon/Shaw         0.166        6
                      YouGov        -0.129        5
Redfield & Wilton Strategies         0.126       12

figure saved to: figures/kalman_he_AZ_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_AZ_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_AZ_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: georgia (GA) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (georgia | ALL DATA)
======================================================================
georgia polls loaded: 164 questions from 95 polls, 38 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.317 pp

sanity check — unique true_margin values: [2.19200309]

election result appended: margin = 2.192 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.216837

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.922040    0.216837      1.4373
    2        0.592883    0.109256      1.6010
    3        0.487535    0.101198      1.6351
    4        0.180040    0.092362      1.6407
    5        0.096685    0.089118      1.6400
    6        0.048327    0.087186      1.6387
    7        0.026288    0.086185      1.6377
    8        0.014275    0.085645      1.6371
    9        0.007799    0.085345      1.6367
   10        0.004299    0.085178      1.6365
   11        0.002382    0.085099      1.6364
   12        0.001257    0.085041      1.6363
   13        0.000742    0.085021      1.6363
   14        0.000369    0.085002      1.6362
   15        0.000229    0.085002      1.6362
   16        0.000087    0.085002      1.6362

em converged at iteration 16 (max change 8.71e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — georgia (trump margin, anchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.085002 per day
interpretation: true opinion can move ~0.292 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.317 pp
  mean total error:              -0.875 pp
  sd of total error:             2.897 pp

--- three-component decomposition ---
  mean |house effect|:           1.430 pp
  mean |sampling noise|:         1.184 pp
  mean residual systematic bias: -0.752 pp

--- variance decomposition ---
  var(total error):              8.3925
  var(house effects):            3.5194  (41.9%)
  var(sampling noise):           2.5913  (30.9%)
  var(residual systematic bias): 1.1521  (13.7%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
                                     Quinnipiac         4.644        6
Florida Atlantic University/Mainstreet Research         2.963       10
                                    Beacon/Shaw        -2.960        6
                                      Focaldata        -2.108       10
                                           TIPP        -1.957        8
                               InsiderAdvantage         1.081        5
                                Morning Consult        -1.020       19
                                      Siena/NYT         0.985       14
                                         YouGov         0.668        5
                                     AtlasIntel         0.479       12
                   Redfield & Wilton Strategies         0.221       13
                                        Emerson         0.077        7

figure saved to: figures/kalman_he_GA_anchored_all_data.png
poll results exported to: data/kalman_he_polls_GA_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_GA_anchored_all_data.csv

======================================================================
UNANCHORED MODE (georgia | ALL DATA)
======================================================================
georgia polls loaded: 164 questions from 95 polls, 38 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.317 pp

sanity check — unique true_margin values: [2.19200309]

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.191172

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.996528    0.191172      1.4805
    2        0.526207    0.080739      1.6457
    3        0.477722    0.072075      1.6962
    4        0.161994    0.063496      1.7088
    5        0.093564    0.060788      1.7113
    6        0.045629    0.059181      1.7111
    7        0.025189    0.058425      1.7106
    8        0.013393    0.058020      1.7102
    9        0.007251    0.057804      1.7100
   10        0.003931    0.057682      1.7098
   11        0.002167    0.057615      1.7097
   12        0.001198    0.057582      1.7097
   13        0.000635    0.057568      1.7096
   14        0.000312    0.057555      1.7096
   15        0.000196    0.057555      1.7096
   16        0.000072    0.057555      1.7096

em converged at iteration 16 (max change 7.16e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — georgia (trump margin, unanchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.057555 per day
interpretation: true opinion can move ~0.240 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.317 pp
  mean total error:              -0.875 pp
  sd of total error:             2.897 pp

--- three-component decomposition ---
  mean |house effect|:           1.516 pp
  mean |sampling noise|:         1.175 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
                                     Quinnipiac         4.432        6
                                    Beacon/Shaw        -3.201        6
Florida Atlantic University/Mainstreet Research         2.872       10
                                           TIPP        -2.092        8
                                      Focaldata        -2.076       10
                               InsiderAdvantage         1.146        5
                                Morning Consult        -1.131       19
                                         YouGov         1.069        5
                                      Siena/NYT         1.025       14
                                     AtlasIntel         0.943       12
                   Redfield & Wilton Strategies         0.156       13
                                        Emerson         0.100        7

figure saved to: figures/kalman_he_GA_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_GA_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_GA_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: georgia (GA) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (georgia | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 166
  polls after filter:  163
  polls dropped:       3
georgia polls loaded: 161 questions from 93 polls, 38 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.255 pp

sanity check — unique true_margin values: [2.19200309]

election result appended: margin = 2.192 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.240396

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.924653    0.240396      1.4472
    2        0.581509    0.107232      1.6100
    3        0.553240    0.099050      1.6551
    4        0.195775    0.089669      1.6619
    5        0.106867    0.086365      1.6604
    6        0.053084    0.084376      1.6585
    7        0.029056    0.083359      1.6570
    8        0.015765    0.082795      1.6562
    9        0.008685    0.082490      1.6557
   10        0.004775    0.082318      1.6554
   11        0.002650    0.082222      1.6553
   12        0.001472    0.082165      1.6552
   13        0.000839    0.082146      1.6551
   14        0.000409    0.082127      1.6551
   15        0.000251    0.082127      1.6551
   16        0.000094    0.082108      1.6551

em converged at iteration 16 (max change 9.35e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — georgia (trump margin, anchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.082108 per day
interpretation: true opinion can move ~0.287 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.255 pp
  mean total error:              -0.937 pp
  sd of total error:             2.842 pp

--- three-component decomposition ---
  mean |house effect|:           1.488 pp
  mean |sampling noise|:         1.140 pp
  mean residual systematic bias: -0.814 pp

--- variance decomposition ---
  var(total error):              8.0779
  var(house effects):            3.6469  (45.1%)
  var(sampling noise):           2.4876  (30.8%)
  var(residual systematic bias): 0.9591  (11.9%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
                                     Quinnipiac         4.638        6
Florida Atlantic University/Mainstreet Research         2.982       10
                                    Beacon/Shaw        -2.950        6
                                      Focaldata        -2.087       10
                                           TIPP        -1.957        8
                                      Siena/NYT         1.384       12
                               InsiderAdvantage         1.081        5
                                Morning Consult        -1.003       19
                                         YouGov         0.681        5
                                        Emerson        -0.540        6
                                     AtlasIntel         0.486       12
                   Redfield & Wilton Strategies         0.223       13

figure saved to: figures/kalman_he_GA_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_GA_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_GA_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (georgia | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 166
  polls after filter:  163
  polls dropped:       3
georgia polls loaded: 161 questions from 93 polls, 38 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 11.0 pp
mean poll margin: 1.255 pp

sanity check — unique true_margin values: [2.19200309]

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.211154

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.999917    0.211154      1.4907
    2        0.515376    0.076991      1.6558
    3        0.552942    0.068285      1.7215
    4        0.178017    0.059430      1.7350
    5        0.106404    0.056683      1.7369
    6        0.052070    0.055010      1.7361
    7        0.029450    0.054216      1.7352
    8        0.015892    0.053762      1.7345
    9        0.008901    0.053521      1.7341
   10        0.004906    0.053398      1.7339
   11        0.002646    0.053324      1.7337
   12        0.001490    0.053275      1.7337
   13        0.000896    0.053262      1.7336
   14        0.000404    0.053250      1.7336
   15        0.000239    0.053238      1.7336
   16        0.000178    0.053238      1.7336
   17        0.000060    0.053238      1.7336

em converged at iteration 17 (max change 6.03e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — georgia (trump margin, unanchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.053238 per day
interpretation: true opinion can move ~0.231 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              1.255 pp
  mean total error:              -0.937 pp
  sd of total error:             2.842 pp

--- three-component decomposition ---
  mean |house effect|:           1.584 pp
  mean |sampling noise|:         1.130 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                                       pollster  house_effect  n_polls
                                     Quinnipiac         4.411        6
                                    Beacon/Shaw        -3.211        6
Florida Atlantic University/Mainstreet Research         2.917       10
                                           TIPP        -2.103        8
                                      Focaldata        -2.066       10
                                      Siena/NYT         1.481       12
                               InsiderAdvantage         1.148        5
                                Morning Consult        -1.119       19
                                         YouGov         1.086        5
                                     AtlasIntel         0.954       12
                                        Emerson        -0.571        6
                   Redfield & Wilton Strategies         0.155       13

figure saved to: figures/kalman_he_GA_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_GA_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_GA_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: georgia (GA) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (georgia | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 166
  polls after filter:  152
  polls dropped:       14
georgia polls loaded: 150 questions from 88 polls, 38 pollsters
date range: 2024-07-22 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 7.0 pp
mean poll margin: 0.828 pp

sanity check — unique true_margin values: [2.19200309]

election result appended: margin = 2.192 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.062627

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.905343    0.062627      1.4473
    2        0.247606    0.048679      1.5122
    3        0.054908    0.051237      1.5134
    4        0.014823    0.050967      1.5163
    5        0.002929    0.051190      1.5168
    6        0.002873    0.051237      1.5172
    7        0.001221    0.051272      1.5173
    8        0.000647    0.051284      1.5174
    9        0.000281    0.051296      1.5174
   10        0.000178    0.051296      1.5175
   11        0.000050    0.051296      1.5175

em converged at iteration 11 (max change 4.96e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — georgia (trump margin, anchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.051296 per day
interpretation: true opinion can move ~0.226 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.828 pp
  mean total error:              -1.364 pp
  sd of total error:             2.365 pp

--- three-component decomposition ---
  mean |house effect|:           1.328 pp
  mean |sampling noise|:         1.052 pp
  mean residual systematic bias: -1.194 pp

--- variance decomposition ---
  var(total error):              5.5919
  var(house effects):            3.1884  (57.0%)
  var(sampling noise):           2.1710  (38.8%)
  var(residual systematic bias): 0.2139  (3.8%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  Quinnipiac         4.727        6
                 Beacon/Shaw        -2.767        6
                   Focaldata        -1.858       10
                        TIPP        -1.827        8
                   Siena/NYT         1.673       12
             Morning Consult        -0.948       18
                      YouGov         0.697        5
Redfield & Wilton Strategies         0.536       13
                  AtlasIntel         0.525       12
                     Emerson         0.045        6

figure saved to: figures/kalman_he_GA_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_GA_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_GA_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (georgia | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 166
  polls after filter:  152
  polls dropped:       14
georgia polls loaded: 150 questions from 88 polls, 38 pollsters
date range: 2024-07-22 to 2024-11-04
true margin (constant across rows): 2.192 pp
poll margin range: -6.6 to 7.0 pp
mean poll margin: 0.828 pp

sanity check — unique true_margin values: [2.19200309]

skipping election result anchor (unanchored mode)
true margin: 2.192 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.828450    0.000100      1.5486
    2        0.004375    0.000100      1.5491
    3        0.000026    0.000100      1.5491

em converged at iteration 3 (max change 2.61e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — georgia (trump margin, unanchored)
======================================================================

true margin (certified result): 2.192 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.828 pp
  mean total error:              -1.364 pp
  sd of total error:             2.365 pp

--- three-component decomposition ---
  mean |house effect|:           1.419 pp
  mean |sampling noise|:         1.061 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  Quinnipiac         4.340        6
                 Beacon/Shaw        -3.161        6
                        TIPP        -2.127        8
                   Focaldata        -1.842       10
                   Siena/NYT         1.839       12
             Morning Consult        -1.069       18
                      YouGov         0.975        5
                  AtlasIntel         0.866       12
Redfield & Wilton Strategies         0.557       13
                     Emerson         0.204        6

figure saved to: figures/kalman_he_GA_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_GA_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_GA_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: michigan (MI) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (michigan | ALL DATA)
======================================================================
michigan polls loaded: 190 questions from 119 polls, 52 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.311 pp

sanity check — unique true_margin values: [1.41420144]

election result appended: margin = 1.414 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.413805

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.189121    0.413805      1.6400
    2        0.787835    0.249031      1.7381
    3        0.642339    0.235291      1.7771
    4        0.270413    0.219002      1.7913
    5        0.130039    0.212826      1.7957
    6        0.057477    0.209174      1.7972
    7        0.026552    0.207444      1.7976
    8        0.012136    0.206482      1.7977
    9        0.005776    0.206001      1.7977
   10        0.002757    0.205761      1.7977
   11        0.001322    0.205665      1.7977
   12        0.000595    0.205569      1.7977
   13        0.000360    0.205569      1.7977
   14        0.000113    0.205520      1.7977
   15        0.000121    0.205520      1.7977
   16        0.000038    0.205520      1.7977

em converged at iteration 16 (max change 3.75e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — michigan (trump margin, anchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.205520 per day
interpretation: true opinion can move ~0.453 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.311 pp
  mean total error:              -2.725 pp
  sd of total error:             2.813 pp

--- three-component decomposition ---
  mean |house effect|:           1.724 pp
  mean |sampling noise|:         1.266 pp
  mean residual systematic bias: -2.536 pp

--- variance decomposition ---
  var(total error):              7.9121
  var(house effects):            4.3046  (54.4%)
  var(sampling noise):           2.9354  (37.1%)
  var(residual systematic bias): 0.3207  (4.1%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.117       10
                  AtlasIntel         2.784       12
             Morning Consult        -2.241       19
            InsiderAdvantage         1.569        5
                   Siena/NYT         1.463       14
Redfield & Wilton Strategies         1.058       12
                      YouGov        -0.821        7
                    Mitchell         0.749        8
                     Emerson         0.746        7
                 Beacon/Shaw         0.569        6
                  Quinnipiac        -0.547        6

figure saved to: figures/kalman_he_MI_anchored_all_data.png
poll results exported to: data/kalman_he_polls_MI_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_MI_anchored_all_data.csv

======================================================================
UNANCHORED MODE (michigan | ALL DATA)
======================================================================
michigan polls loaded: 190 questions from 119 polls, 52 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.311 pp

sanity check — unique true_margin values: [1.41420144]

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.439478    0.000100      1.7430
    2        0.002568    0.000100      1.7433
    3        0.000004    0.000100      1.7433

em converged at iteration 3 (max change 3.82e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — michigan (trump margin, unanchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.311 pp
  mean total error:              -2.725 pp
  sd of total error:             2.813 pp

--- three-component decomposition ---
  mean |house effect|:           1.748 pp
  mean |sampling noise|:         1.239 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.392       10
                  AtlasIntel         3.245       12
             Morning Consult        -2.194       19
            InsiderAdvantage         1.531        5
                   Siena/NYT         1.453       14
                    Mitchell         1.073        8
                      YouGov        -0.974        7
Redfield & Wilton Strategies         0.894       12
                     Emerson         0.796        7
                  Quinnipiac        -0.357        6
                 Beacon/Shaw         0.311        6

figure saved to: figures/kalman_he_MI_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_MI_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_MI_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: michigan (MI) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (michigan | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 194
  polls after filter:  192
  polls dropped:       2
michigan polls loaded: 188 questions from 118 polls, 52 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.325 pp

sanity check — unique true_margin values: [1.41420144]

election result appended: margin = 1.414 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.473147

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.197622    0.473147      1.6391
    2        0.790531    0.282403      1.7413
    3        0.639987    0.268118      1.7764
    4        0.279481    0.250824      1.7918
    5        0.136425    0.244199      1.7968
    6        0.061729    0.240396      1.7986
    7        0.028633    0.238574      1.7992
    8        0.013172    0.237580      1.7994
    9        0.006219    0.237083      1.7994
   10        0.002945    0.236863      1.7994
   11        0.001360    0.236697      1.7994
   12        0.000717    0.236642      1.7994
   13        0.000327    0.236642      1.7994
   14        0.000112    0.236587      1.7994
   15        0.000119    0.236587      1.7994
   16        0.000040    0.236587      1.7994

em converged at iteration 16 (max change 3.99e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — michigan (trump margin, anchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.236587 per day
interpretation: true opinion can move ~0.486 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.325 pp
  mean total error:              -2.739 pp
  sd of total error:             2.817 pp

--- three-component decomposition ---
  mean |house effect|:           1.737 pp
  mean |sampling noise|:         1.244 pp
  mean residual systematic bias: -2.563 pp

--- variance decomposition ---
  var(total error):              7.9354
  var(house effects):            4.3464  (54.8%)
  var(sampling noise):           2.8540  (36.0%)
  var(residual systematic bias): 0.3598  (4.5%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.072       10
                  AtlasIntel         2.828       12
             Morning Consult        -2.276       19
            InsiderAdvantage         1.600        5
                   Siena/NYT         1.564       12
Redfield & Wilton Strategies         1.070       12
                      YouGov        -0.775        7
                    Mitchell         0.759        8
                     Emerson         0.740        7
                 Beacon/Shaw         0.599        6
                  Quinnipiac        -0.559        6

figure saved to: figures/kalman_he_MI_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_MI_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_MI_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (michigan | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 194
  polls after filter:  192
  polls dropped:       2
michigan polls loaded: 188 questions from 118 polls, 52 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 5.0 pp
mean poll margin: -1.325 pp

sanity check — unique true_margin values: [1.41420144]

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.425523    0.000100      1.7467
    2        0.002312    0.000100      1.7469
    3        0.000007    0.000100      1.7469

em converged at iteration 3 (max change 7.03e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — michigan (trump margin, unanchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.325 pp
  mean total error:              -2.739 pp
  sd of total error:             2.817 pp

--- three-component decomposition ---
  mean |house effect|:           1.756 pp
  mean |sampling noise|:         1.231 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.378       10
                  AtlasIntel         3.259       12
             Morning Consult        -2.180       19
            InsiderAdvantage         1.545        5
                   Siena/NYT         1.491       12
                    Mitchell         1.087        8
                      YouGov        -0.960        7
Redfield & Wilton Strategies         0.908       12
                     Emerson         0.810        7
                  Quinnipiac        -0.343        6
                 Beacon/Shaw         0.325        6

figure saved to: figures/kalman_he_MI_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_MI_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_MI_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: michigan (MI) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (michigan | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 194
  polls after filter:  188
  polls dropped:       6
michigan polls loaded: 184 questions from 114 polls, 50 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 4.0 pp
mean poll margin: -1.408 pp

sanity check — unique true_margin values: [1.41420144]

election result appended: margin = 1.414 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.499304

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.191072    0.499304      1.6560
    2        0.787012    0.279872      1.7639
    3        0.288764    0.268056      1.7877
    4        0.083998    0.252595      1.7915
    5        0.049803    0.247239      1.7903
    6        0.024937    0.244256      1.7892
    7        0.012800    0.242843      1.7884
    8        0.006408    0.242109      1.7880
    9        0.003239    0.241713      1.7878
   10        0.001668    0.241543      1.7877
   11        0.000813    0.241487      1.7876
   12        0.000360    0.241430      1.7876
   13        0.000202    0.241374      1.7876
   14        0.000147    0.241374      1.7875
   15        0.000052    0.241374      1.7875

em converged at iteration 15 (max change 5.16e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — michigan (trump margin, anchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.241374 per day
interpretation: true opinion can move ~0.491 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.408 pp
  mean total error:              -2.822 pp
  sd of total error:             2.777 pp

--- three-component decomposition ---
  mean |house effect|:           1.744 pp
  mean |sampling noise|:         1.252 pp
  mean residual systematic bias: -2.643 pp

--- variance decomposition ---
  var(total error):              7.7111
  var(house effects):            4.2982  (55.7%)
  var(sampling noise):           2.8424  (36.9%)
  var(residual systematic bias): 0.3204  (4.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.023       10
                  AtlasIntel         2.865       12
             Morning Consult        -2.400       18
            InsiderAdvantage         1.657        5
                   Siena/NYT         1.621       12
Redfield & Wilton Strategies         1.142       12
                     Emerson         0.871        7
                    Mitchell         0.790        8
                 Beacon/Shaw         0.753        6
                      YouGov        -0.731        7
                  Quinnipiac        -0.527        6

figure saved to: figures/kalman_he_MI_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_MI_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_MI_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (michigan | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 194
  polls after filter:  188
  polls dropped:       6
michigan polls loaded: 184 questions from 114 polls, 50 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 1.414 pp
poll margin range: -12.0 to 4.0 pp
mean poll margin: -1.408 pp

sanity check — unique true_margin values: [1.41420144]

skipping election result anchor (unanchored mode)
true margin: 1.414 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.341516    0.000100      1.7179
    2        0.003718    0.000100      1.7179
    3        0.000019    0.000100      1.7179

em converged at iteration 3 (max change 1.88e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — michigan (trump margin, unanchored)
======================================================================

true margin (certified result): 1.414 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.408 pp
  mean total error:              -2.822 pp
  sd of total error:             2.777 pp

--- three-component decomposition ---
  mean |house effect|:           1.772 pp
  mean |sampling noise|:         1.218 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                  AtlasIntel         3.341       12
                   Focaldata        -3.295       10
             Morning Consult        -2.458       18
            InsiderAdvantage         1.628        5
                   Siena/NYT         1.575       12
                    Mitchell         1.169        8
Redfield & Wilton Strategies         0.991       12
                     Emerson         0.894        7
                      YouGov        -0.877        7
                 Beacon/Shaw         0.409        6
                  Quinnipiac        -0.260        6

figure saved to: figures/kalman_he_MI_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_MI_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_MI_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: nevada (NV) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (nevada | ALL DATA)
======================================================================
nevada polls loaded: 120 questions from 73 polls, 31 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.378 pp

sanity check — unique true_margin values: [3.14001699]

election result appended: margin = 3.140 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.521190

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.000027    0.521190      1.8803
    2        1.497979    0.293700      2.2147
    3        0.746780    0.277665      2.3746
    4        0.275877    0.268552      2.4362
    5        0.101865    0.267003      2.4599
    6        0.038402    0.266569      2.4693
    7        0.014920    0.266507      2.4732
    8        0.006124    0.266507      2.4748
    9        0.002579    0.266569      2.4755
   10        0.001122    0.266569      2.4758
   11        0.000478    0.266569      2.4759
   12        0.000205    0.266569      2.4760
   13        0.000088    0.266569      2.4760

em converged at iteration 13 (max change 8.81e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — nevada (trump margin, anchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.266569 per day
interpretation: true opinion can move ~0.516 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.378 pp
  mean total error:              -3.518 pp
  sd of total error:             3.326 pp

--- three-component decomposition ---
  mean |house effect|:           1.899 pp
  mean |sampling noise|:         1.243 pp
  mean residual systematic bias: -3.281 pp

--- variance decomposition ---
  var(total error):              11.0618
  var(house effects):            6.2291  (56.3%)
  var(sampling noise):           2.5281  (22.9%)
  var(residual systematic bias): 3.5242  (31.9%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -4.310       10
                  AtlasIntel         1.676       12
             Morning Consult        -1.479       18
Redfield & Wilton Strategies         0.993       12
   Noble Predictive Insights        -0.887        5
                   Siena/NYT        -0.802       10
                     Emerson         0.418        6

figure saved to: figures/kalman_he_NV_anchored_all_data.png
poll results exported to: data/kalman_he_polls_NV_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_NV_anchored_all_data.csv

======================================================================
UNANCHORED MODE (nevada | ALL DATA)
======================================================================
nevada polls loaded: 120 questions from 73 polls, 31 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.378 pp

sanity check — unique true_margin values: [3.14001699]

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.154578

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.257342    0.154578      2.0549
    2        1.019656    0.077365      2.2732
    3        0.283512    0.080235      2.3060
    4        0.048043    0.077740      2.3139
    5        0.016266    0.077704      2.3140
    6        0.004063    0.077455      2.3139
    7        0.002420    0.077383      2.3136
    8        0.001020    0.077348      2.3135
    9        0.000469    0.077330      2.3134
   10        0.000224    0.077312      2.3134
   11        0.000154    0.077312      2.3134
   12        0.000042    0.077312      2.3134

em converged at iteration 12 (max change 4.15e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — nevada (trump margin, unanchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.077312 per day
interpretation: true opinion can move ~0.278 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.378 pp
  mean total error:              -3.518 pp
  sd of total error:             3.326 pp

--- three-component decomposition ---
  mean |house effect|:           1.885 pp
  mean |sampling noise|:         1.234 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -4.086       10
                  AtlasIntel         2.405       12
             Morning Consult        -1.914       18
Redfield & Wilton Strategies         0.871       12
   Noble Predictive Insights        -0.808        5
                     Emerson         0.769        6
                   Siena/NYT        -0.053       10

figure saved to: figures/kalman_he_NV_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_NV_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_NV_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: nevada (NV) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (nevada | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 121
  polls after filter:  118
  polls dropped:       3
nevada polls loaded: 117 questions from 71 polls, 31 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.582 pp

sanity check — unique true_margin values: [3.14001699]

election result appended: margin = 3.140 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.638046

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.028376    0.638046      1.8405
    2        1.509175    0.339024      2.1807
    3        0.834319    0.314021      2.3583
    4        0.320051    0.298121      2.4297
    5        0.122335    0.294720      2.4575
    6        0.046215    0.293496      2.4685
    7        0.017777    0.293157      2.4728
    8        0.006983    0.293021      2.4747
    9        0.002838    0.293021      2.4755
   10        0.001179    0.293021      2.4759
   11        0.000491    0.293021      2.4760
   12        0.000205    0.293021      2.4761
   13        0.000086    0.293021      2.4761

em converged at iteration 13 (max change 8.61e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — nevada (trump margin, anchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.293021 per day
interpretation: true opinion can move ~0.541 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.582 pp
  mean total error:              -3.722 pp
  sd of total error:             3.105 pp

--- three-component decomposition ---
  mean |house effect|:           1.925 pp
  mean |sampling noise|:         1.245 pp
  mean residual systematic bias: -3.499 pp

--- variance decomposition ---
  var(total error):              9.6397
  var(house effects):            6.4082  (66.5%)
  var(sampling noise):           2.5506  (26.5%)
  var(residual systematic bias): 1.9394  (20.1%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -4.353       10
                  AtlasIntel         1.684       12
             Morning Consult        -1.405       18
Redfield & Wilton Strategies         0.990       12
   Noble Predictive Insights        -0.949        5
                   Siena/NYT        -0.912        8
                     Emerson         0.168        5

figure saved to: figures/kalman_he_NV_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NV_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NV_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (nevada | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 121
  polls after filter:  118
  polls dropped:       3
nevada polls loaded: 117 questions from 71 polls, 31 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 10.0 pp
mean poll margin: -0.582 pp

sanity check — unique true_margin values: [3.14001699]

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.156400

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.240133    0.156400      2.0408
    2        1.018749    0.039716      2.2585
    3        0.722850    0.048578      2.2627
    4        0.066268    0.037128      2.2681
    5        0.142236    0.037977      2.2605
    6        0.007648    0.034884      2.2591
    7        0.047412    0.034637      2.2561
    8        0.008571    0.033591      2.2552
    9        0.017842    0.033342      2.2540
   10        0.005851    0.032946      2.2535
   11        0.007165    0.032794      2.2531
   12        0.003244    0.032635      2.2529
   13        0.002999    0.032559      2.2528
   14        0.001573    0.032491      2.2527
   15        0.001308    0.032453      2.2526
   16        0.000770    0.032422      2.2526
   17        0.000589    0.032407      2.2525
   18        0.000315    0.032392      2.2525
   19        0.000288    0.032384      2.2525
   20        0.000157    0.032377      2.2525
   21        0.000144    0.032377      2.2525
   22        0.000015    0.032369      2.2525

em converged at iteration 22 (max change 1.50e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — nevada (trump margin, unanchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.032369 per day
interpretation: true opinion can move ~0.180 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.582 pp
  mean total error:              -3.722 pp
  sd of total error:             3.105 pp

--- three-component decomposition ---
  mean |house effect|:           1.890 pp
  mean |sampling noise|:         1.306 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -4.016       10
                  AtlasIntel         2.381       12
             Morning Consult        -1.781       18
Redfield & Wilton Strategies         0.975       12
   Noble Predictive Insights        -0.851        5
                     Emerson         0.321        5
                   Siena/NYT         0.005        8

figure saved to: figures/kalman_he_NV_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NV_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NV_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: nevada (NV) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (nevada | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 121
  polls after filter:  116
  polls dropped:       5
nevada polls loaded: 115 questions from 69 polls, 31 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 6.0 pp
mean poll margin: -0.705 pp

sanity check — unique true_margin values: [3.14001699]

election result appended: margin = 3.140 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.573702

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.982119    0.573702      1.8189
    2        1.485633    0.315842      2.1493
    3        0.783984    0.300277      2.3233
    4        0.289991    0.289827      2.3902
    5        0.108602    0.288529      2.4159
    6        0.040684    0.288197      2.4259
    7        0.015667    0.288197      2.4298
    8        0.006257    0.288263      2.4315
    9        0.002594    0.288330      2.4321
   10        0.001098    0.288330      2.4324
   11        0.000464    0.288330      2.4325
   12        0.000196    0.288396      2.4326
   13        0.000140    0.288396      2.4326
   14        0.000046    0.288396      2.4326

em converged at iteration 14 (max change 4.62e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — nevada (trump margin, anchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.288396 per day
interpretation: true opinion can move ~0.537 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.705 pp
  mean total error:              -3.845 pp
  sd of total error:             2.949 pp

--- three-component decomposition ---
  mean |house effect|:           1.886 pp
  mean |sampling noise|:         1.206 pp
  mean residual systematic bias: -3.621 pp

--- variance decomposition ---
  var(total error):              8.6988
  var(house effects):            6.1274  (70.4%)
  var(sampling noise):           2.4163  (27.8%)
  var(residual systematic bias): 1.4960  (17.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -4.279       10
                  AtlasIntel         1.679       12
             Morning Consult        -1.373       17
Redfield & Wilton Strategies         1.156       12
   Noble Predictive Insights        -0.919        5
                   Siena/NYT        -0.798        8
                     Emerson         0.163        5

figure saved to: figures/kalman_he_NV_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NV_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NV_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (nevada | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 121
  polls after filter:  116
  polls dropped:       5
nevada polls loaded: 115 questions from 69 polls, 31 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.140 pp
poll margin range: -10.0 to 6.0 pp
mean poll margin: -0.705 pp

sanity check — unique true_margin values: [3.14001699]

skipping election result anchor (unanchored mode)
true margin: 3.140 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.016451

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        6.392878    0.016451      2.1556
    2        0.277495    0.000100      2.2004
    3        0.276459    0.000100      2.1826
    4        0.000300    0.000100      2.1826
    5        0.000001    0.000100      2.1826

em converged at iteration 5 (max change 7.32e-07 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — nevada (trump margin, unanchored)
======================================================================

true margin (certified result): 3.140 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.705 pp
  mean total error:              -3.845 pp
  sd of total error:             2.949 pp

--- three-component decomposition ---
  mean |house effect|:           1.894 pp
  mean |sampling noise|:         1.294 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.805       10
                  AtlasIntel         2.422       12
             Morning Consult        -1.911       17
Redfield & Wilton Strategies         1.205       12
   Noble Predictive Insights        -0.894        5
                   Siena/NYT         0.454        8
                     Emerson         0.365        5

figure saved to: figures/kalman_he_NV_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NV_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NV_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: north carolina (NC) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (north carolina | ALL DATA)
======================================================================
north carolina polls loaded: 160 questions from 100 polls, 40 pollsters
date range: 2024-02-16 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.630 pp

sanity check — unique true_margin values: [3.21185245]

election result appended: margin = 3.212 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.277016

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.838440    0.277016      1.0899
    2        0.343496    0.210317      1.1889
    3        0.124157    0.203323      1.2233
    4        0.040325    0.198089      1.2328
    5        0.017420    0.196574      1.2363
    6        0.006501    0.195885      1.2375
    7        0.002479    0.195634      1.2380
    8        0.000967    0.195545      1.2382
    9        0.000381    0.195500      1.2383
   10        0.000169    0.195500      1.2383
   11        0.000045    0.195455      1.2383

em converged at iteration 11 (max change 4.49e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — north carolina (trump margin, anchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.195455 per day
interpretation: true opinion can move ~0.442 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.630 pp
  mean total error:              -2.582 pp
  sd of total error:             2.292 pp

--- three-component decomposition ---
  mean |house effect|:           0.954 pp
  mean |sampling noise|:         1.140 pp
  mean residual systematic bias: -2.489 pp

--- variance decomposition ---
  var(total error):              5.2538
  var(house effects):            1.6454  (31.3%)
  var(sampling noise):           2.4211  (46.1%)
  var(residual systematic bias): 0.9161  (17.4%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.288       12
                  Quinnipiac        -1.420        6
                   SurveyUSA        -1.367        5
Redfield & Wilton Strategies         1.138       12
                      YouGov        -0.576        6
                   Focaldata        -0.504       10
                     Emerson         0.381        7
                  AtlasIntel        -0.208       12
             Morning Consult        -0.207       19
                 Beacon/Shaw        -0.002       10

figure saved to: figures/kalman_he_NC_anchored_all_data.png
poll results exported to: data/kalman_he_polls_NC_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_NC_anchored_all_data.csv

======================================================================
UNANCHORED MODE (north carolina | ALL DATA)
======================================================================
north carolina polls loaded: 160 questions from 100 polls, 40 pollsters
date range: 2024-02-16 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.630 pp

sanity check — unique true_margin values: [3.21185245]

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.081355

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.653633    0.081355      1.1671
    2        0.259233    0.053102      1.2137
    3        0.137143    0.051831      1.2315
    4        0.017990    0.049632      1.2341
    5        0.017812    0.049356      1.2351
    6        0.004006    0.049126      1.2353
    7        0.002296    0.049080      1.2354
    8        0.000645    0.049057      1.2354
    9        0.000269    0.049045      1.2354
   10        0.000127    0.049045      1.2354
   11        0.000017    0.049045      1.2354

em converged at iteration 11 (max change 1.66e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — north carolina (trump margin, unanchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.049045 per day
interpretation: true opinion can move ~0.221 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.630 pp
  mean total error:              -2.582 pp
  sd of total error:             2.292 pp

--- three-component decomposition ---
  mean |house effect|:           0.966 pp
  mean |sampling noise|:         1.209 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.117       12
                  Quinnipiac        -1.744        6
                   SurveyUSA        -1.585        5
Redfield & Wilton Strategies         1.050       12
                     Emerson         0.721        7
                   Focaldata        -0.396       10
                  AtlasIntel         0.327       12
             Morning Consult        -0.260       19
                      YouGov        -0.230        6
                 Beacon/Shaw        -0.164       10

figure saved to: figures/kalman_he_NC_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_NC_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_NC_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: north carolina (NC) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (north carolina | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 161
  polls after filter:  160
  polls dropped:       1
north carolina polls loaded: 159 questions from 99 polls, 40 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.576 pp

sanity check — unique true_margin values: [3.21185245]

election result appended: margin = 3.212 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.293293

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.831249    0.293293      1.0831
    2        0.347144    0.217391      1.1835
    3        0.162329    0.209607      1.2191
    4        0.051354    0.203229      1.2288
    5        0.023912    0.201444      1.2325
    6        0.009332    0.200551      1.2338
    7        0.004138    0.200246      1.2343
    8        0.001695    0.200109      1.2344
    9        0.000733    0.200063      1.2345
   10        0.000294    0.200017      1.2345
   11        0.000177    0.200017      1.2345
   12        0.000049    0.200017      1.2345

em converged at iteration 12 (max change 4.90e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — north carolina (trump margin, anchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.200017 per day
interpretation: true opinion can move ~0.447 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.576 pp
  mean total error:              -2.635 pp
  sd of total error:             2.195 pp

--- three-component decomposition ---
  mean |house effect|:           0.948 pp
  mean |sampling noise|:         1.147 pp
  mean residual systematic bias: -2.547 pp

--- variance decomposition ---
  var(total error):              4.8193
  var(house effects):            1.6485  (34.2%)
  var(sampling noise):           2.4516  (50.9%)
  var(residual systematic bias): 0.5245  (10.9%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.283       12
                  Quinnipiac        -1.423        6
                   SurveyUSA        -1.363        5
Redfield & Wilton Strategies         1.149       12
                      YouGov        -0.573        6
                   Focaldata        -0.502       10
                     Emerson         0.243        6
                  AtlasIntel        -0.205       12
             Morning Consult        -0.169       19
                 Beacon/Shaw         0.002       10

figure saved to: figures/kalman_he_NC_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NC_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NC_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (north carolina | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 161
  polls after filter:  160
  polls dropped:       1
north carolina polls loaded: 159 questions from 99 polls, 40 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 10.0 pp
mean poll margin: 0.576 pp

sanity check — unique true_margin values: [3.21185245]

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.424561    0.000100      1.2347
    2        0.000871    0.000100      1.2348
    3        0.000002    0.000100      1.2348

em converged at iteration 3 (max change 2.08e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — north carolina (trump margin, unanchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.576 pp
  mean total error:              -2.635 pp
  sd of total error:             2.195 pp

--- three-component decomposition ---
  mean |house effect|:           0.934 pp
  mean |sampling noise|:         1.267 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.077       12
                  Quinnipiac        -1.909        6
                   SurveyUSA        -1.577        5
Redfield & Wilton Strategies         1.173       12
                   Focaldata        -0.345       10
                 Beacon/Shaw        -0.276       10
                  AtlasIntel         0.266       12
                      YouGov        -0.243        6
                     Emerson         0.191        6
             Morning Consult        -0.039       19

figure saved to: figures/kalman_he_NC_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_NC_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_NC_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: north carolina (NC) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (north carolina | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 161
  polls after filter:  158
  polls dropped:       3
north carolina polls loaded: 157 questions from 97 polls, 39 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 5.8 pp
mean poll margin: 0.495 pp

sanity check — unique true_margin values: [3.21185245]

election result appended: margin = 3.212 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.250014

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.847405    0.250014      1.0900
    2        0.325756    0.176261      1.1819
    3        0.125991    0.170642      1.2142
    4        0.035188    0.165084      1.2222
    5        0.014937    0.163672      1.2253
    6        0.005273    0.162946      1.2262
    7        0.002485    0.162699      1.2266
    8        0.000981    0.162587      1.2267
    9        0.000444    0.162550      1.2267
   10        0.000188    0.162550      1.2268
   11        0.000060    0.162550      1.2268

em converged at iteration 11 (max change 6.01e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — north carolina (trump margin, anchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.162550 per day
interpretation: true opinion can move ~0.403 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.495 pp
  mean total error:              -2.717 pp
  sd of total error:             2.057 pp

--- three-component decomposition ---
  mean |house effect|:           0.974 pp
  mean |sampling noise|:         1.159 pp
  mean residual systematic bias: -2.604 pp

--- variance decomposition ---
  var(total error):              4.2300
  var(house effects):            1.6567  (39.2%)
  var(sampling noise):           2.4448  (57.8%)
  var(residual systematic bias): 0.3054  (7.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -2.234       12
                  Quinnipiac        -1.424        6
                   SurveyUSA        -1.341        5
Redfield & Wilton Strategies         1.264       12
                      YouGov        -0.603        6
                   Focaldata        -0.448       10
             Morning Consult        -0.326       18
                     Emerson         0.253        6
                  AtlasIntel        -0.248       12
                 Beacon/Shaw        -0.023       10

figure saved to: figures/kalman_he_NC_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NC_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NC_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (north carolina | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 161
  polls after filter:  158
  polls dropped:       3
north carolina polls loaded: 157 questions from 97 polls, 39 pollsters
date range: 2024-07-24 to 2024-11-04
true margin (constant across rows): 3.212 pp
poll margin range: -4.0 to 5.8 pp
mean poll margin: 0.495 pp

sanity check — unique true_margin values: [3.21185245]

skipping election result anchor (unanchored mode)
true margin: 3.212 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.000100

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.505895    0.000100      1.1952
    2        0.001770    0.000100      1.1954
    3        0.000006    0.000100      1.1954

em converged at iteration 3 (max change 5.96e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — north carolina (trump margin, unanchored)
======================================================================

true margin (certified result): 3.212 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              0.495 pp
  mean total error:              -2.717 pp
  sd of total error:             2.057 pp

--- three-component decomposition ---
  mean |house effect|:           0.969 pp
  mean |sampling noise|:         1.217 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Siena/NYT        -1.995       12
                  Quinnipiac        -1.828        6
                   SurveyUSA        -1.495        5
Redfield & Wilton Strategies         1.255       12
             Morning Consult        -0.482       18
                  AtlasIntel         0.347       12
                     Emerson         0.272        6
                   Focaldata        -0.263       10
                 Beacon/Shaw        -0.194       10
                      YouGov        -0.162        6

figure saved to: figures/kalman_he_NC_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_NC_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_NC_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (pennsylvania | ALL DATA)
======================================================================
pennsylvania polls loaded: 238 questions from 148 polls, 64 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 9.7 pp
mean poll margin: -0.501 pp

sanity check — unique true_margin values: [1.70973099]

election result appended: margin = 1.710 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.154899

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.702283    0.154899      1.5893
    2        0.486678    0.126778      1.6609
    3        0.147040    0.125275      1.6818
    4        0.042414    0.123799      1.6878
    5        0.011880    0.123423      1.6897
    6        0.003683    0.123267      1.6903
    7        0.001318    0.123210      1.6904
    8        0.000573    0.123182      1.6905
    9        0.000272    0.123182      1.6905
   10        0.000076    0.123182      1.6905

em converged at iteration 10 (max change 7.63e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — pennsylvania (trump margin, anchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.123182 per day
interpretation: true opinion can move ~0.351 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.501 pp
  mean total error:              -2.211 pp
  sd of total error:             2.497 pp

--- three-component decomposition ---
  mean |house effect|:           1.474 pp
  mean |sampling noise|:         1.050 pp
  mean residual systematic bias: -2.086 pp

--- variance decomposition ---
  var(total error):              6.2356
  var(house effects):            2.9202  (46.8%)
  var(sampling noise):           1.8806  (30.2%)
  var(residual systematic bias): 1.4524  (23.3%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.757        5
             InsiderAdvantage         2.474        6
                   AtlasIntel         2.079       12
Franklin and Marshall College        -1.857        5
                    Bullfinch        -1.725        8
                      Emerson         1.572       11
                    Siena/NYT        -1.477       22
                   Quinnipiac        -1.414        8
              Morning Consult        -1.277       19
                       YouGov        -1.223       10
                    Focaldata        -1.143       10
 Redfield & Wilton Strategies         0.930       13
                  Beacon/Shaw        -0.404       10

figure saved to: figures/kalman_he_PA_anchored_all_data.png
poll results exported to: data/kalman_he_polls_PA_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_PA_anchored_all_data.csv

======================================================================
UNANCHORED MODE (pennsylvania | ALL DATA)
======================================================================
pennsylvania polls loaded: 238 questions from 148 polls, 64 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 9.7 pp
mean poll margin: -0.501 pp

sanity check — unique true_margin values: [1.70973099]

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.073638

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.825441    0.073638      1.5767
    2        0.302105    0.056591      1.6144
    3        0.080586    0.058115      1.6189
    4        0.008485    0.057542      1.6194
    5        0.002953    0.057595      1.6194
    6        0.000561    0.057555      1.6194
    7        0.000273    0.057555      1.6194
    8        0.000067    0.057555      1.6194

em converged at iteration 8 (max change 6.70e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — pennsylvania (trump margin, unanchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.057555 per day
interpretation: true opinion can move ~0.240 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.501 pp
  mean total error:              -2.211 pp
  sd of total error:             2.497 pp

--- three-component decomposition ---
  mean |house effect|:           1.476 pp
  mean |sampling noise|:         1.009 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.823        5
                   AtlasIntel         2.587       12
             InsiderAdvantage         2.554        6
Franklin and Marshall College        -1.962        5
                    Bullfinch        -1.894        8
                      Emerson         1.575       11
                   Quinnipiac        -1.568        8
                    Siena/NYT        -1.391       22
              Morning Consult        -1.350       19
                    Focaldata        -1.168       10
                       YouGov        -1.118       10
 Redfield & Wilton Strategies         0.828       13
                  Beacon/Shaw        -0.365       10

figure saved to: figures/kalman_he_PA_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_PA_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_PA_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (pennsylvania | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 241
  polls after filter:  238
  polls dropped:       3
pennsylvania polls loaded: 235 questions from 146 polls, 64 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: -0.578 pp

sanity check — unique true_margin values: [1.70973099]

election result appended: margin = 1.710 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.155362

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.698036    0.155362      1.5882
    2        0.484445    0.132703      1.6574
    3        0.142962    0.131525      1.6765
    4        0.041117    0.130131      1.6823
    5        0.011705    0.129797      1.6841
    6        0.003376    0.129646      1.6847
    7        0.001224    0.129585      1.6848
    8        0.000541    0.129555      1.6849
    9        0.000265    0.129555      1.6849
   10        0.000070    0.129525      1.6849

em converged at iteration 10 (max change 7.02e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — pennsylvania (trump margin, anchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.129525 per day
interpretation: true opinion can move ~0.360 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.578 pp
  mean total error:              -2.288 pp
  sd of total error:             2.393 pp

--- three-component decomposition ---
  mean |house effect|:           1.460 pp
  mean |sampling noise|:         1.050 pp
  mean residual systematic bias: -2.170 pp

--- variance decomposition ---
  var(total error):              5.7259
  var(house effects):            2.8876  (50.4%)
  var(sampling noise):           1.8969  (33.1%)
  var(residual systematic bias): 0.9296  (16.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.751        5
             InsiderAdvantage         2.473        6
                   AtlasIntel         2.080       12
Franklin and Marshall College        -1.866        5
                    Bullfinch        -1.735        8
                    Siena/NYT        -1.424       20
                   Quinnipiac        -1.420        8
                      Emerson         1.383       10
              Morning Consult        -1.259       19
                       YouGov        -1.225       10
                    Focaldata        -1.144       10
 Redfield & Wilton Strategies         0.922       13
                  Beacon/Shaw        -0.413       10

figure saved to: figures/kalman_he_PA_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_PA_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_PA_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (pennsylvania | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 241
  polls after filter:  238
  polls dropped:       3
pennsylvania polls loaded: 235 questions from 146 polls, 64 pollsters
date range: 2024-05-12 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 7.0 pp
mean poll margin: -0.578 pp

sanity check — unique true_margin values: [1.70973099]

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.057608

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.820998    0.057608      1.5834
    2        0.274959    0.044984      1.6127
    3        0.100592    0.046731      1.6154
    4        0.012421    0.045765      1.6154
    5        0.009930    0.045862      1.6154
    6        0.000613    0.045744      1.6153
    7        0.001570    0.045739      1.6153
    8        0.000321    0.045728      1.6153
    9        0.000197    0.045728      1.6153
   10        0.000035    0.045718      1.6153

em converged at iteration 10 (max change 3.55e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — pennsylvania (trump margin, unanchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.045718 per day
interpretation: true opinion can move ~0.214 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.578 pp
  mean total error:              -2.288 pp
  sd of total error:             2.393 pp

--- three-component decomposition ---
  mean |house effect|:           1.456 pp
  mean |sampling noise|:         1.022 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.798        5
             InsiderAdvantage         2.580        6
                   AtlasIntel         2.578       12
Franklin and Marshall College        -1.969        5
                    Bullfinch        -1.879        8
                   Quinnipiac        -1.595        8
                    Siena/NYT        -1.310       20
                      Emerson         1.308       10
              Morning Consult        -1.297       19
                    Focaldata        -1.208       10
                       YouGov        -1.135       10
 Redfield & Wilton Strategies         0.823       13
                  Beacon/Shaw        -0.341       10

figure saved to: figures/kalman_he_PA_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_PA_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_PA_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: pennsylvania (PA) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (pennsylvania | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 241
  polls after filter:  229
  polls dropped:       12
pennsylvania polls loaded: 226 questions from 140 polls, 63 pollsters
date range: 2024-07-21 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 6.0 pp
mean poll margin: -0.734 pp

sanity check — unique true_margin values: [1.70973099]

election result appended: margin = 1.710 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.132672

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.671220    0.132672      1.6238
    2        0.436458    0.101832      1.6879
    3        0.122069    0.098798      1.7068
    4        0.036055    0.096297      1.7127
    5        0.020541    0.095505      1.7147
    6        0.009063    0.095132      1.7154
    7        0.004128    0.094979      1.7157
    8        0.001805    0.094935      1.7158
    9        0.000691    0.094891      1.7158
   10        0.000382    0.094891      1.7159
   11        0.000106    0.094891      1.7159
   12        0.000031    0.094891      1.7159

em converged at iteration 12 (max change 3.12e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — pennsylvania (trump margin, anchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.094891 per day
interpretation: true opinion can move ~0.308 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.734 pp
  mean total error:              -2.444 pp
  sd of total error:             2.256 pp

--- three-component decomposition ---
  mean |house effect|:           1.476 pp
  mean |sampling noise|:         1.048 pp
  mean residual systematic bias: -2.298 pp

--- variance decomposition ---
  var(total error):              5.0873
  var(house effects):            2.9209  (57.4%)
  var(sampling noise):           1.8872  (37.1%)
  var(residual systematic bias): 0.5001  (9.8%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.766        5
                   AtlasIntel         2.028       12
             InsiderAdvantage         1.877        5
Franklin and Marshall College        -1.855        5
                    Siena/NYT        -1.632       16
                      Emerson         1.567       10
                    Bullfinch        -1.508        8
                   Quinnipiac        -1.429        8
              Morning Consult        -1.409       18
                       YouGov        -1.277       10
                    Focaldata        -1.193       10
 Redfield & Wilton Strategies         0.999       13
                  Beacon/Shaw        -0.239       10

figure saved to: figures/kalman_he_PA_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_PA_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_PA_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (pennsylvania | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 241
  polls after filter:  229
  polls dropped:       12
pennsylvania polls loaded: 226 questions from 140 polls, 63 pollsters
date range: 2024-07-21 to 2024-11-04
true margin (constant across rows): 1.710 pp
poll margin range: -6.0 to 6.0 pp
mean poll margin: -0.734 pp

sanity check — unique true_margin values: [1.70973099]

skipping election result anchor (unanchored mode)
true margin: 1.710 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.015757

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        5.896580    0.015757      1.6196
    2        0.168333    0.002214      1.6266
    3        0.304958    0.001523      1.6134
    4        0.032742    0.000100      1.6104
    5        0.066253    0.000100      1.6041
    6        0.000325    0.000100      1.6040
    7        0.000003    0.000100      1.6040

em converged at iteration 7 (max change 2.81e-06 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — pennsylvania (trump margin, unanchored)
======================================================================

true margin (certified result): 1.710 pp
estimated sigma2_u:             0.000100 per day
interpretation: true opinion can move ~0.010 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -0.734 pp
  mean total error:              -2.444 pp
  sd of total error:             2.256 pp

--- three-component decomposition ---
  mean |house effect|:           1.483 pp
  mean |sampling noise|:         1.008 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                     pollster  house_effect  n_polls
              Trafalgar Group         2.834        5
                   AtlasIntel         2.723       12
             InsiderAdvantage         1.934        5
Franklin and Marshall College        -1.866        5
                    Siena/NYT        -1.641       16
                   Quinnipiac        -1.640        8
              Morning Consult        -1.600       18
                      Emerson         1.565       10
                    Bullfinch        -1.515        8
                    Focaldata        -1.325       10
                       YouGov        -1.018       10
 Redfield & Wilton Strategies         0.965       13
                  Beacon/Shaw        -0.066       10

figure saved to: figures/kalman_he_PA_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_PA_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_PA_unanchored_last_107_days.csv

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | ALL DATA
======================================================================
======================================================================

======================================================================
ANCHORED MODE (wisconsin | ALL DATA)
======================================================================
wisconsin polls loaded: 188 questions from 110 polls, 49 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.816 pp

sanity check — unique true_margin values: [0.85882864]

election result appended: margin = 0.859 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.221125

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.389955    0.221125      1.6320
    2        0.550795    0.157202      1.7439
    3        0.416500    0.144739      1.7752
    4        0.212041    0.135153      1.7888
    5        0.116706    0.130979      1.7951
    6        0.060312    0.128732      1.7981
    7        0.031468    0.127637      1.7996
    8        0.016154    0.127074      1.8004
    9        0.008292    0.126778      1.8008
   10        0.004280    0.126630      1.8010
   11        0.002193    0.126571      1.8011
   12        0.001067    0.126511      1.8012
   13        0.000622    0.126511      1.8012
   14        0.000246    0.126482      1.8012
   15        0.000197    0.126482      1.8012
   16        0.000078    0.126482      1.8012

em converged at iteration 16 (max change 7.81e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — wisconsin (trump margin, anchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.126482 per day
interpretation: true opinion can move ~0.356 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.816 pp
  mean total error:              -2.675 pp
  sd of total error:             2.637 pp

--- three-component decomposition ---
  mean |house effect|:           1.487 pp
  mean |sampling noise|:         1.011 pp
  mean residual systematic bias: -2.474 pp

--- variance decomposition ---
  var(total error):              6.9551
  var(house effects):            3.2477  (46.7%)
  var(sampling noise):           1.8998  (27.3%)
  var(residual systematic bias): 1.2679  (18.2%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.056       10
                  Quinnipiac         2.175        6
                     Emerson         2.070        8
                      YouGov        -2.027        7
            InsiderAdvantage         1.773        5
                  AtlasIntel         1.530       12
                   Siena/NYT        -1.489       14
                        TIPP         0.826        8
        Marquette Law School        -0.699       16
Redfield & Wilton Strategies         0.393       12
             Morning Consult        -0.267       19

figure saved to: figures/kalman_he_WI_anchored_all_data.png
poll results exported to: data/kalman_he_polls_WI_anchored_all_data.csv
house effects exported to: data/kalman_he_effects_WI_anchored_all_data.csv

======================================================================
UNANCHORED MODE (wisconsin | ALL DATA)
======================================================================
wisconsin polls loaded: 188 questions from 110 polls, 49 pollsters
date range: 2023-11-03 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.816 pp

sanity check — unique true_margin values: [0.85882864]

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.103920

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.935536    0.103920      1.6728
    2        0.439735    0.053976      1.7509
    3        0.458784    0.047086      1.7890
    4        0.165767    0.040456      1.8046
    5        0.097613    0.038346      1.8135
    6        0.040456    0.037017      1.8172
    7        0.021148    0.036472      1.8192
    8        0.009493    0.036181      1.8201
    9        0.004700    0.036040      1.8206
   10        0.002292    0.035973      1.8208
   11        0.001090    0.035940      1.8209
   12        0.000534    0.035923      1.8210
   13        0.000266    0.035915      1.8210
   14        0.000133    0.035915      1.8210
   15        0.000024    0.035907      1.8210

em converged at iteration 15 (max change 2.41e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — wisconsin (trump margin, unanchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.035907 per day
interpretation: true opinion can move ~0.189 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.816 pp
  mean total error:              -2.675 pp
  sd of total error:             2.637 pp

--- three-component decomposition ---
  mean |house effect|:           1.542 pp
  mean |sampling noise|:         0.994 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.197       10
                     Emerson         2.182        8
                  AtlasIntel         2.117       12
                  Quinnipiac         2.110        6
                      YouGov        -2.052        7
            InsiderAdvantage         1.850        5
                   Siena/NYT        -1.252       14
        Marquette Law School        -0.855       16
                        TIPP         0.732        8
             Morning Consult        -0.382       19
Redfield & Wilton Strategies         0.288       12

figure saved to: figures/kalman_he_WI_unanchored_all_data.png
poll results exported to: data/kalman_he_polls_WI_unanchored_all_data.csv
house effects exported to: data/kalman_he_effects_WI_unanchored_all_data.csv

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | LAST 200 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (wisconsin | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 191
  polls after filter:  188
  polls dropped:       3
wisconsin polls loaded: 185 questions from 108 polls, 49 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.880 pp

sanity check — unique true_margin values: [0.85882864]

election result appended: margin = 0.859 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.266011

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.448968    0.266011      1.6244
    2        0.576862    0.195231      1.7379
    3        0.387943    0.181840      1.7675
    4        0.210180    0.170642      1.7811
    5        0.123246    0.165466      1.7878
    6        0.067812    0.162512      1.7914
    7        0.037622    0.160983      1.7932
    8        0.020524    0.160125      1.7943
    9        0.011264    0.159677      1.7948
   10        0.006108    0.159416      1.7951
   11        0.003367    0.159304      1.7953
   12        0.001758    0.159230      1.7954
   13        0.000968    0.159193      1.7954
   14        0.000521    0.159155      1.7955
   15        0.000333    0.159155      1.7955
   16        0.000140    0.159155      1.7955
   17        0.000059    0.159155      1.7955

em converged at iteration 17 (max change 5.94e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — wisconsin (trump margin, anchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.159155 per day
interpretation: true opinion can move ~0.399 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.880 pp
  mean total error:              -2.739 pp
  sd of total error:             2.607 pp

--- three-component decomposition ---
  mean |house effect|:           1.495 pp
  mean |sampling noise|:         0.996 pp
  mean residual systematic bias: -2.559 pp

--- variance decomposition ---
  var(total error):              6.7943
  var(house effects):            3.2630  (48.0%)
  var(sampling noise):           1.8199  (26.8%)
  var(residual systematic bias): 1.0578  (15.6%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.020       10
                  Quinnipiac         2.156        6
                     Emerson         2.117        7
                      YouGov        -1.948        7
            InsiderAdvantage         1.787        5
                   Siena/NYT        -1.580       12
                  AtlasIntel         1.558       12
                        TIPP         0.885        8
        Marquette Law School        -0.730       16
Redfield & Wilton Strategies         0.386       12
             Morning Consult        -0.311       19

figure saved to: figures/kalman_he_WI_anchored_last_200_days.png
poll results exported to: data/kalman_he_polls_WI_anchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_WI_anchored_last_200_days.csv

======================================================================
UNANCHORED MODE (wisconsin | LAST 200 DAYS)
======================================================================
date filter applied: keeping polls from 2024-04-19 onward
  polls before filter: 191
  polls after filter:  188
  polls dropped:       3
wisconsin polls loaded: 185 questions from 108 polls, 49 pollsters
date range: 2024-05-13 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 8.0 pp
mean poll margin: -1.880 pp

sanity check — unique true_margin values: [0.85882864]

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.135122

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.051257    0.135122      1.6602
    2        0.482161    0.071792      1.7395
    3        0.541160    0.059333      1.7767
    4        0.255824    0.045466      1.7981
    5        0.211236    0.039670      1.8157
    6        0.115007    0.035080      1.8255
    7        0.082546    0.032711      1.8327
    8        0.047098    0.030997      1.8369
    9        0.032091    0.030028      1.8399
   10        0.018980    0.029363      1.8416
   11        0.012555    0.028964      1.8428
   12        0.007696    0.028694      1.8436
   13        0.005097    0.028535      1.8440
   14        0.003067    0.028423      1.8443
   15        0.002096    0.028357      1.8445
   16        0.001272    0.028310      1.8447
   17        0.000864    0.028284      1.8448
   18        0.000512    0.028264      1.8448
   19        0.000366    0.028251      1.8448
   20        0.000247    0.028244      1.8449
   21        0.000132    0.028238      1.8449
   22        0.000117    0.028238      1.8449
   23        0.000016    0.028238      1.8449

em converged at iteration 23 (max change 1.60e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — wisconsin (trump margin, unanchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.028238 per day
interpretation: true opinion can move ~0.168 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.880 pp
  mean total error:              -2.739 pp
  sd of total error:             2.607 pp

--- three-component decomposition ---
  mean |house effect|:           1.557 pp
  mean |sampling noise|:         1.007 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.222       10
                     Emerson         2.182        7
                  AtlasIntel         2.121       12
                  Quinnipiac         2.119        6
                      YouGov        -2.081        7
            InsiderAdvantage         1.853        5
                   Siena/NYT        -1.452       12
        Marquette Law School        -0.839       16
                        TIPP         0.721        8
             Morning Consult        -0.335       19
Redfield & Wilton Strategies         0.305       12

figure saved to: figures/kalman_he_WI_unanchored_last_200_days.png
poll results exported to: data/kalman_he_polls_WI_unanchored_last_200_days.csv
house effects exported to: data/kalman_he_effects_WI_unanchored_last_200_days.csv

======================================================================
======================================================================
ANALYZING: wisconsin (WI) | LAST 107 DAYS
======================================================================
======================================================================

======================================================================
ANCHORED MODE (wisconsin | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 191
  polls after filter:  184
  polls dropped:       7
wisconsin polls loaded: 181 questions from 104 polls, 46 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 2.0 pp
mean poll margin: -1.977 pp

sanity check — unique true_margin values: [0.85882864]

election result appended: margin = 0.859 pp on 2024-11-05

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.233888

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        4.417737    0.233888      1.7233
    2        0.594862    0.153047      1.8161
    3        0.329309    0.140691      1.8246
    4        0.136268    0.130010      1.8294
    5        0.070394    0.125912      1.8325
    6        0.033532    0.123742      1.8339
    7        0.016528    0.122729      1.8345
    8        0.008011    0.122248      1.8348
    9        0.003854    0.122022      1.8350
   10        0.001840    0.121909      1.8350
   11        0.000892    0.121853      1.8351
   12        0.000437    0.121824      1.8351
   13        0.000216    0.121824      1.8351
   14        0.000069    0.121824      1.8351

em converged at iteration 14 (max change 6.86e-05 < tol 1.00e-04)

======================================================================
polling bias decomposition with house effects — wisconsin (trump margin, anchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.121824 per day
interpretation: true opinion can move ~0.349 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.977 pp
  mean total error:              -2.836 pp
  sd of total error:             2.506 pp

--- three-component decomposition ---
  mean |house effect|:           1.533 pp
  mean |sampling noise|:         1.024 pp
  mean residual systematic bias: -2.622 pp

--- variance decomposition ---
  var(total error):              6.2817
  var(house effects):            3.3685  (53.6%)
  var(sampling noise):           1.7764  (28.3%)
  var(residual systematic bias): 0.9673  (15.4%)

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.019       10
                     Emerson         2.323        7
                  Quinnipiac         2.204        6
                      YouGov        -2.009        7
            InsiderAdvantage         1.825        5
                  AtlasIntel         1.543       12
                   Siena/NYT        -1.524       12
                        TIPP         0.880        8
        Marquette Law School        -0.612       16
             Morning Consult        -0.555       18
Redfield & Wilton Strategies         0.483       12

figure saved to: figures/kalman_he_WI_anchored_last_107_days.png
poll results exported to: data/kalman_he_polls_WI_anchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_WI_anchored_last_107_days.csv

======================================================================
UNANCHORED MODE (wisconsin | LAST 107 DAYS)
======================================================================
date filter applied: keeping polls from 2024-07-21 onward
  polls before filter: 191
  polls after filter:  184
  polls dropped:       7
wisconsin polls loaded: 181 questions from 104 polls, 46 pollsters
date range: 2024-07-23 to 2024-11-04
true margin (constant across rows): 0.859 pp
poll margin range: -9.0 to 2.0 pp
mean poll margin: -1.977 pp

sanity check — unique true_margin values: [0.85882864]

skipping election result anchor (unanchored mode)
true margin: 0.859 pp (not used as constraint)

initializing sigma2_u from raw (uncorrected) margins...
  initial sigma2_u: 0.071177

starting em algorithm (max_iter=50, tol=0.0001)
 iter   max_he_change    sigma2_u   mean_|he|
--------------------------------------------------
    1        3.893690    0.071177      1.7639
    2        0.388581    0.016470      1.8087
    3        0.563588    0.013930      1.8558
    4        0.090241    0.010586      1.8641
    5        0.080387    0.009967      1.8704
    6        0.023304    0.009386      1.8722
    7        0.017252    0.009192      1.8736
    8        0.006945    0.009055      1.8741
    9        0.004357    0.008997      1.8744
   10        0.002022    0.008961      1.8746
   11        0.001163    0.008942      1.8747
   12        0.000625    0.008934      1.8747
   13        0.000291    0.008928      1.8747
   14        0.000198    0.008926      1.8748
   15        0.000077    0.008926      1.8748

em converged at iteration 15 (max change 7.74e-05 < tol 1.00e-04)

======================================================================
polling opinion trajectory with house effects — wisconsin (trump margin, unanchored)
======================================================================

true margin (certified result): 0.859 pp
estimated sigma2_u:             0.008926 per day
interpretation: true opinion can move ~0.094 pp/day (1 sd)

--- overall poll error ---
  mean poll margin:              -1.977 pp
  mean total error:              -2.836 pp
  sd of total error:             2.506 pp

--- three-component decomposition ---
  mean |house effect|:           1.627 pp
  mean |sampling noise|:         1.011 pp

--- house effects (top 20 by absolute effect, min 5 polls) ---
                    pollster  house_effect  n_polls
                   Focaldata        -3.231       10
                     Emerson         2.352        7
                  AtlasIntel         2.290       12
                  Quinnipiac         2.212        6
                      YouGov        -2.060        7
            InsiderAdvantage         1.961        5
                   Siena/NYT        -1.347       12
                        TIPP         0.792        8
             Morning Consult        -0.777       18
        Marquette Law School        -0.752       16
Redfield & Wilton Strategies         0.413       12

figure saved to: figures/kalman_he_WI_unanchored_last_107_days.png
poll results exported to: data/kalman_he_polls_WI_unanchored_last_107_days.csv
house effects exported to: data/kalman_he_effects_WI_unanchored_last_107_days.csv

======================================================================
analysis completed: 2026-02-25 13:39:19
log saved to: output/kalman/kalman_state_pollstereffects_harrisonly_anlaysis_log.txt
